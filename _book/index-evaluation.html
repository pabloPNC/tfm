<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Evaluación de índices | Evaluación del rendimiento de la clasificación en la toma de decisiones y el diagnóstico médico</title>
  <meta name="description" content="5 Evaluación de índices | Evaluación del rendimiento de la clasificación en la toma de decisiones y el diagnóstico médico" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Evaluación de índices | Evaluación del rendimiento de la clasificación en la toma de decisiones y el diagnóstico médico" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Evaluación de índices | Evaluación del rendimiento de la clasificación en la toma de decisiones y el diagnóstico médico" />
  
  
  

<meta name="author" content="Pablo Navarro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="count-matrix-filtering.html"/>
<link rel="next" href="session-info.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#conjuntos-de-datos"><i class="fa fa-check"></i>Conjuntos de datos</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#software-utilizado"><i class="fa fa-check"></i>Software utilizado</a>
<ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#librerías-externas"><i class="fa fa-check"></i>Librerías externas</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#librerías-propias"><i class="fa fa-check"></i>Librerías propias</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#estructura"><i class="fa fa-check"></i>Estructura</a></li>
</ul></li>
<li class="part"><span><b>I Búsqueda de marcadores</b></span></li>
<li class="chapter" data-level="1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html"><i class="fa fa-check"></i><b>1</b> Selección de células luminales de prostata</a>
<ul>
<li class="chapter" data-level="1.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#importar-matrices-de-cuentas"><i class="fa fa-check"></i><b>1.1</b> Importar matrices de cuentas</a></li>
<li class="chapter" data-level="1.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#preprocesamiento-y-cq"><i class="fa fa-check"></i><b>1.2</b> Preprocesamiento y CQ</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#creación-del-objeto-seurat"><i class="fa fa-check"></i><b>1.2.1</b> Creación del objeto Seurat</a></li>
<li class="chapter" data-level="1.2.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#lecturas-mapeadas-al-genoma-mitocondrial"><i class="fa fa-check"></i><b>1.2.2</b> Lecturas mapeadas al genoma mitocondrial</a></li>
<li class="chapter" data-level="1.2.3" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#normalización"><i class="fa fa-check"></i><b>1.2.3</b> Normalización</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#búsqueda-de-genes-de-alta-variabilidad"><i class="fa fa-check"></i><b>1.3</b> Búsqueda de genes de alta variabilidad</a></li>
<li class="chapter" data-level="1.4" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#escalado-de-los-datos"><i class="fa fa-check"></i><b>1.4</b> Escalado de los datos</a></li>
<li class="chapter" data-level="1.5" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#dim-reduction"><i class="fa fa-check"></i><b>1.5</b> Reducción de la dimensionalidad</a></li>
<li class="chapter" data-level="1.6" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#integración-de-datos"><i class="fa fa-check"></i><b>1.6</b> Integración de datos</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#objetivos-de-la-integración"><i class="fa fa-check"></i><b>1.6.1</b> Objetivos de la integración</a></li>
<li class="chapter" data-level="1.6.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#integración"><i class="fa fa-check"></i><b>1.6.2</b> Integración</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#dimensionalidad-del-conjunto-de-datos"><i class="fa fa-check"></i><b>1.7</b> Dimensionalidad del conjunto de datos</a></li>
<li class="chapter" data-level="1.8" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#clustering"><i class="fa fa-check"></i><b>1.8</b> Agrupamiento de células</a></li>
<li class="chapter" data-level="1.9" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#reducción-de-la-dimensionalidad-no-lineal-umap"><i class="fa fa-check"></i><b>1.9</b> Reducción de la dimensionalidad no lineal (UMAP)</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#utilidad-del-umap"><i class="fa fa-check"></i><b>1.9.1</b> Utilidad del UMAP</a></li>
<li class="chapter" data-level="1.9.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#umap"><i class="fa fa-check"></i><b>1.9.2</b> UMAP</a></li>
<li class="chapter" data-level="1.9.3" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#visualización-del-umap"><i class="fa fa-check"></i><b>1.9.3</b> Visualización del UMAP</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#degs-search"><i class="fa fa-check"></i><b>1.10</b> Búsqueda de genes expresados diferencialmente (DEG)</a></li>
<li class="chapter" data-level="1.11" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#selección-de-células"><i class="fa fa-check"></i><b>1.11</b> Selección de células</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#filtrado-de-resultados-significativos"><i class="fa fa-check"></i><b>1.11.1</b> Filtrado de resultados significativos</a></li>
<li class="chapter" data-level="1.11.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#identificación-de-clusters"><i class="fa fa-check"></i><b>1.11.2</b> Identificación de clusters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html"><i class="fa fa-check"></i><b>2</b> Selección de células cancerosas y marcadores</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#deg-luminal-cells"><i class="fa fa-check"></i><b>2.1</b> DEG en células luminales</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#caracterización-y-selección-de-los-clusters"><i class="fa fa-check"></i><b>2.1.1</b> Caracterización y selección de los clusters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#búsqueda-de-subpoblaciones"><i class="fa fa-check"></i><b>2.2</b> Búsqueda de subpoblaciones</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#repetición-del-flujo-de-trabajo"><i class="fa fa-check"></i><b>2.2.1</b> Repetición del flujo de trabajo</a></li>
<li class="chapter" data-level="2.2.2" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#interpretación-de-resultados"><i class="fa fa-check"></i><b>2.2.2</b> Interpretación de resultados</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#selección-de-marcadores"><i class="fa fa-check"></i><b>2.3</b> Selección de marcadores</a></li>
</ul></li>
<li class="part"><span><b>II Generación del conjunto de datos</b></span></li>
<li class="chapter" data-level="3" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html"><i class="fa fa-check"></i><b>3</b> Generación de la matriz de cuentas</a>
<ul>
<li class="chapter" data-level="3.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#descripción-de-los-datos"><i class="fa fa-check"></i><b>3.1</b> Descripción de los datos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#clinical-preprocessing"><i class="fa fa-check"></i><b>3.1.1</b> Preprocesamiento del fichero clinical y gdc_sample_sheet</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#creación-de-matriz-de-cuentas"><i class="fa fa-check"></i><b>3.2</b> Creación de matriz de cuentas</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#import-read-files"><i class="fa fa-check"></i><b>3.2.1</b> Importar archivos de lecturas</a></li>
<li class="chapter" data-level="3.2.2" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#process-read-files"><i class="fa fa-check"></i><b>3.2.2</b> Selección de variables y renombrado</a></li>
<li class="chapter" data-level="3.2.3" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#unión-de-archivos"><i class="fa fa-check"></i><b>3.2.3</b> Unión de archivos</a></li>
<li class="chapter" data-level="3.2.4" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#construcción-de-la-matriz-de-cuentas"><i class="fa fa-check"></i><b>3.2.4</b> Construcción de la matriz de cuentas</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#procesado-de-la-matriz-de-cuentas"><i class="fa fa-check"></i><b>3.3</b> Procesado de la matriz de cuentas</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#pivotado-de-la-matriz"><i class="fa fa-check"></i><b>3.3.1</b> Pivotado de la matriz</a></li>
<li class="chapter" data-level="3.3.2" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#cálculo-de-gold-standards"><i class="fa fa-check"></i><b>3.3.2</b> Cálculo de Gold Standards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html"><i class="fa fa-check"></i><b>4</b> Filtrado de la matriz de cuentas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html#equivalencias-entre-identificadores"><i class="fa fa-check"></i><b>4.1</b> Equivalencias entre identificadores</a></li>
<li class="chapter" data-level="4.2" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html#filtrado-por-los-genes-identificados"><i class="fa fa-check"></i><b>4.2</b> Filtrado por los genes identificados</a></li>
</ul></li>
<li class="part"><span><b>III Evaluación de índices</b></span></li>
<li class="chapter" data-level="5" data-path="index-evaluation.html"><a href="index-evaluation.html"><i class="fa fa-check"></i><b>5</b> Evaluación de índices</a>
<ul>
<li class="chapter" data-level="5.1" data-path="index-evaluation.html"><a href="index-evaluation.html#aucs"><i class="fa fa-check"></i><b>5.1</b> AUCs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="index-evaluation.html"><a href="index-evaluation.html#introducción-1"><i class="fa fa-check"></i><b>5.1.1</b> Introducción</a></li>
<li class="chapter" data-level="5.1.2" data-path="index-evaluation.html"><a href="index-evaluation.html#cálculo-de-aucs-para-diagnóstico"><i class="fa fa-check"></i><b>5.1.2</b> Cálculo de AUCs para diagnóstico</a></li>
<li class="chapter" data-level="5.1.3" data-path="index-evaluation.html"><a href="index-evaluation.html#cálculo-de-aucs-para-pronóstico"><i class="fa fa-check"></i><b>5.1.3</b> Cálculo de AUCs para pronóstico</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="index-evaluation.html"><a href="index-evaluation.html#pauc"><i class="fa fa-check"></i><b>5.2</b> pAUC</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="index-evaluation.html"><a href="index-evaluation.html#introducción-2"><i class="fa fa-check"></i><b>5.2.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2.2" data-path="index-evaluation.html"><a href="index-evaluation.html#cálculo-de-paucs-en-regiones-de-alta-especificidad"><i class="fa fa-check"></i><b>5.2.2</b> Cálculo de pAUCs en regiones de alta especificidad</a></li>
<li class="chapter" data-level="5.2.3" data-path="index-evaluation.html"><a href="index-evaluation.html#cálculo-de-paucs-en-regiones-de-alta-sensibilidad"><i class="fa fa-check"></i><b>5.2.3</b> Cálculo de pAUCs en regiones de alta sensibilidad</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="index-evaluation.html"><a href="index-evaluation.html#índices-derivados-de-pauc"><i class="fa fa-check"></i><b>5.3</b> Índices derivados de pAUC</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="index-evaluation.html"><a href="index-evaluation.html#problemas-del-pauc"><i class="fa fa-check"></i><b>5.3.1</b> Problemas del pAUC</a></li>
<li class="chapter" data-level="5.3.2" data-path="index-evaluation.html"><a href="index-evaluation.html#índices-para-la-especificidad"><i class="fa fa-check"></i><b>5.3.2</b> Índices para la especificidad</a></li>
<li class="chapter" data-level="5.3.3" data-path="index-evaluation.html"><a href="index-evaluation.html#índices-para-la-sensibilidad"><i class="fa fa-check"></i><b>5.3.3</b> Índices para la sensibilidad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="index-evaluation.html"><a href="index-evaluation.html#comparación-de-índices"><i class="fa fa-check"></i><b>5.4</b> Comparación de índices</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="index-evaluation.html"><a href="index-evaluation.html#agrupar-por-condiciones"><i class="fa fa-check"></i><b>5.4.1</b> Agrupar por condiciones</a></li>
<li class="chapter" data-level="5.4.2" data-path="index-evaluation.html"><a href="index-evaluation.html#marcadores-para-diagnóstico"><i class="fa fa-check"></i><b>5.4.2</b> Marcadores para diagnóstico</a></li>
<li class="chapter" data-level="5.4.3" data-path="index-evaluation.html"><a href="index-evaluation.html#marcadores-para-pronóstico"><i class="fa fa-check"></i><b>5.4.3</b> Marcadores para pronóstico</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="index-evaluation.html"><a href="index-evaluation.html#resultados"><i class="fa fa-check"></i><b>5.5</b> Resultados</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="index-evaluation.html"><a href="index-evaluation.html#rendimiento-de-métricas"><i class="fa fa-check"></i><b>5.5.1</b> Rendimiento de métricas</a></li>
<li class="chapter" data-level="5.5.2" data-path="index-evaluation.html"><a href="index-evaluation.html#relevancia-clínica"><i class="fa fa-check"></i><b>5.5.2</b> Relevancia clínica</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="index-evaluation.html"><a href="index-evaluation.html#discusión-y-conclusiones"><i class="fa fa-check"></i><b>5.6</b> Discusión y conclusiones</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>A</b> Información de la sesión</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Evaluación del rendimiento de la clasificación en la toma de decisiones y el diagnóstico médico</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="index-evaluation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Evaluación de índices<a href="index-evaluation.html#index-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En esta sección del trabajo se estudiarán los distintos índices aplicados a los marcadores de la sección anterior. En primer lugar, se describirá el fundamento teórico y limitaciones de cada uno de ellos. Tras ello, estos índices serán aplicados al conjunto de datos utilizando las distintas variables respuesta. Finalmente, se evaluará su capacidad para seleccionar los clasificadores de mayor rendimiento, además de contrastar sus resultados con marcadores de utilidad aplicados actualmente en la práctica.</p>
<p>Para esta sección necesitaremos el conjunto de datos generado en la anterior sesión. El conjunto de datos contiene los niveles de diversos genes expresados en células luminales de próstata de pacientes con cáncer.</p>
<div id="aucs" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> AUCs<a href="index-evaluation.html#aucs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introducción-1" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Introducción<a href="index-evaluation.html#introducción-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En la literatura, 2 de las aproximaciones estadísticas más usadas para evaluar y comparar el rendimiento de una función o clasificador binario han sido las curvas <span class="math inline">\(ROC\)</span> (Característica Operativa del Receptor) y el área bajo dichas curvas (<span class="math inline">\(AUC\)</span>).</p>
<p>El principal objetivo de un clasificador binario es discriminar instancias con una condición de interés. Su precisión viene determinada por 2 métricas: su sensibilidad y su especificidad o, de forma equivalente la tasa verdaderos positivos (<span class="math inline">\(TPR = Sensitivity\)</span>) y de falsos positivos (<span class="math inline">\(FPR = 1 - Specificity\)</span>).</p>
<p>Cuando se trabaja con marcadores continuos, estos pueden ser dicotomizados en instancias positivas y negativas seleccionando una de las puntuaciones del marcador como un punto de corte, o umbral de decisión. Una curva <span class="math inline">\(ROC\)</span> representa los valores de <span class="math inline">\(TPR\)</span> y <span class="math inline">\(FPR\)</span> para cada uno de los umbrales de decisión de un marcador. Dado que estos puntos se calculan para todo un rango de umbrales, el <span class="math inline">\(AUC\)</span> actúa como una métrica global mostrando los intercambios entre ambos parámetros de la curva, es decir, mostrando la ganancia o perdida de una métrica frente a otra.</p>
</div>
<div id="cálculo-de-aucs-para-diagnóstico" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Cálculo de AUCs para diagnóstico<a href="index-evaluation.html#cálculo-de-aucs-para-diagnóstico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comprendido el fundamento teórico es posible realizar los cálculos. Para ello, se utilizará la función <code>pROC::auc</code>, la cual calculará el <span class="math inline">\(AUC\)</span> utilizando una variable para hacer una predicción (<code>predictor</code>) y una variable que contenga la respuesta a dicha predicción, es decir la condición de interés, variable respuesta o gold standard (<code>response</code>). La función requiere que la variable respuesta sea de tipo <code>factor</code> y utilice solamente 2 valores, donde el primero se corresponda con los casos sin la condición de estudio y el segundo con ella.</p>
<p>En el conjunto de datos con el que se trabaja, la variable respuesta toma valores de <code>0</code> y <code>1</code> para indicar los casos con la condición de estudio y sin ella. Sin embargo, si se comprueba el orden de estos valores, se observa que está invertido.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="index-evaluation.html#cb59-1" tabindex="-1"></a><span class="fu">levels</span>(roc_data<span class="sc">$</span>disease)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;0&quot;</code></pre>
<p>Por este motivo, antes de realizar el cálculo de los <span class="math inline">\(AUC\)</span>s, se reorganizarán los valores de <code>disease</code>. Para esta tarea se utilizará la función <code>forcats::fct_relevel</code>, la cual tomará como entrada un <code>factor</code> y un vector indicando el nuevo orden para sus clases.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="index-evaluation.html#cb61-1" tabindex="-1"></a>roc_data<span class="sc">$</span>disease <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(roc_data<span class="sc">$</span>disease, <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>))</span>
<span id="cb61-2"><a href="index-evaluation.html#cb61-2" tabindex="-1"></a><span class="fu">levels</span>(roc_data<span class="sc">$</span>disease)</span></code></pre></div>
<pre><code>## [1] &quot;0&quot; &quot;1&quot;</code></pre>
<p>Ordenadas las clases en la variable respuesta, es posible aplicar la función <code>pROC::auc</code>. Dado que se buscará aplicar la métrica a todos los genes, se obtendrá un conjunto de datos temporal que contendrá solo los genes (<code>diagnostic_dataset</code>) y se utilizará la función <code>purrr::map_dbl</code> sobre este. La función iterará sobre las columnas (marcadores) y aplicará la función <code>pROC::auc</code> sobre cada una de ellas utilizando la variable <code>disease</code> como respuesta.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="index-evaluation.html#cb63-1" tabindex="-1"></a>diagnostic_dataset <span class="ot">&lt;-</span> roc_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb63-2"><a href="index-evaluation.html#cb63-2" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;gleason_score&quot;</span>, <span class="st">&quot;malignancy&quot;</span>, <span class="st">&quot;disease&quot;</span>, <span class="st">&quot;prognostic&quot;</span>)</span>
<span id="cb63-3"><a href="index-evaluation.html#cb63-3" tabindex="-1"></a>)</span>
<span id="cb63-4"><a href="index-evaluation.html#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="index-evaluation.html#cb63-5" tabindex="-1"></a>auc_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb63-6"><a href="index-evaluation.html#cb63-6" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb63-7"><a href="index-evaluation.html#cb63-7" tabindex="-1"></a>    auc,</span>
<span id="cb63-8"><a href="index-evaluation.html#cb63-8" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb63-9"><a href="index-evaluation.html#cb63-9" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb63-10"><a href="index-evaluation.html#cb63-10" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-11"><a href="index-evaluation.html#cb63-11" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb63-12"><a href="index-evaluation.html#cb63-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="cálculo-de-aucs-para-pronóstico" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Cálculo de AUCs para pronóstico<a href="index-evaluation.html#cálculo-de-aucs-para-pronóstico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De forma similar a la sección anterior, es posible calcular las <span class="math inline">\(AUC\)</span>s pero esta vez en un contexto de pronóstico para la enfermedad. Sin embargo, esta sección requerirá de un filtrado previo: hasta ahora se estaba trabajando tanto con tejidos sanos como con enfermos, sin embargo, para este contexto solamente serán necesarios casos con la enfermedad.</p>
<p>Para realizar este primer filtrado, se generará un conjunto de datos temporal con los pacientes enfermos (<code>disease == 1</code>). A continuación, se reorganizarán las clases de la variable (<code>prognostic</code>) y eliminarán las que no son utilizadas (<code>Normal</code>, aquellas correspondientes a pacientes sanos).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="index-evaluation.html#cb64-1" tabindex="-1"></a>disease <span class="ot">&lt;-</span> roc_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(disease <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb64-2"><a href="index-evaluation.html#cb64-2" tabindex="-1"></a>disease[[<span class="st">&quot;prognostic&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">fct_drop</span>(disease[[<span class="st">&quot;prognostic&quot;</span>]])</span>
<span id="cb64-3"><a href="index-evaluation.html#cb64-3" tabindex="-1"></a>disease[[<span class="st">&quot;prognostic&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(disease[[<span class="st">&quot;prognostic&quot;</span>]], <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>))</span></code></pre></div>
<p>Realizado el filtrado, se realizará un procedimiento similar para calcular las <span class="math inline">\(AUC\)</span>s en este nuevo contexto.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="index-evaluation.html#cb65-1" tabindex="-1"></a>prognostic_dataset <span class="ot">&lt;-</span> disease <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb65-2"><a href="index-evaluation.html#cb65-2" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;gleason_score&quot;</span>, <span class="st">&quot;malignancy&quot;</span>, <span class="st">&quot;disease&quot;</span>, <span class="st">&quot;prognostic&quot;</span>)</span>
<span id="cb65-3"><a href="index-evaluation.html#cb65-3" tabindex="-1"></a>)</span>
<span id="cb65-4"><a href="index-evaluation.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="index-evaluation.html#cb65-5" tabindex="-1"></a>auc_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb65-6"><a href="index-evaluation.html#cb65-6" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb65-7"><a href="index-evaluation.html#cb65-7" tabindex="-1"></a>    auc,</span>
<span id="cb65-8"><a href="index-evaluation.html#cb65-8" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb65-9"><a href="index-evaluation.html#cb65-9" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb65-10"><a href="index-evaluation.html#cb65-10" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb65-11"><a href="index-evaluation.html#cb65-11" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb65-12"><a href="index-evaluation.html#cb65-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="pauc" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> pAUC<a href="index-evaluation.html#pauc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introducción-2" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Introducción<a href="index-evaluation.html#introducción-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En ciertos contextos, el estudio de la curva <span class="math inline">\(ROC\)</span> en su totalidad no es de interés. En aplicaciones médicas y en otros campos, suelen seleccionarse ciertos rangos de la curva debido al interés por unos valores concretos de <span class="math inline">\(TPR\)</span> o <span class="math inline">\(FPR\)</span>.</p>
<p>Por ejemplo, en un contexto de diagnóstico, un marcador con un bajo <span class="math inline">\(FPR\)</span> (alta especificidad) es relevante a la hora de confirmar la presencia de una condición (“rule in”), dado que es muy improbable que se de un falso positivo. Mientras que un marcador con un alto <span class="math inline">\(TPR\)</span> (alta sensibilidad) es relevante para descartar la presencia de una condición (“rule out”), dado que es muy improbable que se de un falso negativo.</p>
<p>En este tipo de situaciones, el área parcial de la curva <span class="math inline">\(ROC\)</span> (<span class="math inline">\(pAUC\)</span>) atrae mucha más atención como métrica, ya que sintetiza la información en la región de interés en lugar de en toda la curva.</p>
</div>
<div id="cálculo-de-paucs-en-regiones-de-alta-especificidad" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Cálculo de pAUCs en regiones de alta especificidad<a href="index-evaluation.html#cálculo-de-paucs-en-regiones-de-alta-especificidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un diagnóstico temprano de ciertas enfermedades, como es el caso del cáncer de próstata, es de gran importancia dado que puede mejorar el pronóstico de un paciente en gran medida <span class="citation">(<a href="referencias.html#ref-early-detection">Wang and Chang 2011</a>)</span>. Sin embargo, el tratamiento de estas enfermedades puede ser agresivo y por tanto debe considerarse cuidadosamente. En este contexto, es conveniente reducir los casos en los que se trata a pacientes sanos, es decir el número de falsos positivos, por ello se requieren condiciones de alta especificidad.</p>
<p>Con el fin de trabajar en estas condiciones se seleccionarán arbitrariamente rangos de <span class="math inline">\(1 - FPR\)</span> contenidos en un intervalo de <span class="math inline">\((0.9, 1)\)</span>. Para realizar estos cálculos se usará de nuevo la función <code>pROC::auc</code> indicando que se trabajará sobre el rango indicado (<code>partial.auc = c(0.9, 1)</code>) y sobre la especificidad (<code>partial.auc.focus = "spec"</code>).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="index-evaluation.html#cb66-1" tabindex="-1"></a>pauc_sp_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb66-2"><a href="index-evaluation.html#cb66-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb66-3"><a href="index-evaluation.html#cb66-3" tabindex="-1"></a>    auc,</span>
<span id="cb66-4"><a href="index-evaluation.html#cb66-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb66-5"><a href="index-evaluation.html#cb66-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;spec&quot;</span>,</span>
<span id="cb66-6"><a href="index-evaluation.html#cb66-6" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb66-7"><a href="index-evaluation.html#cb66-7" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb66-8"><a href="index-evaluation.html#cb66-8" tabindex="-1"></a>    <span class="at">quiet =</span> T,</span>
<span id="cb66-9"><a href="index-evaluation.html#cb66-9" tabindex="-1"></a>    <span class="at">.progress =</span> T</span>
<span id="cb66-10"><a href="index-evaluation.html#cb66-10" tabindex="-1"></a>)</span></code></pre></div>
<p>De forma similar, determinar el pronóstico de un paciente es relevante para seleccionar un tratamiento más o menos agresivo. Cometer falsos positivos en este contexto implica consecuencias graves para el paciente, por este motivo, también se considerarán condiciones de alta especificidad para determinar un pronóstico.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="index-evaluation.html#cb67-1" tabindex="-1"></a>pauc_sp_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb67-2"><a href="index-evaluation.html#cb67-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb67-3"><a href="index-evaluation.html#cb67-3" tabindex="-1"></a>    auc,</span>
<span id="cb67-4"><a href="index-evaluation.html#cb67-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb67-5"><a href="index-evaluation.html#cb67-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;spec&quot;</span>,</span>
<span id="cb67-6"><a href="index-evaluation.html#cb67-6" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb67-7"><a href="index-evaluation.html#cb67-7" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb67-8"><a href="index-evaluation.html#cb67-8" tabindex="-1"></a>    <span class="at">quiet =</span> T,</span>
<span id="cb67-9"><a href="index-evaluation.html#cb67-9" tabindex="-1"></a>    <span class="at">.progress =</span> T</span>
<span id="cb67-10"><a href="index-evaluation.html#cb67-10" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="cálculo-de-paucs-en-regiones-de-alta-sensibilidad" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Cálculo de pAUCs en regiones de alta sensibilidad<a href="index-evaluation.html#cálculo-de-paucs-en-regiones-de-alta-sensibilidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De forma similar, es posible trasladar el caso a condiciones de alta sensibilidad. Una alta sensibilidad se requiere en enfermedades que son fatales si no son tratadas, es decir, cometer un falso negativo implica la muerte del paciente. De esta forma, cuando un mal pronóstico para la enfermedad implica graves consecuencias, se debe considerar una alta sensibilidad.</p>
<p>De este modo, para calcular los índices, simplemente se realizará el procedimiento anterior pero esta vez indicando que se utilizará la sensibilidad (<code>partial.auc.focus = "sens"</code>).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="index-evaluation.html#cb68-1" tabindex="-1"></a>pauc_sn_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb68-2"><a href="index-evaluation.html#cb68-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb68-3"><a href="index-evaluation.html#cb68-3" tabindex="-1"></a>    auc,</span>
<span id="cb68-4"><a href="index-evaluation.html#cb68-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb68-5"><a href="index-evaluation.html#cb68-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;sens&quot;</span>,</span>
<span id="cb68-6"><a href="index-evaluation.html#cb68-6" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb68-7"><a href="index-evaluation.html#cb68-7" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb68-8"><a href="index-evaluation.html#cb68-8" tabindex="-1"></a>    <span class="at">quiet =</span> T,</span>
<span id="cb68-9"><a href="index-evaluation.html#cb68-9" tabindex="-1"></a>    <span class="at">.progress =</span> T</span>
<span id="cb68-10"><a href="index-evaluation.html#cb68-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Finalmente, desde el punto de vista clínico también es relevante un contexto de alta sensibilidad para el diagnóstico de la enfermedad. Como se ha explicado antes, un diagnóstico temprano puede ser relevante para evitar la muerte del paciente. Por este motivo, también debería considerarse esta métrica para realizar los cálculos.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="index-evaluation.html#cb69-1" tabindex="-1"></a>pauc_sn_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb69-2"><a href="index-evaluation.html#cb69-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb69-3"><a href="index-evaluation.html#cb69-3" tabindex="-1"></a>    auc,</span>
<span id="cb69-4"><a href="index-evaluation.html#cb69-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb69-5"><a href="index-evaluation.html#cb69-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;sens&quot;</span>,</span>
<span id="cb69-6"><a href="index-evaluation.html#cb69-6" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb69-7"><a href="index-evaluation.html#cb69-7" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb69-8"><a href="index-evaluation.html#cb69-8" tabindex="-1"></a>    <span class="at">quiet =</span> T,</span>
<span id="cb69-9"><a href="index-evaluation.html#cb69-9" tabindex="-1"></a>    <span class="at">.progress =</span> T</span>
<span id="cb69-10"><a href="index-evaluation.html#cb69-10" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="índices-derivados-de-pauc" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Índices derivados de pAUC<a href="index-evaluation.html#índices-derivados-de-pauc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="problemas-del-pauc" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Problemas del pAUC<a href="index-evaluation.html#problemas-del-pauc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aunque el <span class="math inline">\(pAUC\)</span> puede ser útil para trabajar en regiones de interés en la curva <span class="math inline">\(ROC\)</span>, no está libre de fallas. Este índice ha sido cuestionado por su falta de interpretabilidad, ya que aunque algunos marcadores presentan valores altos de <span class="math inline">\(AUC\)</span> y rinden bien en las zonas seleccionadas, presentan valores de <span class="math inline">\(pAUC\)</span> muy cercanos a 0. Esto puede comprobarse, por ejemplo, con los 10 marcadores de mayor <span class="math inline">\(AUC\)</span> en condiciones de alta especificidad:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="index-evaluation.html#cb70-1" tabindex="-1"></a><span class="fu">enframe</span>(auc_diagnostic) <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="index-evaluation.html#cb70-2" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="index-evaluation.html#cb70-3" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb70-4"><a href="index-evaluation.html#cb70-4" tabindex="-1"></a>        <span class="fu">enframe</span>(pauc_sp_diagnostic),</span>
<span id="cb70-5"><a href="index-evaluation.html#cb70-5" tabindex="-1"></a>        <span class="fu">join_by</span>(name <span class="sc">==</span> name)</span>
<span id="cb70-6"><a href="index-evaluation.html#cb70-6" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="index-evaluation.html#cb70-7" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb70-8"><a href="index-evaluation.html#cb70-8" tabindex="-1"></a>        <span class="at">auc =</span> value.x,</span>
<span id="cb70-9"><a href="index-evaluation.html#cb70-9" tabindex="-1"></a>        <span class="at">pauc =</span> value.y</span>
<span id="cb70-10"><a href="index-evaluation.html#cb70-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="index-evaluation.html#cb70-11" tabindex="-1"></a>    .[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000105707
</td>
<td style="text-align:right;">
0.9436868
</td>
<td style="text-align:right;">
0.0746093
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000181378
</td>
<td style="text-align:right;">
0.9252605
</td>
<td style="text-align:right;">
0.0749387
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000124839
</td>
<td style="text-align:right;">
0.9229620
</td>
<td style="text-align:right;">
0.0680432
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000006625
</td>
<td style="text-align:right;">
0.9207784
</td>
<td style="text-align:right;">
0.0553402
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000242110
</td>
<td style="text-align:right;">
0.9157217
</td>
<td style="text-align:right;">
0.0672311
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000159263
</td>
<td style="text-align:right;">
0.9103203
</td>
<td style="text-align:right;">
0.0528042
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000138028
</td>
<td style="text-align:right;">
0.9091710
</td>
<td style="text-align:right;">
0.0505440
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000173638
</td>
<td style="text-align:right;">
0.9071407
</td>
<td style="text-align:right;">
0.0513178
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000245750
</td>
<td style="text-align:right;">
0.9061063
</td>
<td style="text-align:right;">
0.0549264
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000176058
</td>
<td style="text-align:right;">
0.9044591
</td>
<td style="text-align:right;">
0.0604658
</td>
</tr>
</tbody>
</table>
<p>Como se observa, los <span class="math inline">\(pAUC\)</span> no superan el <span class="math inline">\(0.5\)</span>; valor límite en el <span class="math inline">\(AUC\)</span> con el que se considera que un clasificador rinde igual que uno completamente aleatorio. Además, en ciertos escenarios, el <span class="math inline">\(pAUC\)</span> no puede distinguir que clasificador presentaría un mejor rendimiento. Por ejemplo, cuando se comparan clasificadores con <span class="math inline">\(pAUC\)</span>s iguales y curvas <span class="math inline">\(ROC\)</span> que se cruzan <span class="citation">(<a href="referencias.html#ref-pauc-comparison">H. Ma, Bandos, and Gur 2015</a>)</span>.</p>
<p>Para lidiar con estas limitaciones, distintas transformaciones del <span class="math inline">\(pAUC\)</span> se han desarrollado para trabajar en condiciones de alta sensibilidad y especificidad.</p>
</div>
<div id="índices-para-la-especificidad" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Índices para la especificidad<a href="index-evaluation.html#índices-para-la-especificidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="spauc" class="section level4 hasAnchor" number="5.3.2.1">
<h4><span class="header-section-number">5.3.2.1</span> SpAUC<a href="index-evaluation.html#spauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Una de las primeras transformaciones descritas es el <strong>área parcial bajo la curva estandarizada</strong> (<span class="math inline">\(SpAUC\)</span>), propuesto por <span class="citation">McClish (<a href="referencias.html#ref-spauc">1989</a>)</span>. Esta transformación trabaja sobre un rango concreto de especificidad, <span class="math inline">\((FPR_1, FPR_2)\)</span>, donde los valores que puede tomar el <span class="math inline">\(pAUC\)</span> se escalan a valores dentro del intervalo <span class="math inline">\((0.5, 1)\)</span> haciendo que la métrica sea más interpretable.</p>
<p>El límite superior para el área del <span class="math inline">\(pAUC\)</span> está definido por el rectángulo formado por los puntos: <span class="math inline">\((FPR_1, 0), (FPR_2, 0), (FPR_1, 1)\)</span> y <span class="math inline">\((FPR_2, 1)\)</span>. Mientras que, el límite inferior está definido por el trapecio con puntos: <span class="math inline">\((FPR_1, 0), (FPR_2, 0), (FPR_1, FPR_1)\)</span> y <span class="math inline">\((FPR_2, FPR_2)\)</span>, el cual coincide con la diagonal de la curva.</p>
<p>Si se desarrollan las áreas de los límites superior e inferior, el área que puede tomar <span class="math inline">\(pAUC\)</span> (<span class="math inline">\(A\)</span>) está definida de la siguiente forma:</p>
<p><span class="math display" id="eq:spauc-bounds">\[\begin{equation}
    \dfrac{1}{2}(FPR_2 - FPR_1)(FPR_2 + FPR_1) \le A \le FPR_2 - FPR_1
    \tag{5.1}
\end{equation}\]</span></p>
<p>Finalmente, aplicando la siguiente transformación <a href="index-evaluation.html#eq:mcclish-transformation">(5.2)</a>, se logra que el índice tome un valor de <span class="math inline">\(1\)</span> cuando <span class="math inline">\(A = \text{max}\)</span> y un valor de <span class="math inline">\(0.5\)</span> cuando <span class="math inline">\(A = \text{min}\)</span>, escalando el <span class="math inline">\(pAUC\)</span> al área total.</p>
<p><span class="math display" id="eq:mcclish-transformation">\[\begin{equation}
    \dfrac{1}{2}\left[1 + \dfrac{A - \text{min}}{\text{max} - \text{min}} \right]
    \tag{5.2}
\end{equation}\]</span></p>
<p>A pesar de la mejora en su interpretabilidad, la métrica todavía presenta algunas limitaciones. En la práctica, las curvas <span class="math inline">\(ROC\)</span> suelen atravesar la diagonal, por lo que, el límite inferior definido en <a href="index-evaluation.html#eq:spauc-bounds">(5.1)</a> no estará bien definido en estos casos. Además, el índice no solventa el problema de comparar 2 clasificadores con igual <span class="math inline">\(pAUC\)</span> y curvas <span class="math inline">\(ROC\)</span> que se cruzan.</p>
<p>Conociendo las ventajas y limitaciones de la métrica, esta se aplicará al conjunto de datos para contrastarla con otras más adelante. Para ello se utilizará la función <code>pROC::auc</code> indicando el argumento <code>partial.auc.correct = TRUE</code>, que aplicará la transformación descrita por McClish. Además, se indicará el parámetro <code>allow.invalid.partial.auc.correct = FALSE</code>, de esta forma, la función no calculará el índice cuando la curva se encuentra descrita por debajo del área mínima, puesto que el límite inferior no estará bien definido, devolviendo en su lugar un <code>NA</code>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="index-evaluation.html#cb71-1" tabindex="-1"></a>spauc_sp_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb71-2"><a href="index-evaluation.html#cb71-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb71-3"><a href="index-evaluation.html#cb71-3" tabindex="-1"></a>    auc,</span>
<span id="cb71-4"><a href="index-evaluation.html#cb71-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb71-5"><a href="index-evaluation.html#cb71-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;spec&quot;</span>,</span>
<span id="cb71-6"><a href="index-evaluation.html#cb71-6" tabindex="-1"></a>    <span class="at">partial.auc.correct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-7"><a href="index-evaluation.html#cb71-7" tabindex="-1"></a>    <span class="at">allow.invalid.partial.auc.correct =</span> <span class="cn">FALSE</span>,</span>
<span id="cb71-8"><a href="index-evaluation.html#cb71-8" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb71-9"><a href="index-evaluation.html#cb71-9" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb71-10"><a href="index-evaluation.html#cb71-10" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-11"><a href="index-evaluation.html#cb71-11" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb71-12"><a href="index-evaluation.html#cb71-12" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="index-evaluation.html#cb72-1" tabindex="-1"></a>spauc_sp_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb72-2"><a href="index-evaluation.html#cb72-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb72-3"><a href="index-evaluation.html#cb72-3" tabindex="-1"></a>    auc,</span>
<span id="cb72-4"><a href="index-evaluation.html#cb72-4" tabindex="-1"></a>    <span class="at">partial.auc =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>),</span>
<span id="cb72-5"><a href="index-evaluation.html#cb72-5" tabindex="-1"></a>    <span class="at">partial.auc.focus =</span> <span class="st">&quot;spec&quot;</span>,</span>
<span id="cb72-6"><a href="index-evaluation.html#cb72-6" tabindex="-1"></a>    <span class="at">partial.auc.correct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-7"><a href="index-evaluation.html#cb72-7" tabindex="-1"></a>    <span class="at">allow.invalid.partial.auc.correct =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-8"><a href="index-evaluation.html#cb72-8" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb72-9"><a href="index-evaluation.html#cb72-9" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>,</span>
<span id="cb72-10"><a href="index-evaluation.html#cb72-10" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-11"><a href="index-evaluation.html#cb72-11" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb72-12"><a href="index-evaluation.html#cb72-12" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="tpauc" class="section level4 hasAnchor" number="5.3.2.2">
<h4><span class="header-section-number">5.3.2.2</span> TpAUC<a href="index-evaluation.html#tpauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para solventar los problemas que presenta el <span class="math inline">\(SpAUC\)</span>, <span class="citation">Vivo, Franco, and Vicari (<a href="referencias.html#ref-tpauc">2018</a>)</span> han propuesto una transformación alternativa para regiones de alta especificidad, el denominado <em>tighter partial area index</em> (<span class="math inline">\(TpAUC\)</span>). Este nuevo índice define límites más ajustados que el anterior y considera la forma que adopta una curva <span class="math inline">\(ROC\)</span>, es decir, es compatible con curvas definidas por debajo de la diagonal o inadecuadas.</p>
<p>Los límites iniciales propuestos por el <span class="math inline">\(TpAUC\)</span> parten de los establecidos por el <span class="math inline">\(SpAUC\)</span>, <a href="index-evaluation.html#eq:spauc-bounds">(5.1)</a>. Sin embargo, Vivo et al. proponen que estos límites pueden ajustarse a las regiones donde la curva se encuentre definida. Es decir, estos límites se ajustan a los puntos de la curva presentes en la región de interés, donde <span class="math inline">\(TPR_i = TPR(FPR_i)\)</span> para <span class="math inline">\(i = 1,2\)</span>. Estos límites ajustados se definen de la siguiente forma:</p>
<p><span class="math display" id="eq:tpauc-bounds">\[\begin{equation}
    TPR_1(FPR_2 - FPR_1) \le A \le TPR_2(FPR_2-FPR_1)
    \tag{5.3}
\end{equation}\]</span></p>
<p>El nuevo límite inferior es más consistente, ajustándose a la forma de la curva incluso cuando estas no son adecuadas, es decir, están definidas por debajo de la línea del azar. Sin embargo, cuando las curvas <span class="math inline">\(ROC\)</span> son adecuadas, se pueden describir límites más ajustados. Por definición, estas curvas son siempre no decrecientes, por lo que los siguientes límites podrían ser descritos:</p>
<p><span class="math display" id="eq:tpauc-proper-bounds">\[\begin{equation}
    \text{max}\left\{TPR_1(FPR_2 - FPR_1), \dfrac{1}{2}(FPR_2 - FPR_1)(FPR_2 + FPR_1)\right\} \le \\
    A \le TPR_2(FPR_2-FPR_1)
    \tag{5.4}
\end{equation}\]</span></p>
<p>Finalmente, se pueden encontrar límites más ajustados cuando las curvas son cóncavas. Una curva <span class="math inline">\(ROC\)</span> cóncava presenta un ratio de probabilidad positivo (<span class="math inline">\(PLR(t) = ROC(t)/t\)</span>) decreciente, es decir, este alcanza valores mínimos en el extremo superior de la curva. Así, si esta condición se cumple en la región de interés, se puede describir un nuevo límite inferior. Este límite más ajustado se corresponde con el trapecio de puntos: <span class="math inline">\((FPR_1,0), (FPR_2, 0), (FPR_1, TPR_2)\)</span> y <span class="math inline">\((FPR_2, TPR_2)\)</span>, que considerando su área se obtiene la siguiente expresión:</p>
<p><span class="math display" id="eq:tpauc-concave-bounds">\[\begin{equation}
    \dfrac{1}{2}(TPR_1+TPR_2)(FPR_2-FPR_1) \le A \le TPR_2(FPR_2-FPR_1)
    \tag{5.5}
\end{equation}\]</span></p>
<p>Descritos los límites y condiciones donde se aplican, es posible utilizar la transformación descrita por McClish <a href="index-evaluation.html#eq:mcclish-transformation">(5.2)</a> para encapsular los valores en el rango <span class="math inline">\((0.5, 1)\)</span>. Tras aplicar la transformación el resultado obtenido se corresponde con el <span class="math inline">\(TpAUC\)</span>.</p>
<p>De forma similar al <span class="math inline">\(SpAUC\)</span>, el <span class="math inline">\(TpAUC\)</span> se aplicará en el conjunto de datos para más tarde contrastarlo con las demás métricas. El algoritmo para calcular el <span class="math inline">\(TpAUC\)</span> se encuentra implementado en el paquete <code>ROCpAI</code> de <a href="https://www.bioconductor.org/packages/release/bioc/html/ROCpAI.html">Bioconductor</a>, concretamente, en la función <code>ROCpAI::tpAUC</code>.</p>
<p>La función <code>tpAUC</code> requiere de indicar la región de la curva en la que aplicar los cálculos (<code>low.value</code> y <code>up.value</code>) y el conjunto de datos. Este último requerirá que la primera columna se corresponda con la variable respuesta, mientras que el resto con los demás predictores.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="index-evaluation.html#cb73-1" tabindex="-1"></a>tpauc_sp_diagnostic_assay <span class="ot">&lt;-</span> <span class="fu">tpAUC</span>(</span>
<span id="cb73-2"><a href="index-evaluation.html#cb73-2" tabindex="-1"></a>    <span class="at">dataset =</span> diagnostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb73-3"><a href="index-evaluation.html#cb73-3" tabindex="-1"></a>        <span class="at">disease =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb73-4"><a href="index-evaluation.html#cb73-4" tabindex="-1"></a>        <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb73-5"><a href="index-evaluation.html#cb73-5" tabindex="-1"></a>    ),</span>
<span id="cb73-6"><a href="index-evaluation.html#cb73-6" tabindex="-1"></a>    <span class="at">low.value =</span> <span class="dv">0</span>,</span>
<span id="cb73-7"><a href="index-evaluation.html#cb73-7" tabindex="-1"></a>    <span class="at">up.value =</span> <span class="fl">0.1</span>,</span>
<span id="cb73-8"><a href="index-evaluation.html#cb73-8" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb73-9"><a href="index-evaluation.html#cb73-9" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="index-evaluation.html#cb74-1" tabindex="-1"></a>tpauc_sp_prognostic_assay <span class="ot">&lt;-</span> <span class="fu">tpAUC</span>(</span>
<span id="cb74-2"><a href="index-evaluation.html#cb74-2" tabindex="-1"></a>    <span class="at">dataset =</span> prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb74-3"><a href="index-evaluation.html#cb74-3" tabindex="-1"></a>        <span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb74-4"><a href="index-evaluation.html#cb74-4" tabindex="-1"></a>        <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb74-5"><a href="index-evaluation.html#cb74-5" tabindex="-1"></a>    ),</span>
<span id="cb74-6"><a href="index-evaluation.html#cb74-6" tabindex="-1"></a>    <span class="at">low.value =</span> <span class="dv">0</span>,</span>
<span id="cb74-7"><a href="index-evaluation.html#cb74-7" tabindex="-1"></a>    <span class="at">up.value =</span> <span class="fl">0.1</span>,</span>
<span id="cb74-8"><a href="index-evaluation.html#cb74-8" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb74-9"><a href="index-evaluation.html#cb74-9" tabindex="-1"></a>)</span></code></pre></div>
<p>La salida de la función devolverá un objeto con diversas métricas. Utilizando la función <code>assay</code> se podrán extraer los <span class="math inline">\(TpAUC\)</span> almacenados en <code>St_pAUC</code>. Finalmente, los identificadores de cada clasificador se asignarán a cada uno de los resultados.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="index-evaluation.html#cb75-1" tabindex="-1"></a>tpauc_sp_diagnostic <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">assay</span>(tpauc_sp_diagnostic_assay)<span class="sc">$</span>St_pAUC)</span>
<span id="cb75-2"><a href="index-evaluation.html#cb75-2" tabindex="-1"></a>tpauc_sp_prognostic <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">assay</span>(tpauc_sp_prognostic_assay)<span class="sc">$</span>St_pAUC)</span>
<span id="cb75-3"><a href="index-evaluation.html#cb75-3" tabindex="-1"></a><span class="fu">names</span>(tpauc_sp_diagnostic) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(diagnostic_dataset)</span>
<span id="cb75-4"><a href="index-evaluation.html#cb75-4" tabindex="-1"></a><span class="fu">names</span>(tpauc_sp_prognostic) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(prognostic_dataset)</span></code></pre></div>
</div>
</div>
<div id="índices-para-la-sensibilidad" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Índices para la sensibilidad<a href="index-evaluation.html#índices-para-la-sensibilidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="npauc" class="section level4 hasAnchor" number="5.3.3.1">
<h4><span class="header-section-number">5.3.3.1</span> NpAUC<a href="index-evaluation.html#npauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El índice <em>normalized partial area</em> (<span class="math inline">\(NpAUC\)</span>), propuesto por <span class="citation">Y. Jiang, Metz, and Nishikawa (<a href="referencias.html#ref-npauc">1996</a>)</span>, fue uno de los primeros enfocados en regiones de alta sensibilidad. Este índice es conceptualmente similar al <span class="math inline">\(SpAUC\)</span>, salvo que en este caso son <span class="math inline">\(TPR_1 = TPR_0\)</span> y <span class="math inline">\(TPR_2 = 1\)</span> los que definen sus límites superior e inferior. Concretamente, estos límites están definidos como:</p>
<ul>
<li>El rectángulo de puntos <span class="math inline">\((1,1), (1, TPR_0), (0, 1)\)</span> y <span class="math inline">\((0, TPR_0)\)</span>, es decir, de longitud <span class="math inline">\(1\)</span> y altura dado por la banda <span class="math inline">\(1 - TPR_0\)</span>.</li>
<li>El triángulo de puntos <span class="math inline">\((TPR_0, TPR_0), (1, TPR_0)\)</span> y <span class="math inline">\((1,1)\)</span>.</li>
</ul>
<p>Estos límites, de forma desarrollada, quedan expresados de la siguiente forma:</p>
<p><span class="math display" id="eq:npauc-bounds">\[\begin{equation}
    \dfrac{1}{2}(1 - TPR_0)^2 \le A \le 1 - TPR_0
    \tag{5.6}
\end{equation}\]</span></p>
<p>Para realizar la normalización, cada término se divide entre el límite superior (<span class="math inline">\(1 - TPR_0\)</span>) generando la expresión:</p>
<p><span class="math display" id="eq:npauc-normalized-bounds">\[\begin{equation}
    \dfrac{1}{2}(1-TPR_0) \le \dfrac{A}{1 - TPR_0} \le 1
    \tag{5.7}
\end{equation}\]</span></p>
<p>Así, el <span class="math inline">\(NpAUC\)</span> se corresponde con el término central, quedando definido como:</p>
<p><span class="math display" id="eq:npauc-index">\[\begin{equation}
        NpAUC = \dfrac{A}{1 - TPR_0}
    \tag{5.8}
\end{equation}\]</span></p>
<p>Debido a esta transformación, el <span class="math inline">\(NpAUC\)</span> se puede interpretar como el valor promedio de la especificidad para los valores de sensibilidad por encima de <span class="math inline">\(TPR_0\)</span>. Sin embargo, a pesar de ser más interpretable el índice sigue presentando desventajas. En primer lugar, el <span class="math inline">\(NpAUC\)</span> puede tomar valores inferiores a <span class="math inline">\(0.5\)</span>, dificultando su interpretación. En segundo lugar, no es capaz de distinguir clasificadores con igual <span class="math inline">\(pAUC\)</span> y curvas <span class="math inline">\(ROC\)</span> que se cruzan, independientemente de su forma.</p>
<p>Igual que en los casos anteriores, el <span class="math inline">\(NpAUC\)</span> se aplicará al conjunto de datos para contrastarlo más adelante. El índice no está implementado en ningún paquete conocido, de modo que para aplicarlo de forma sencilla se ha incluido en un paquete propio, <code>ROCnGO</code>. Este paquete cuenta con la función <code>ROCnGO::np_auc</code> que permite calcular el índice con un procedimiento similar a los anteriores.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="index-evaluation.html#cb76-1" tabindex="-1"></a>npauc_sn_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb76-2"><a href="index-evaluation.html#cb76-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb76-3"><a href="index-evaluation.html#cb76-3" tabindex="-1"></a>    \(gene) {</span>
<span id="cb76-4"><a href="index-evaluation.html#cb76-4" tabindex="-1"></a>        <span class="fu">np_auc</span>(</span>
<span id="cb76-5"><a href="index-evaluation.html#cb76-5" tabindex="-1"></a>            <span class="at">predictor =</span> gene,</span>
<span id="cb76-6"><a href="index-evaluation.html#cb76-6" tabindex="-1"></a>            <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb76-7"><a href="index-evaluation.html#cb76-7" tabindex="-1"></a>            <span class="at">lower_tpr =</span> <span class="fl">0.9</span></span>
<span id="cb76-8"><a href="index-evaluation.html#cb76-8" tabindex="-1"></a>        )</span>
<span id="cb76-9"><a href="index-evaluation.html#cb76-9" tabindex="-1"></a>    },</span>
<span id="cb76-10"><a href="index-evaluation.html#cb76-10" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb76-11"><a href="index-evaluation.html#cb76-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="index-evaluation.html#cb77-1" tabindex="-1"></a>npauc_sn_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb77-2"><a href="index-evaluation.html#cb77-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb77-3"><a href="index-evaluation.html#cb77-3" tabindex="-1"></a>    \(gene) {</span>
<span id="cb77-4"><a href="index-evaluation.html#cb77-4" tabindex="-1"></a>        <span class="fu">np_auc</span>(</span>
<span id="cb77-5"><a href="index-evaluation.html#cb77-5" tabindex="-1"></a>            <span class="at">predictor =</span> gene,</span>
<span id="cb77-6"><a href="index-evaluation.html#cb77-6" tabindex="-1"></a>            <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb77-7"><a href="index-evaluation.html#cb77-7" tabindex="-1"></a>            <span class="at">lower_tpr =</span> <span class="fl">0.9</span></span>
<span id="cb77-8"><a href="index-evaluation.html#cb77-8" tabindex="-1"></a>        )</span>
<span id="cb77-9"><a href="index-evaluation.html#cb77-9" tabindex="-1"></a>    },</span>
<span id="cb77-10"><a href="index-evaluation.html#cb77-10" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb77-11"><a href="index-evaluation.html#cb77-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="fpauc" class="section level4 hasAnchor" number="5.3.3.2">
<h4><span class="header-section-number">5.3.3.2</span> FpAUC<a href="index-evaluation.html#fpauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>De forma similar al <span class="math inline">\(TpAUC\)</span> con respecto al <span class="math inline">\(SpAUC\)</span>, <span class="citation">Franco and Vivo (<a href="referencias.html#ref-fpauc">2021</a>)</span> propusieron el <em>fitted partial area index</em> (<span class="math inline">\(FpAUC\)</span>) para solventar las desventajas del <span class="math inline">\(NpAUC\)</span> en rangos de alta sensibilidad. Este nuevo índice buscaba:</p>
<ol style="list-style-type: decimal">
<li>Ser interpretable como métrica de diagnóstico. Esto incluye ser igual a <span class="math inline">\(AUC\)</span> cuando <span class="math inline">\(TPR_0 = 0\)</span>.</li>
<li>Aplicarse a cualquier forma de la curva <span class="math inline">\(ROC\)</span>, incluyendo las inadecuadas.</li>
<li>Distinguir dos clasificadores con <span class="math inline">\(pAUC\)</span> iguales y que sus curvas <span class="math inline">\(ROC\)</span> se crucen.</li>
</ol>
<p>Para realizar el cálculo del <span class="math inline">\(FpAUC\)</span> se requiere definir nuevos límites para el <span class="math inline">\(pAUC\)</span> en condiciones de alta sensibilidad, para ello, se partirá de los límites iniciales definidios en <span class="math inline">\(NpAUC\)</span> <a href="index-evaluation.html#eq:npauc-bounds">(5.6)</a>. En primer lugar, un nuevo límite superior puede ser definido. Este nuevo límite puede ajustarse a la zona donde se encuentre definida la curva, es decir, al rectángulo de puntos <span class="math inline">\((FPR_0, TPR_0), (FPR_0, 1), (1, TPR_0)\)</span> y <span class="math inline">\((1,1)\)</span> donde <span class="math inline">\(FPR_0 = FPR(TPR_0)\)</span>. Desarrollando el área de este rectángulo se obtiene la siguiente expresión <a href="index-evaluation.html#eq:tpauc-upper-bound">(5.9)</a>.</p>
<p><span class="math display" id="eq:tpauc-upper-bound">\[\begin{equation}
    \dfrac{1}{2}(1 - TPR_0)^2 \le A \le (1-FPR_0)(1 - TPR_0)
    \tag{5.9}
\end{equation}\]</span></p>
<p>Como se ha explicado anteriormente en la sección <a href="index-evaluation.html#tpauc">5.3.2.2</a>, las curvas <span class="math inline">\(ROC\)</span> son funciones monótonas no decrecientes. Esto no asegura su concavidad, ya que en ocasiones pueden pasar por debajo de la línea del azar y mostrar rendimientos peores al de un predictor aleatorio. La concavidad de una curva <span class="math inline">\(ROC\)</span> puede determinarse por métricas como el ratio de probabilidad negativa (<span class="math inline">\(NLR = (1 - ROC(t))/(1 - t)\)</span>). El <span class="math inline">\(NLR\)</span> se corresponde con la pendiente de una línea recta que pasa por un punto de la curva hasta el punto <span class="math inline">\((1,1)\)</span>, por tanto, un <span class="math inline">\(NLR\)</span> decreciente se corresponderá con curvas <span class="math inline">\(ROC\)</span> cóncavas.</p>
<p>De esta forma, si se asegura la concavidad en la región de alta sensibilidad, o el <span class="math inline">\(NLR\)</span> es decreciente en dicha zona, un nuevo límite inferior puede ser definido. Este nuevo límite más ajustado se define por el triángulo de puntos <span class="math inline">\((FPR_0, TPR_0), (1, TPR_0)\)</span> y <span class="math inline">\((1,1)\)</span>, que desarrollado se puede expresar de la siguiente forma:</p>
<p><span class="math display" id="eq:tpauc-concave-bound">\[\begin{equation}
    \dfrac{1}{2}(1 - FPR_0)(1 - TPR_0) \le A \le (1-FPR_0)(1 - TPR_0)
    \tag{5.10}
\end{equation}\]</span></p>
<p>Finalmente, las curvas <span class="math inline">\(ROC\)</span> pueden presentar ganchos (regiones donde no la curva <span class="math inline">\(ROC\)</span> no es cóncava) en el extremo superior de la región de interés, en estas situaciones el límite inferior definido en <a href="index-evaluation.html#eq:tpauc-upper-bound">(5.9)</a> tampoco se ajusta a la curva. De esta forma, si existe un punto en la región de interés que cumpla <span class="math inline">\(NLR(t) &gt; \text{max}\ \{1, NLR_0\}\)</span>, no se podrá encontrar un límite inferior que se ajuste y por tanto:</p>
<p><span class="math display" id="eq:tpauc-upper-hook-bound">\[\begin{equation}
    0 \le A \le (1-FPR_0)(1 - TPR_0)
    \tag{5.11}
\end{equation}\]</span></p>
<p>Conociendo todos los casos posibles, y aplicando la transformación descrita por McClish <a href="index-evaluation.html#eq:mcclish-transformation">(5.2)</a> se obtiene el <span class="math inline">\(FpAUC\)</span>.</p>
<p>De forma similar a los casos anteriores, el <span class="math inline">\(FpAUC\)</span> se calculará para contrastarlo con el resto. Al igual que el <span class="math inline">\(NpAUC\)</span>, este índice no se encuentra implementado en ningún paquete conocido, por lo que para facilitar su aplicación se ha implementado en el paquete <code>ROCnGO</code>. Para realizar los cálculos sobre el conjunto de datos, se utilizará la función <code>ROCnGO::fp_auc</code>:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="index-evaluation.html#cb78-1" tabindex="-1"></a>fpauc_sn_diagnostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb78-2"><a href="index-evaluation.html#cb78-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb78-3"><a href="index-evaluation.html#cb78-3" tabindex="-1"></a>    \(gene) {</span>
<span id="cb78-4"><a href="index-evaluation.html#cb78-4" tabindex="-1"></a>        <span class="fu">fp_auc</span>(</span>
<span id="cb78-5"><a href="index-evaluation.html#cb78-5" tabindex="-1"></a>            <span class="at">predictor =</span> gene,</span>
<span id="cb78-6"><a href="index-evaluation.html#cb78-6" tabindex="-1"></a>            <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb78-7"><a href="index-evaluation.html#cb78-7" tabindex="-1"></a>            <span class="at">lower_tpr =</span> <span class="fl">0.9</span></span>
<span id="cb78-8"><a href="index-evaluation.html#cb78-8" tabindex="-1"></a>        )</span>
<span id="cb78-9"><a href="index-evaluation.html#cb78-9" tabindex="-1"></a>    },</span>
<span id="cb78-10"><a href="index-evaluation.html#cb78-10" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb78-11"><a href="index-evaluation.html#cb78-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="index-evaluation.html#cb79-1" tabindex="-1"></a>fpauc_sn_prognostic <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb79-2"><a href="index-evaluation.html#cb79-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb79-3"><a href="index-evaluation.html#cb79-3" tabindex="-1"></a>    \(gene) {</span>
<span id="cb79-4"><a href="index-evaluation.html#cb79-4" tabindex="-1"></a>        <span class="fu">fp_auc</span>(</span>
<span id="cb79-5"><a href="index-evaluation.html#cb79-5" tabindex="-1"></a>            <span class="at">predictor =</span> gene,</span>
<span id="cb79-6"><a href="index-evaluation.html#cb79-6" tabindex="-1"></a>            <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb79-7"><a href="index-evaluation.html#cb79-7" tabindex="-1"></a>            <span class="at">lower_tpr =</span> <span class="fl">0.9</span></span>
<span id="cb79-8"><a href="index-evaluation.html#cb79-8" tabindex="-1"></a>        )</span>
<span id="cb79-9"><a href="index-evaluation.html#cb79-9" tabindex="-1"></a>    },</span>
<span id="cb79-10"><a href="index-evaluation.html#cb79-10" tabindex="-1"></a>    <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb79-11"><a href="index-evaluation.html#cb79-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div id="comparación-de-índices" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Comparación de índices<a href="index-evaluation.html#comparación-de-índices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta ahora, para identificar posibles marcadores de diagnóstico y pronóstico se han utilizado distintos índices en condiciones de alta sensibilidad y especificidad. Sin embargo, como se ha explicado previamente, cada índice presenta una serie de ventajas y desventajas. Por consiguiente, para evaluar cual de todos los índices presenta un mejor rendimiento para seleccionar clasificadores, se compararán cada uno de sus resultados.</p>
<div id="agrupar-por-condiciones" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Agrupar por condiciones<a href="index-evaluation.html#agrupar-por-condiciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para facilitar su acceso, los resultados se agruparán en función de las condiciones que se han medido (alta sensibilidad o especificidad) y su finalidad (diagnóstico o pronóstico).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="index-evaluation.html#cb80-1" tabindex="-1"></a>indexes_sn_diagnostic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb80-2"><a href="index-evaluation.html#cb80-2" tabindex="-1"></a>    <span class="at">identifier =</span> <span class="fu">names</span>(auc_diagnostic),</span>
<span id="cb80-3"><a href="index-evaluation.html#cb80-3" tabindex="-1"></a>    <span class="at">auc =</span> auc_diagnostic,</span>
<span id="cb80-4"><a href="index-evaluation.html#cb80-4" tabindex="-1"></a>    <span class="at">pauc =</span> pauc_sn_diagnostic,</span>
<span id="cb80-5"><a href="index-evaluation.html#cb80-5" tabindex="-1"></a>    <span class="at">npauc =</span> npauc_sn_diagnostic,</span>
<span id="cb80-6"><a href="index-evaluation.html#cb80-6" tabindex="-1"></a>    <span class="at">fpauc =</span> fpauc_sn_diagnostic</span>
<span id="cb80-7"><a href="index-evaluation.html#cb80-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="index-evaluation.html#cb81-1" tabindex="-1"></a>indexes_sn_prognostic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb81-2"><a href="index-evaluation.html#cb81-2" tabindex="-1"></a>    <span class="at">identifier =</span> <span class="fu">names</span>(auc_prognostic),</span>
<span id="cb81-3"><a href="index-evaluation.html#cb81-3" tabindex="-1"></a>    <span class="at">auc =</span> auc_prognostic,</span>
<span id="cb81-4"><a href="index-evaluation.html#cb81-4" tabindex="-1"></a>    <span class="at">pauc =</span> pauc_sn_prognostic,</span>
<span id="cb81-5"><a href="index-evaluation.html#cb81-5" tabindex="-1"></a>    <span class="at">npauc =</span> npauc_sn_prognostic,</span>
<span id="cb81-6"><a href="index-evaluation.html#cb81-6" tabindex="-1"></a>    <span class="at">fpauc =</span> fpauc_sn_prognostic</span>
<span id="cb81-7"><a href="index-evaluation.html#cb81-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="index-evaluation.html#cb82-1" tabindex="-1"></a>indexes_sp_diagnostic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb82-2"><a href="index-evaluation.html#cb82-2" tabindex="-1"></a>    <span class="at">identifier =</span> <span class="fu">names</span>(auc_diagnostic),</span>
<span id="cb82-3"><a href="index-evaluation.html#cb82-3" tabindex="-1"></a>    <span class="at">auc =</span> auc_diagnostic,</span>
<span id="cb82-4"><a href="index-evaluation.html#cb82-4" tabindex="-1"></a>    <span class="at">pauc =</span> pauc_sp_diagnostic,</span>
<span id="cb82-5"><a href="index-evaluation.html#cb82-5" tabindex="-1"></a>    <span class="at">spauc =</span> spauc_sp_diagnostic,</span>
<span id="cb82-6"><a href="index-evaluation.html#cb82-6" tabindex="-1"></a>    <span class="at">tpauc =</span> tpauc_sp_diagnostic</span>
<span id="cb82-7"><a href="index-evaluation.html#cb82-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="index-evaluation.html#cb83-1" tabindex="-1"></a>indexes_sp_prognostic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb83-2"><a href="index-evaluation.html#cb83-2" tabindex="-1"></a>    <span class="at">identifier =</span> <span class="fu">names</span>(auc_prognostic),</span>
<span id="cb83-3"><a href="index-evaluation.html#cb83-3" tabindex="-1"></a>    <span class="at">auc =</span> auc_prognostic,</span>
<span id="cb83-4"><a href="index-evaluation.html#cb83-4" tabindex="-1"></a>    <span class="at">pauc =</span> pauc_sp_prognostic,</span>
<span id="cb83-5"><a href="index-evaluation.html#cb83-5" tabindex="-1"></a>    <span class="at">spauc =</span> spauc_sp_prognostic,</span>
<span id="cb83-6"><a href="index-evaluation.html#cb83-6" tabindex="-1"></a>    <span class="at">tpauc =</span> tpauc_sp_prognostic</span>
<span id="cb83-7"><a href="index-evaluation.html#cb83-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="marcadores-para-diagnóstico" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Marcadores para diagnóstico<a href="index-evaluation.html#marcadores-para-diagnóstico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="métricas-generales" class="section level4 hasAnchor" number="5.4.2.1">
<h4><span class="header-section-number">5.4.2.1</span> Métricas generales<a href="index-evaluation.html#métricas-generales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Antes de analizar en detalle los distintos índices, es conveniente describir algunas métricas generales. Para ello es posible utilizar la función <code>ROCnGO::summarize_dataset</code>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="index-evaluation.html#cb84-1" tabindex="-1"></a>metrics_diagnostic_tpr <span class="ot">&lt;-</span> <span class="fu">summarize_dataset</span>(</span>
<span id="cb84-2"><a href="index-evaluation.html#cb84-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb84-3"><a href="index-evaluation.html#cb84-3" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="cn">NULL</span>,</span>
<span id="cb84-4"><a href="index-evaluation.html#cb84-4" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb84-5"><a href="index-evaluation.html#cb84-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb84-6"><a href="index-evaluation.html#cb84-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb84-7"><a href="index-evaluation.html#cb84-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="index-evaluation.html#cb85-1" tabindex="-1"></a>metrics_diagnostic_fpr <span class="ot">&lt;-</span> <span class="fu">summarize_dataset</span>(</span>
<span id="cb85-2"><a href="index-evaluation.html#cb85-2" tabindex="-1"></a>    diagnostic_dataset,</span>
<span id="cb85-3"><a href="index-evaluation.html#cb85-3" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="cn">NULL</span>,</span>
<span id="cb85-4"><a href="index-evaluation.html#cb85-4" tabindex="-1"></a>    <span class="at">response =</span> roc_data<span class="sc">$</span>disease,</span>
<span id="cb85-5"><a href="index-evaluation.html#cb85-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb85-6"><a href="index-evaluation.html#cb85-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb85-7"><a href="index-evaluation.html#cb85-7" tabindex="-1"></a>)</span></code></pre></div>
<p>El conjunto de datos utilizado para diagnóstico contiene la expresión de 2651 genes provenientes de 554 muestras extraídas de pacientes con cáncer de próstata, de las cuales, 52 se corresponden con tejido sano y 502 con tejido canceroso. Los genes de estudio se corresponden con los expresados diferencialmente en experimentos de scRNA-seq.</p>
<p>De los 2651 genes seleccionados, 1722 (64.93%) presentan un <span class="math inline">\(AUC \ge 0.5\)</span>. En regiones de alta sensibilidad (<span class="math inline">\(TPR \ge 0.9\)</span>), de este número 184 presentan curvas <span class="math inline">\(ROC\)</span> cóncavas (10.68% y 6.94% del total), 148 presentan algún tipo de gancho sin atravesar la línea del azar (8.59% y 5.58% del total) y 1390 atraviesan en algún punto dicha línea (80.72% y 52.43% del total).</p>
<p>Para regiones de alta especificidad (<span class="math inline">\(FPR \le 0.1\)</span>), de los predictores con un <span class="math inline">\(AUC \ge 0.5\)</span>, 405 presentan curvas cóncavas (23.51%, un 15.28% del total), 1032 curvas parcialmente adecuadas (59.93%, un 38.92% del total) y 285 contienen algún punto bajo la línea de azar (16.55%, un 10.75% del total).</p>
</div>
<div id="índices-de-sensbilidad-npauc-y-fpauc" class="section level4 hasAnchor" number="5.4.2.2">
<h4><span class="header-section-number">5.4.2.2</span> Índices de sensbilidad: <span class="math inline">\(NpAUC\)</span> y <span class="math inline">\(FpAUC\)</span><a href="index-evaluation.html#índices-de-sensbilidad-npauc-y-fpauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Tras describir algunas métricas generales de los índices, se explorarán algunas medidas de tendencia central para realizar análisis más detallados. Con estas medidas será posible comprobar, entre otras cosas, el rango de valores que toman los índices.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="index-evaluation.html#cb86-1" tabindex="-1"></a><span class="fu">summary</span>(indexes_sn_diagnostic)</span></code></pre></div>
<pre><code>##   identifier             auc               pauc              npauc        
##  Length:2651        Min.   :0.07099   Min.   :0.000000   Min.   :0.00000  
##  Class :character   1st Qu.:0.44546   1st Qu.:0.003134   1st Qu.:0.03134  
##  Mode  :character   Median :0.56491   Median :0.009447   Median :0.09447  
##                     Mean   :0.55931   Mean   :0.010910   Mean   :0.10910  
##                     3rd Qu.:0.68095   3rd Qu.:0.016338   3rd Qu.:0.16338  
##                     Max.   :0.94369   Max.   :0.060244   Max.   :0.60244  
##                                                                           
##      fpauc       
##  Min.   :0.5000  
##  1st Qu.:0.6952  
##  Median :0.7659  
##  Mean   :0.7517  
##  3rd Qu.:0.8164  
##  Max.   :0.9957  
##  NA&#39;s   :145</code></pre>
<p>Como puede observarse, el <span class="math inline">\(pAUC\)</span> toma valores inferiores a <span class="math inline">\(0.5\)</span>, el <span class="math inline">\(NpAUC\)</span> toma valores tanto valores inferiores como superiores a dicho valor y finalmente el <span class="math inline">\(FpAUC\)</span> solo presenta valores superiores. A simple vista, se puede observar como el <span class="math inline">\(pAUC\)</span> se convierte en un métrica de difícil interpretación, al contrario que el <span class="math inline">\(NpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> que tienen límites definidos. Por otra parte, aunque tanto el <span class="math inline">\(NpAUC\)</span> como el <span class="math inline">\(FpAUC\)</span> están comprendidos por debajo de <span class="math inline">\(1\)</span> por su límite superior, no presentan el mismo límite inferior (secciones <a href="index-evaluation.html#npauc">5.3.3.1</a> y <a href="index-evaluation.html#fpauc">5.3.3.2</a>).</p>
<p>Para ilustrar esta situación se utilizará el gen <code>ENSG00000169347</code>, el clasificador de mayor <span class="math inline">\(FpAUC\)</span> en la región de interés. Sus métricas pueden ser rápidamente visualizadas utilizando la función <code>ROCnGO::summarize_predictor</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="index-evaluation.html#cb88-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(roc_data, ENSG00000169347, disease, <span class="st">&quot;tpr&quot;</span>, <span class="fl">0.9</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4502184
</td>
<td style="text-align:right;">
0.0134041
</td>
<td style="text-align:right;">
0.1340408
</td>
<td style="text-align:right;">
0.9957314
</td>
<td style="text-align:left;">
Concave
</td>
</tr>
</tbody>
</table>
<p>El clasificador toma aproximadamente el valor máximo para el <span class="math inline">\(FpAUC\)</span>, sin embargo, presenta valores reducidos de <span class="math inline">\(AUC\)</span>, <span class="math inline">\(pAUC\)</span> e incluso <span class="math inline">\(NpAUC\)</span>. Para explicar estos resultados, la curva <span class="math inline">\(ROC\)</span> del clasificador será representada con la función <code>ROCnGO::plot_roc_curve</code>. Además, para facilitar la explicación, también se representará el límite inferior del <span class="math inline">\(NpAUC\)</span>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="index-evaluation.html#cb89-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(roc_data, <span class="at">response =</span> disease, <span class="at">predictor =</span> ENSG00000169347) <span class="sc">+</span></span>
<span id="cb89-2"><a href="index-evaluation.html#cb89-2" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb89-3"><a href="index-evaluation.html#cb89-3" tabindex="-1"></a>    <span class="fu">add_tpr_threshold_line</span>(<span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="index-evaluation.html#cb89-4" tabindex="-1"></a>    <span class="fu">add_npauc_normalized_lower_bound</span>(</span>
<span id="cb89-5"><a href="index-evaluation.html#cb89-5" tabindex="-1"></a>        roc_data,</span>
<span id="cb89-6"><a href="index-evaluation.html#cb89-6" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb89-7"><a href="index-evaluation.html#cb89-7" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000169347,</span>
<span id="cb89-8"><a href="index-evaluation.html#cb89-8" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb89-9"><a href="index-evaluation.html#cb89-9" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Predictor%20ENSG00000169347%20con%20l%C3%ADmite%20inferior%20de%20NpAUC-1.png" width="672" /></p>
<p>Como se puede observar, el límite inferior del <span class="math inline">\(NpAUC\)</span> se corresponde con la mitad del área de la banda <span class="math inline">\((TPR_0, 1)\)</span>. Dado que la curva <span class="math inline">\(ROC\)</span> queda descrita por debajo de esta área, el <span class="math inline">\(NpAUC\)</span> toma valores inferiores a <span class="math inline">\(0.5\)</span> y en consecuencia dificultando su interpretación.</p>
<p>Este no es el caso del límite inferior definido por el <span class="math inline">\(FpAUC\)</span>, el cual se ajusta a la forma de la curva. Para visualizarlo de forma detalla, se graficará la curva <span class="math inline">\(ROC\)</span> en la región de alta sensibilidad utilizando la función <code>ROCnGO::plot_partial_roc_curve</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="index-evaluation.html#cb90-1" tabindex="-1"></a><span class="fu">plot_partial_roc_curve</span>(</span>
<span id="cb90-2"><a href="index-evaluation.html#cb90-2" tabindex="-1"></a>    roc_data, </span>
<span id="cb90-3"><a href="index-evaluation.html#cb90-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb90-4"><a href="index-evaluation.html#cb90-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000169347,</span>
<span id="cb90-5"><a href="index-evaluation.html#cb90-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb90-6"><a href="index-evaluation.html#cb90-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb90-7"><a href="index-evaluation.html#cb90-7" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-8"><a href="index-evaluation.html#cb90-8" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb90-9"><a href="index-evaluation.html#cb90-9" tabindex="-1"></a>    <span class="fu">add_tpr_threshold_line</span>(<span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb90-10"><a href="index-evaluation.html#cb90-10" tabindex="-1"></a>    <span class="fu">add_fpauc_concave_lower_bound</span>(</span>
<span id="cb90-11"><a href="index-evaluation.html#cb90-11" tabindex="-1"></a>        roc_data,</span>
<span id="cb90-12"><a href="index-evaluation.html#cb90-12" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb90-13"><a href="index-evaluation.html#cb90-13" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000169347,</span>
<span id="cb90-14"><a href="index-evaluation.html#cb90-14" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb90-15"><a href="index-evaluation.html#cb90-15" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Predictor%20con%20l%C3%ADmite%20inferior%20de%20FpAUC-1.png" width="672" /></p>
<p>Ampliando la figura en la región de interés, se observa como el límite inferior del <span class="math inline">\(FpAUC\)</span> se ajusta a la región definida por la curva <span class="math inline">\(ROC\)</span>, en lugar de a toda la banda <span class="math inline">\((TPR_0, 1)\)</span>. Así, el <span class="math inline">\(FpAUC\)</span> toma valores mayores a <span class="math inline">\(0.5\)</span>, siendo una métrica más interpretable. Este punto puede contrastarse con <code>ENSG00000105707</code>, el predictor de mayor valor para <span class="math inline">\(NpAUC\)</span>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="index-evaluation.html#cb91-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(roc_data, ENSG00000105707, disease, <span class="st">&quot;tpr&quot;</span>, <span class="fl">0.9</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.9436868
</td>
<td style="text-align:right;">
0.0602436
</td>
<td style="text-align:right;">
0.6024364
</td>
<td style="text-align:right;">
0.8642639
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="index-evaluation.html#cb92-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(roc_data, <span class="at">response =</span> disease, <span class="at">predictor =</span> ENSG00000105707) <span class="sc">+</span></span>
<span id="cb92-2"><a href="index-evaluation.html#cb92-2" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="index-evaluation.html#cb92-3" tabindex="-1"></a>    <span class="fu">add_tpr_threshold_line</span>(<span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="index-evaluation.html#cb92-4" tabindex="-1"></a>    <span class="fu">add_npauc_normalized_lower_bound</span>(</span>
<span id="cb92-5"><a href="index-evaluation.html#cb92-5" tabindex="-1"></a>        roc_data,</span>
<span id="cb92-6"><a href="index-evaluation.html#cb92-6" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb92-7"><a href="index-evaluation.html#cb92-7" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000105707,</span>
<span id="cb92-8"><a href="index-evaluation.html#cb92-8" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb92-9"><a href="index-evaluation.html#cb92-9" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Predictor%20ENSG00000105707%20con%20l%C3%ADmite%20inferior%20de%20NpAUC-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="index-evaluation.html#cb93-1" tabindex="-1"></a><span class="fu">plot_partial_roc_curve</span>(</span>
<span id="cb93-2"><a href="index-evaluation.html#cb93-2" tabindex="-1"></a>        roc_data,</span>
<span id="cb93-3"><a href="index-evaluation.html#cb93-3" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb93-4"><a href="index-evaluation.html#cb93-4" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000105707,</span>
<span id="cb93-5"><a href="index-evaluation.html#cb93-5" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb93-6"><a href="index-evaluation.html#cb93-6" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb93-7"><a href="index-evaluation.html#cb93-7" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb93-8"><a href="index-evaluation.html#cb93-8" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb93-9"><a href="index-evaluation.html#cb93-9" tabindex="-1"></a>    <span class="fu">add_tpr_threshold_line</span>(<span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Predictor%20ENSG00000105707%20con%20l%C3%ADmite%20inferior%20de%20FpAUC-1.png" width="672" /></p>
<p>En este caso, la mayor parte de la curva <span class="math inline">\(ROC\)</span> está contenida por encima del límite definido por <span class="math inline">\(NpAUC\)</span>. Esto confirma el razonamiento anterior, ya que se obtienen valores superiores a <span class="math inline">\(0.5\)</span>. Por otra parte, el <span class="math inline">\(FpAUC\)</span> no puede definir ningún límite inferior puesto que la curva presenta un gancho bajo la línea de azar en el extremo superior. A pesar de ello, el <span class="math inline">\(FpAUC\)</span> considera esta posibilidad por lo que sigue devolviendo valores interpretables.</p>
<p>Otra característica de interés de los índices es su capacidad para distinguir predictores con el mismo <span class="math inline">\(pAUC\)</span> y curvas <span class="math inline">\(ROC\)</span> que se cruzan. De todo el conjunto de datos, 633 predictores presentan un <span class="math inline">\(pAUC\)</span> idéntico a otro, formando 246 grupos de <span class="math inline">\(pAUC\)</span> iguales. Para evaluar el rendimiento de los índices en este contexto se utilizarán los genes <code>ENSG00000065361</code>y <code>ENSG00000130653</code>, aquellos con el mayor valor de <span class="math inline">\(pAUC\)</span> entre los grupos formados.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="index-evaluation.html#cb94-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb94-2"><a href="index-evaluation.html#cb94-2" tabindex="-1"></a>    <span class="st">&quot;ENSG00000065361&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb94-3"><a href="index-evaluation.html#cb94-3" tabindex="-1"></a>        roc_data, ENSG00000065361, disease, <span class="st">&quot;tpr&quot;</span>, <span class="fl">0.9</span></span>
<span id="cb94-4"><a href="index-evaluation.html#cb94-4" tabindex="-1"></a>    ),</span>
<span id="cb94-5"><a href="index-evaluation.html#cb94-5" tabindex="-1"></a>    <span class="st">&quot;ENSG00000130653&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb94-6"><a href="index-evaluation.html#cb94-6" tabindex="-1"></a>        roc_data, ENSG00000130653, disease, <span class="st">&quot;tpr&quot;</span>, <span class="fl">0.9</span></span>
<span id="cb94-7"><a href="index-evaluation.html#cb94-7" tabindex="-1"></a>    ),</span>
<span id="cb94-8"><a href="index-evaluation.html#cb94-8" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;Identifier&quot;</span></span>
<span id="cb94-9"><a href="index-evaluation.html#cb94-9" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000065361
</td>
<td style="text-align:right;">
0.7715676
</td>
<td style="text-align:right;">
0.0274287
</td>
<td style="text-align:right;">
0.2742875
</td>
<td style="text-align:right;">
0.8565737
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000130653
</td>
<td style="text-align:right;">
0.7384692
</td>
<td style="text-align:right;">
0.0274287
</td>
<td style="text-align:right;">
0.2742875
</td>
<td style="text-align:right;">
0.8351422
</td>
<td style="text-align:left;">
Partially proper
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="index-evaluation.html#cb95-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb95-2"><a href="index-evaluation.html#cb95-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb95-3"><a href="index-evaluation.html#cb95-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb95-4"><a href="index-evaluation.html#cb95-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000065361</span>
<span id="cb95-5"><a href="index-evaluation.html#cb95-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="index-evaluation.html#cb95-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(</span>
<span id="cb95-7"><a href="index-evaluation.html#cb95-7" tabindex="-1"></a>        roc_data,</span>
<span id="cb95-8"><a href="index-evaluation.html#cb95-8" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb95-9"><a href="index-evaluation.html#cb95-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000130653</span>
<span id="cb95-10"><a href="index-evaluation.html#cb95-10" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-11"><a href="index-evaluation.html#cb95-11" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb95-12"><a href="index-evaluation.html#cb95-12" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.9</span>, <span class="st">&quot;tpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Comparaci%C3%B3n%20de%20marcadores%20ENSG00000065361%20y%20ENSG00000130653-1.png" width="672" /></p>
<p>Ambos predictores presentan <span class="math inline">\(AUC\)</span> relativamente altos y sus curvas se cruzan en diversos puntos dentro de la región de alta sensibilidad. Dado que el <span class="math inline">\(NpAUC\)</span> simplemente realiza una normalización utilizando la banda de alta sensibilidad <a href="index-evaluation.html#eq:npauc-normalized-bounds">(5.7)</a>, la métrica no es capaz de seleccionar un predictor mejor, dando el mismo valor para ambas (<span class="math inline">\(NpAUC = 0.2742875\)</span>). Por otra parte, el <span class="math inline">\(FpAUC\)</span> adapta sus límites a la forma de la curva <span class="math inline">\(ROC\)</span> por ello es capaz de seleccionar al de mejor rendimiento, <code>ENSG00000065361</code>. Siguiendo este ejemplo, se deduce que el <span class="math inline">\(FpAUC\)</span> presenta una mayor capacidad de discriminación entre predictores con igual <span class="math inline">\(pAUC\)</span>, lo cual puede contrastarse con todo el conjunto de datos.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="index-evaluation.html#cb96-1" tabindex="-1"></a>metrics_diagnostic_tpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="index-evaluation.html#cb96-2" tabindex="-1"></a>    <span class="fu">filter</span>(pauc <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="index-evaluation.html#cb96-3" tabindex="-1"></a>    <span class="fu">group_by</span>(pauc) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="index-evaluation.html#cb96-4" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="index-evaluation.html#cb96-5" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb96-6"><a href="index-evaluation.html#cb96-6" tabindex="-1"></a>        <span class="at">npauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb96-7"><a href="index-evaluation.html#cb96-7" tabindex="-1"></a>            <span class="fu">map_lgl</span>(np_auc, \(x) <span class="fu">near</span>(x, np_auc[[<span class="dv">1</span>]]))</span>
<span id="cb96-8"><a href="index-evaluation.html#cb96-8" tabindex="-1"></a>        ),</span>
<span id="cb96-9"><a href="index-evaluation.html#cb96-9" tabindex="-1"></a>        <span class="at">fpauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb96-10"><a href="index-evaluation.html#cb96-10" tabindex="-1"></a>            <span class="fu">map_lgl</span>(fp_auc, \(x) <span class="fu">near</span>(x, fp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb96-11"><a href="index-evaluation.html#cb96-11" tabindex="-1"></a>        )</span>
<span id="cb96-12"><a href="index-evaluation.html#cb96-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb96-13"><a href="index-evaluation.html#cb96-13" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb96-14"><a href="index-evaluation.html#cb96-14" tabindex="-1"></a>        <span class="at">npauc_equal =</span> <span class="fu">all</span>(npauc_equal),</span>
<span id="cb96-15"><a href="index-evaluation.html#cb96-15" tabindex="-1"></a>        <span class="at">fpauc_equal =</span> <span class="fu">all</span>(fpauc_equal)</span>
<span id="cb96-16"><a href="index-evaluation.html#cb96-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb96-17"><a href="index-evaluation.html#cb96-17" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb96-18"><a href="index-evaluation.html#cb96-18" tabindex="-1"></a>        <span class="at">npauc_equal =</span> <span class="fu">sum</span>(npauc_equal),</span>
<span id="cb96-19"><a href="index-evaluation.html#cb96-19" tabindex="-1"></a>        <span class="at">fpauc_equal =</span> <span class="fu">sum</span>(fpauc_equal)</span>
<span id="cb96-20"><a href="index-evaluation.html#cb96-20" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb96-21"><a href="index-evaluation.html#cb96-21" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb96-22"><a href="index-evaluation.html#cb96-22" tabindex="-1"></a>        <span class="at">npauc_distintct =</span> <span class="dv">246</span> <span class="sc">-</span> npauc_equal,</span>
<span id="cb96-23"><a href="index-evaluation.html#cb96-23" tabindex="-1"></a>        <span class="at">fpauc_distintct =</span> <span class="dv">246</span> <span class="sc">-</span> fpauc_equal,</span>
<span id="cb96-24"><a href="index-evaluation.html#cb96-24" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb96-25"><a href="index-evaluation.html#cb96-25" tabindex="-1"></a>    <span class="fu">relocate</span>(</span>
<span id="cb96-26"><a href="index-evaluation.html#cb96-26" tabindex="-1"></a>        <span class="fu">sort</span>(<span class="fu">names</span>(.))</span>
<span id="cb96-27"><a href="index-evaluation.html#cb96-27" tabindex="-1"></a>    )</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
fpauc_distintct
</th>
<th style="text-align:right;">
fpauc_equal
</th>
<th style="text-align:right;">
npauc_distintct
</th>
<th style="text-align:right;">
npauc_equal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
199
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
246
</td>
</tr>
</tbody>
</table>
<p>De los 246 grupos formados, el <span class="math inline">\(NpAUC\)</span> no es capaz de desempatar en ningún grupo, mientras que el <span class="math inline">\(FpAUC\)</span> es capaz de seleccionar un mejor clasificador en 47 de ellos. Estos cálculos sobre todo el conjunto de datos refuerzan la afirmación de que el <span class="math inline">\(FpAUC\)</span> tiene una mejor capacidad de discriminación que el <span class="math inline">\(NpAUC\)</span>.</p>
</div>
<div id="índices-de-especificidad-spauc-y-tpauc" class="section level4 hasAnchor" number="5.4.2.3">
<h4><span class="header-section-number">5.4.2.3</span> Índices de especificidad: <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span><a href="index-evaluation.html#índices-de-especificidad-spauc-y-tpauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Al igual que con los índices de sensibilidad, en primer lugar, se explorarán algunas métricas de tendencia central.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="index-evaluation.html#cb97-1" tabindex="-1"></a><span class="fu">summary</span>(indexes_sp_diagnostic)</span></code></pre></div>
<pre><code>##   identifier             auc               pauc              spauc       
##  Length:2651        Min.   :0.07099   Min.   :0.000000   Min.   :0.5000  
##  Class :character   1st Qu.:0.44546   1st Qu.:0.004635   1st Qu.:0.5278  
##  Mode  :character   Median :0.56491   Median :0.011952   Median :0.5645  
##                     Mean   :0.55931   Mean   :0.015553   Mean   :0.5813  
##                     3rd Qu.:0.68095   3rd Qu.:0.023314   3rd Qu.:0.6213  
##                     Max.   :0.94369   Max.   :0.074939   Max.   :0.8681  
##                                                          NA&#39;s   :711     
##      tpauc       
##  Min.   :0.0000  
##  1st Qu.:0.7347  
##  Median :0.7841  
##  Mean   :0.7763  
##  3rd Qu.:0.8312  
##  Max.   :1.0000  
## </code></pre>
<p>Observando las métricas el <span class="math inline">\(pAUC\)</span> solo toma valores inferiores a <span class="math inline">\(0.5\)</span> lo cual dificulta su interpretabilidad, a diferencia del <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span> que pueden tomar valores superiores. Cabe destacar que el <span class="math inline">\(TpAUC\)</span> toma valores iguales a 0 cuando teóricamente debería estar comprendido en <span class="math inline">\((0.5, 1)\)</span>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="index-evaluation.html#cb99-1" tabindex="-1"></a>indexes_sp_diagnostic <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="index-evaluation.html#cb99-2" tabindex="-1"></a>    <span class="fu">filter</span>(tpauc <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
spauc
</th>
<th style="text-align:right;">
tpauc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000169116
</td>
<td style="text-align:right;">
0.1625038
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000135378
</td>
<td style="text-align:right;">
0.1314358
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000148985
</td>
<td style="text-align:right;">
0.5433650
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000171867
</td>
<td style="text-align:right;">
0.1755287
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000085662
</td>
<td style="text-align:right;">
0.1333895
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000167711
</td>
<td style="text-align:right;">
0.2537542
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000101856
</td>
<td style="text-align:right;">
0.0867300
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000185432
</td>
<td style="text-align:right;">
0.1069951
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000121691
</td>
<td style="text-align:right;">
0.2978854
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000148344
</td>
<td style="text-align:right;">
0.3502145
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000091138
</td>
<td style="text-align:right;">
0.2779651
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000186526
</td>
<td style="text-align:right;">
0.4682616
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000156642
</td>
<td style="text-align:right;">
0.1963684
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000170954
</td>
<td style="text-align:right;">
0.2587726
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Una exploración de los datos muestra como estos valores del <span class="math inline">\(TpAUC\)</span> se corresponden con valores de <span class="math inline">\(pAUC\)</span> iguales a <span class="math inline">\(0\)</span>, lo cual se puede comprobar de forma gráfica representando algunos de ellos.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="index-evaluation.html#cb100-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb100-2"><a href="index-evaluation.html#cb100-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb100-3"><a href="index-evaluation.html#cb100-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb100-4"><a href="index-evaluation.html#cb100-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000169116</span>
<span id="cb100-5"><a href="index-evaluation.html#cb100-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb100-6"><a href="index-evaluation.html#cb100-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(</span>
<span id="cb100-7"><a href="index-evaluation.html#cb100-7" tabindex="-1"></a>        roc_data,</span>
<span id="cb100-8"><a href="index-evaluation.html#cb100-8" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb100-9"><a href="index-evaluation.html#cb100-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000135378</span>
<span id="cb100-10"><a href="index-evaluation.html#cb100-10" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb100-11"><a href="index-evaluation.html#cb100-11" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb100-12"><a href="index-evaluation.html#cb100-12" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Representaci%C3%B3n%20de%20predictores%20con%20pAUC%20igual%20a%200-1.png" width="672" /></p>
<p>Dado que las curvas de ambos predictores toman valores de <span class="math inline">\(TPR = 0\)</span>, no hay un area definida debajo de la curva. Ampliando la imagen esto puede observarse con mayor claridad.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="index-evaluation.html#cb101-1" tabindex="-1"></a><span class="fu">plot_partial_roc_curve</span>(</span>
<span id="cb101-2"><a href="index-evaluation.html#cb101-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb101-3"><a href="index-evaluation.html#cb101-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb101-4"><a href="index-evaluation.html#cb101-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000169116,</span>
<span id="cb101-5"><a href="index-evaluation.html#cb101-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb101-6"><a href="index-evaluation.html#cb101-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb101-7"><a href="index-evaluation.html#cb101-7" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">add_partial_roc_curve</span>(</span>
<span id="cb101-8"><a href="index-evaluation.html#cb101-8" tabindex="-1"></a>        roc_data,</span>
<span id="cb101-9"><a href="index-evaluation.html#cb101-9" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb101-10"><a href="index-evaluation.html#cb101-10" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000135378,</span>
<span id="cb101-11"><a href="index-evaluation.html#cb101-11" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb101-12"><a href="index-evaluation.html#cb101-12" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb101-13"><a href="index-evaluation.html#cb101-13" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb101-14"><a href="index-evaluation.html#cb101-14" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb101-15"><a href="index-evaluation.html#cb101-15" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Ampliaci%C3%B3n%20de%20predictores%20con%20pAUC%20igual%20a%200-1.png" width="672" /></p>
<p>Tras comprobar el origen de los valores atípicos, es posible recalcular las métricas filtrando los valores de <span class="math inline">\(pAUC = 0\)</span>. De esta forma, <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(SpAUC\)</span> se encuentran limitados por encima de <span class="math inline">\(0.5\)</span> convirtiéndose en métricas fácilmente interpretables.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="index-evaluation.html#cb102-1" tabindex="-1"></a><span class="fu">summary</span>(indexes_sp_diagnostic <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pauc <span class="sc">!=</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>##   identifier             auc               pauc               spauc       
##  Length:2637        Min.   :0.07099   Min.   :7.660e-06   Min.   :0.5000  
##  Class :character   1st Qu.:0.44622   1st Qu.:4.766e-03   1st Qu.:0.5278  
##  Mode  :character   Median :0.56624   Median :1.198e-02   Median :0.5645  
##                     Mean   :0.56098   Mean   :1.564e-02   Mean   :0.5813  
##                     3rd Qu.:0.68162   3rd Qu.:2.337e-02   3rd Qu.:0.6213  
##                     Max.   :0.94369   Max.   :7.494e-02   Max.   :0.8681  
##                                                           NA&#39;s   :697     
##      tpauc       
##  Min.   :0.5000  
##  1st Qu.:0.7354  
##  Median :0.7846  
##  Mean   :0.7804  
##  3rd Qu.:0.8314  
##  Max.   :1.0000  
## </code></pre>
<p>A pesar de tener buena interpretabilidad, el <span class="math inline">\(SpAUC\)</span> presenta valores de <code>NA</code>. Como se ha explicado anteriormente, el <span class="math inline">\(SpAUC\)</span> tiene su límite definido con el trapecio de puntos <span class="math inline">\((FPR_1, 0), (FPR_2, 0), (FPR_1, FPR_1)\)</span> y <span class="math inline">\((FPR_2, FPR_2)\)</span>, o en otras palabras, el que coincide con la línea del azar. Este límite no se ajusta a curvas definidas por debajo de la línea (sección <a href="index-evaluation.html#spauc">5.3.2.1</a>), por esta razón la función devuelve estos valores. Esto es posible comprobarlo gráficamente con el predictor <code>ENSG00000181754</code>, un predictor que aun presentan una forma cóncava en la región de interés pasa por debajo de la línea del azar.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="index-evaluation.html#cb104-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(</span>
<span id="cb104-2"><a href="index-evaluation.html#cb104-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb104-3"><a href="index-evaluation.html#cb104-3" tabindex="-1"></a>    ENSG00000181754,</span>
<span id="cb104-4"><a href="index-evaluation.html#cb104-4" tabindex="-1"></a>    disease,</span>
<span id="cb104-5"><a href="index-evaluation.html#cb104-5" tabindex="-1"></a>    <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb104-6"><a href="index-evaluation.html#cb104-6" tabindex="-1"></a>    <span class="fl">0.1</span></span>
<span id="cb104-7"><a href="index-evaluation.html#cb104-7" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4311408
</td>
<td style="text-align:right;">
0.0049425
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.8215741
</td>
<td style="text-align:left;">
Concave
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="index-evaluation.html#cb105-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb105-2"><a href="index-evaluation.html#cb105-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb105-3"><a href="index-evaluation.html#cb105-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb105-4"><a href="index-evaluation.html#cb105-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000181754</span>
<span id="cb105-5"><a href="index-evaluation.html#cb105-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="index-evaluation.html#cb105-6" tabindex="-1"></a>    <span class="fu">add_spauc_lower_bound</span>(</span>
<span id="cb105-7"><a href="index-evaluation.html#cb105-7" tabindex="-1"></a>        roc_data,</span>
<span id="cb105-8"><a href="index-evaluation.html#cb105-8" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb105-9"><a href="index-evaluation.html#cb105-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000181754,</span>
<span id="cb105-10"><a href="index-evaluation.html#cb105-10" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb105-11"><a href="index-evaluation.html#cb105-11" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb105-12"><a href="index-evaluation.html#cb105-12" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb105-13"><a href="index-evaluation.html#cb105-13" tabindex="-1"></a>    <span class="fu">add_tpauc_concave_lower_bound</span>(</span>
<span id="cb105-14"><a href="index-evaluation.html#cb105-14" tabindex="-1"></a>        roc_data,</span>
<span id="cb105-15"><a href="index-evaluation.html#cb105-15" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb105-16"><a href="index-evaluation.html#cb105-16" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000181754,</span>
<span id="cb105-17"><a href="index-evaluation.html#cb105-17" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb105-18"><a href="index-evaluation.html#cb105-18" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb105-19"><a href="index-evaluation.html#cb105-19" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb105-20"><a href="index-evaluation.html#cb105-20" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb105-21"><a href="index-evaluation.html#cb105-21" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Plot%20predictor%20ENSG00000181754-1.png" width="672" /></p>
<p>Como se observa en la figura, el límite inferior del <span class="math inline">\(SpAUC\)</span> se encuentra definido por encima de la curva <span class="math inline">\(ROC\)</span>, por otra parte el límite del <span class="math inline">\(TpAUC\)</span> se adecua a la región y forma de la curva. Para contrastar este ajuste es posible seleccionar otro predictor con una forma de curva distinta, por ejemplo, <code>ENSG00000111667</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="index-evaluation.html#cb106-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(</span>
<span id="cb106-2"><a href="index-evaluation.html#cb106-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb106-3"><a href="index-evaluation.html#cb106-3" tabindex="-1"></a>    ENSG00000111667,</span>
<span id="cb106-4"><a href="index-evaluation.html#cb106-4" tabindex="-1"></a>    disease,</span>
<span id="cb106-5"><a href="index-evaluation.html#cb106-5" tabindex="-1"></a>    <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb106-6"><a href="index-evaluation.html#cb106-6" tabindex="-1"></a>    <span class="fl">0.1</span></span>
<span id="cb106-7"><a href="index-evaluation.html#cb106-7" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.413768
</td>
<td style="text-align:right;">
0.0049954
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.7985348
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="index-evaluation.html#cb107-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb107-2"><a href="index-evaluation.html#cb107-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb107-3"><a href="index-evaluation.html#cb107-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb107-4"><a href="index-evaluation.html#cb107-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000111667</span>
<span id="cb107-5"><a href="index-evaluation.html#cb107-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb107-6"><a href="index-evaluation.html#cb107-6" tabindex="-1"></a>    <span class="fu">add_spauc_lower_bound</span>(</span>
<span id="cb107-7"><a href="index-evaluation.html#cb107-7" tabindex="-1"></a>        roc_data,</span>
<span id="cb107-8"><a href="index-evaluation.html#cb107-8" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb107-9"><a href="index-evaluation.html#cb107-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000111667,</span>
<span id="cb107-10"><a href="index-evaluation.html#cb107-10" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb107-11"><a href="index-evaluation.html#cb107-11" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb107-12"><a href="index-evaluation.html#cb107-12" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb107-13"><a href="index-evaluation.html#cb107-13" tabindex="-1"></a>    <span class="fu">add_tpauc_under_chance_lower_bound</span>(</span>
<span id="cb107-14"><a href="index-evaluation.html#cb107-14" tabindex="-1"></a>        roc_data,</span>
<span id="cb107-15"><a href="index-evaluation.html#cb107-15" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb107-16"><a href="index-evaluation.html#cb107-16" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000111667,</span>
<span id="cb107-17"><a href="index-evaluation.html#cb107-17" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb107-18"><a href="index-evaluation.html#cb107-18" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb107-19"><a href="index-evaluation.html#cb107-19" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb107-20"><a href="index-evaluation.html#cb107-20" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb107-21"><a href="index-evaluation.html#cb107-21" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Plot%20predictor%20ENSG00000111667-1.png" width="672" /></p>
<p>En este caso, la curva <span class="math inline">\(ROC\)</span> queda definida por debajo de la línea de azar y el <span class="math inline">\(TpAUC\)</span> no puede establecer un área mínima, por lo que establece el límite inferior a <span class="math inline">\(0\)</span>. Por otra parte, el límite inferior del <span class="math inline">\(SpAUC\)</span> no se adecua y no puede ser calculado. Con estas observaciones, se deduce que tanto el <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span> son métricas interpretables cuando se trabaja con curvas <span class="math inline">\(ROC\)</span> adecuadas al quedar comprendidas entre <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>. Sin embargo, el <span class="math inline">\(TpAUC\)</span> se convierte en una métrica más adecuada en condiciones generales, ya que sus límites se ajustan a la forma de la curva <span class="math inline">\(ROC\)</span> a diferencia del <span class="math inline">\(SpAUC\)</span>, imposibilitando su uso en curvas comprendidas debajo de la línea del azar.</p>
<p>Una vez considerada la interpretabilidad de las métricas, se puede contrastar su capacidad para distinguir entre predictores con curvas que se cruzan e igual <span class="math inline">\(pAUC\)</span>. Del conjunto de datos, 374 predictores presentan un <span class="math inline">\(pAUC\)</span> igual a otro, formando 174 grupos de <span class="math inline">\(pAUC\)</span> iguales. Para evaluar el rendimiento de los índices utilizaremos los predictores <code>ENSG00000175336</code> y <code>ENSG00000169733</code>, aquellos que presentan el mayor valor de <span class="math inline">\(pAUC\)</span> en este subgrupo de predictores.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="index-evaluation.html#cb108-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb108-2"><a href="index-evaluation.html#cb108-2" tabindex="-1"></a>    <span class="st">&quot;ENSG00000175336 &quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb108-3"><a href="index-evaluation.html#cb108-3" tabindex="-1"></a>        roc_data,</span>
<span id="cb108-4"><a href="index-evaluation.html#cb108-4" tabindex="-1"></a>        ENSG00000175336,</span>
<span id="cb108-5"><a href="index-evaluation.html#cb108-5" tabindex="-1"></a>        disease,</span>
<span id="cb108-6"><a href="index-evaluation.html#cb108-6" tabindex="-1"></a>        <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb108-7"><a href="index-evaluation.html#cb108-7" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb108-8"><a href="index-evaluation.html#cb108-8" tabindex="-1"></a>    ),</span>
<span id="cb108-9"><a href="index-evaluation.html#cb108-9" tabindex="-1"></a>    <span class="st">&quot;ENSG00000169733&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb108-10"><a href="index-evaluation.html#cb108-10" tabindex="-1"></a>        roc_data,</span>
<span id="cb108-11"><a href="index-evaluation.html#cb108-11" tabindex="-1"></a>        ENSG00000169733,</span>
<span id="cb108-12"><a href="index-evaluation.html#cb108-12" tabindex="-1"></a>        disease,</span>
<span id="cb108-13"><a href="index-evaluation.html#cb108-13" tabindex="-1"></a>        <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb108-14"><a href="index-evaluation.html#cb108-14" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb108-15"><a href="index-evaluation.html#cb108-15" tabindex="-1"></a>    ),</span>
<span id="cb108-16"><a href="index-evaluation.html#cb108-16" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;Identifier&quot;</span></span>
<span id="cb108-17"><a href="index-evaluation.html#cb108-17" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000175336
</td>
<td style="text-align:right;">
0.8286086
</td>
<td style="text-align:right;">
0.0475329
</td>
<td style="text-align:right;">
0.7238576
</td>
<td style="text-align:right;">
0.8695316
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000169733
</td>
<td style="text-align:right;">
0.8126724
</td>
<td style="text-align:right;">
0.0475329
</td>
<td style="text-align:right;">
0.7238576
</td>
<td style="text-align:right;">
0.9123511
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="index-evaluation.html#cb109-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb109-2"><a href="index-evaluation.html#cb109-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb109-3"><a href="index-evaluation.html#cb109-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb109-4"><a href="index-evaluation.html#cb109-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000175336</span>
<span id="cb109-5"><a href="index-evaluation.html#cb109-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb109-6"><a href="index-evaluation.html#cb109-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(</span>
<span id="cb109-7"><a href="index-evaluation.html#cb109-7" tabindex="-1"></a>        roc_data,</span>
<span id="cb109-8"><a href="index-evaluation.html#cb109-8" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb109-9"><a href="index-evaluation.html#cb109-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000169733</span>
<span id="cb109-10"><a href="index-evaluation.html#cb109-10" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb109-11"><a href="index-evaluation.html#cb109-11" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb109-12"><a href="index-evaluation.html#cb109-12" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Comparaci%C3%B3n%20de%20marcadores%20ENSG00000175336%20y%20ENSG00000169733-1.png" width="672" /></p>
<p>Comprobando sus <span class="math inline">\(AUC\)</span>, ambos predictores presentan un buen rendimiento global. El <span class="math inline">\(SpAUC\)</span> se mantiene igual para ambos predictores (<span class="math inline">\(SpAUC = 0.7238576\)</span>) mientras que el <span class="math inline">\(TpAUC\)</span> toma valores distintos, lo que permite identificar el predictor de mejor rendimiento. Esta diferencia puede deberse a que el <span class="math inline">\(TpAUC\)</span> adapta sus límites a los puntos de la curva (sección <a href="index-evaluation.html#tpauc">5.3.2.2</a>), a diferencia del <span class="math inline">\(SpAUC\)</span> que los mantienen iguales.</p>
<p>Esta capacidad de discriminación entre predictores se puede contrastar con el resto del conjunto de datos:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="index-evaluation.html#cb110-1" tabindex="-1"></a>metrics_diagnostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="index-evaluation.html#cb110-2" tabindex="-1"></a>    <span class="fu">filter</span>(pauc <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="index-evaluation.html#cb110-3" tabindex="-1"></a>    <span class="fu">group_by</span>(pauc) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="index-evaluation.html#cb110-4" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="index-evaluation.html#cb110-5" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb110-6"><a href="index-evaluation.html#cb110-6" tabindex="-1"></a>        <span class="at">spauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb110-7"><a href="index-evaluation.html#cb110-7" tabindex="-1"></a>            <span class="fu">map_lgl</span>(sp_auc, \(x) <span class="fu">near</span>(x, sp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb110-8"><a href="index-evaluation.html#cb110-8" tabindex="-1"></a>        ),</span>
<span id="cb110-9"><a href="index-evaluation.html#cb110-9" tabindex="-1"></a>        <span class="at">tpauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb110-10"><a href="index-evaluation.html#cb110-10" tabindex="-1"></a>            <span class="fu">map_lgl</span>(tp_auc, \(x) <span class="fu">near</span>(x, tp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb110-11"><a href="index-evaluation.html#cb110-11" tabindex="-1"></a>        )</span>
<span id="cb110-12"><a href="index-evaluation.html#cb110-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="index-evaluation.html#cb110-13" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb110-14"><a href="index-evaluation.html#cb110-14" tabindex="-1"></a>        <span class="at">spauc_equal =</span> <span class="fu">all</span>(spauc_equal),</span>
<span id="cb110-15"><a href="index-evaluation.html#cb110-15" tabindex="-1"></a>        <span class="at">tpauc_equal =</span> <span class="fu">all</span>(tpauc_equal)</span>
<span id="cb110-16"><a href="index-evaluation.html#cb110-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb110-17"><a href="index-evaluation.html#cb110-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(spauc_equal, tpauc_equal)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
spauc_equal
</th>
<th style="text-align:left;">
tpauc_equal
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
45
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
34
</td>
</tr>
</tbody>
</table>
<p>De los 374 predictores con un <span class="math inline">\(pAUC &gt; 0\)</span> y al menos igual a otro predictor (174 grupos), se observa como el <span class="math inline">\(SpAUC\)</span> no es capaz de diferenciar el predictor de mayor rendimiento en ningún caso. Además, el índice solo toma valores para 95 de los grupos, no estando definido para el resto. Por otro lado, el <span class="math inline">\(TpAUC\)</span> es capaz de distinguir un mejor predictor en 138 de los grupos, siendo incapaz de hacerlo solamente en 36 de ellos.</p>
<p>Los resultados sobre el conjunto de datos refuerzan que ambos índices son fácilmente interpretables. Sin embargo, muestran que el <span class="math inline">\(SpAUC\)</span> no es aplicable cuando la curva <span class="math inline">\(ROC\)</span> pasa por debajo de la línea del azar. Además, el <span class="math inline">\(SpAUC\)</span> no es capaz de discriminar entre ciertos predictores. Por otra parte, el <span class="math inline">\(TpAUC\)</span> resulta más útil en la práctica al poder aplicarse a cualquier tipo de curva y ser capaz de discriminar entre predictores con igual <span class="math inline">\(pAUC\)</span>.</p>
</div>
</div>
<div id="marcadores-para-pronóstico" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Marcadores para pronóstico<a href="index-evaluation.html#marcadores-para-pronóstico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="métricas-generales-1" class="section level4 hasAnchor" number="5.4.3.1">
<h4><span class="header-section-number">5.4.3.1</span> Métricas generales<a href="index-evaluation.html#métricas-generales-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En esta sección se repetirán los procedimientos realizados previamente, pero en esta ocasión serán aplicados a marcadores de pronóstico.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="index-evaluation.html#cb111-1" tabindex="-1"></a>metric_prognostic_tpr <span class="ot">&lt;-</span> <span class="fu">summarize_dataset</span>(</span>
<span id="cb111-2"><a href="index-evaluation.html#cb111-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb111-3"><a href="index-evaluation.html#cb111-3" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="cn">NULL</span>,</span>
<span id="cb111-4"><a href="index-evaluation.html#cb111-4" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb111-5"><a href="index-evaluation.html#cb111-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb111-6"><a href="index-evaluation.html#cb111-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb111-7"><a href="index-evaluation.html#cb111-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="index-evaluation.html#cb112-1" tabindex="-1"></a>metric_prognostic_fpr <span class="ot">&lt;-</span> <span class="fu">summarize_dataset</span>(</span>
<span id="cb112-2"><a href="index-evaluation.html#cb112-2" tabindex="-1"></a>    prognostic_dataset,</span>
<span id="cb112-3"><a href="index-evaluation.html#cb112-3" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="cn">NULL</span>,</span>
<span id="cb112-4"><a href="index-evaluation.html#cb112-4" tabindex="-1"></a>    <span class="at">response =</span> disease<span class="sc">$</span>prognostic,</span>
<span id="cb112-5"><a href="index-evaluation.html#cb112-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb112-6"><a href="index-evaluation.html#cb112-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb112-7"><a href="index-evaluation.html#cb112-7" tabindex="-1"></a>)</span></code></pre></div>
<p>El conjunto de datos utilizado para pronóstico contiene la expresión de 2652 genes provenientes de 502 muestras extraídas de pacientes con la enfermedad. Los genes de estudio se corresponde con los diferencialmente expresados en experimentos de scRNA-seq.</p>
<p>De los 2651 genes seleccionados, 1015 (38.27%) presentan un <span class="math inline">\(AUC \ge 0.5\)</span>. En regiones de alta sensibilidad (<span class="math inline">\(TPR \ge 0.9\)</span>), de este número 173 presentan curvas <span class="math inline">\(ROC\)</span> cóncavas (17.04% y 6.52% del total), 296 presentan algún tipo de gancho sin llegar a atravesar la línea del azar (29.16% y 11.16% del total) y 546 atraviesan en algún punto dicha línea (52.43% y 20.59% del total).</p>
<p>Para regiones de alta especificidad (<span class="math inline">\(FPR \le 0.1\)</span>), de los predictores con un <span class="math inline">\(AUC \ge 0.5\)</span>, 127 presentan curvas cóncavas (12.51%, un 4.79% del total), 376 curvas parcialmente adecuadas (37.04%, un 14.18% del total) y 511 contienen algún punto bajo la línea de azar (50.34%, un 19.27% del total).</p>
</div>
<div id="índices-de-sensibilidad-npauc-y-fpauc" class="section level4 hasAnchor" number="5.4.3.2">
<h4><span class="header-section-number">5.4.3.2</span> Índices de sensibilidad: <span class="math inline">\(NpAUC\)</span> y <span class="math inline">\(FpAUC\)</span><a href="index-evaluation.html#índices-de-sensibilidad-npauc-y-fpauc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>De forma similar al procedimiento en condiciones de diagnóstico, se explorarán algunas medidas de tendencia central.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="index-evaluation.html#cb113-1" tabindex="-1"></a><span class="fu">summary</span>(metric_prognostic_tpr<span class="sc">$</span>data)</span></code></pre></div>
<pre><code>##   identifier             auc              pauc              np_auc       
##  Length:2651        Min.   :0.2485   Min.   :0.000000   Min.   :0.00000  
##  Class :character   1st Qu.:0.4289   1st Qu.:0.003098   1st Qu.:0.03098  
##  Mode  :character   Median :0.4767   Median :0.004921   Median :0.04921  
##                     Mean   :0.4778   Mean   :0.005477   Mean   :0.05477  
##                     3rd Qu.:0.5249   3rd Qu.:0.007376   3rd Qu.:0.07376  
##                     Max.   :0.7377   Max.   :0.024389   Max.   :0.24389  
##                                                                          
##      fp_auc       curve_shape       
##  Min.   :0.5000   Length:2651       
##  1st Qu.:0.6950   Class :character  
##  Median :0.7434   Mode  :character  
##  Mean   :0.7354                     
##  3rd Qu.:0.7848                     
##  Max.   :0.9758                     
##  NA&#39;s   :1</code></pre>
<p>En este contexto, tanto el <span class="math inline">\(pAUC\)</span> como el <span class="math inline">\(NpAUC\)</span> toman valores inferiores a <span class="math inline">\(0.5\)</span> mientras que el <span class="math inline">\(FpAUC\)</span> toma superiores. Estos resultados probablemente se deban a los límites definidos por el <span class="math inline">\(NpAUC\)</span> y <span class="math inline">\(FpAUC\)</span>. El <span class="math inline">\(NpAUC\)</span> define su límite inferior como la mitad del área de la banda <span class="math inline">\((TPR_0, 1)\)</span> <a href="index-evaluation.html#eq:npauc-normalized-bounds">(5.7)</a>, en consecuencia, una curva <span class="math inline">\(ROC\)</span> contenida por este límite resultará en valores de <span class="math inline">\(NpAUC\)</span> inferiores a <span class="math inline">\(0.5\)</span>. Para visualizarlo, se escogerá el predictor <code>ENSG00000185615</code> que posee el mayor valor de <span class="math inline">\(NpAUC\)</span> en los datos.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="index-evaluation.html#cb115-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(</span>
<span id="cb115-2"><a href="index-evaluation.html#cb115-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb115-3"><a href="index-evaluation.html#cb115-3" tabindex="-1"></a>    ENSG00000185615,</span>
<span id="cb115-4"><a href="index-evaluation.html#cb115-4" tabindex="-1"></a>    prognostic,</span>
<span id="cb115-5"><a href="index-evaluation.html#cb115-5" tabindex="-1"></a>    <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb115-6"><a href="index-evaluation.html#cb115-6" tabindex="-1"></a>    <span class="fl">0.9</span></span>
<span id="cb115-7"><a href="index-evaluation.html#cb115-7" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.7143536
</td>
<td style="text-align:right;">
0.0243888
</td>
<td style="text-align:right;">
0.2438877
</td>
<td style="text-align:right;">
0.7743255
</td>
<td style="text-align:left;">
Partially proper
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="index-evaluation.html#cb116-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb116-2"><a href="index-evaluation.html#cb116-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb116-3"><a href="index-evaluation.html#cb116-3" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb116-4"><a href="index-evaluation.html#cb116-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000185615</span>
<span id="cb116-5"><a href="index-evaluation.html#cb116-5" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb116-6"><a href="index-evaluation.html#cb116-6" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb116-7"><a href="index-evaluation.html#cb116-7" tabindex="-1"></a>    <span class="fu">add_tpr_threshold_line</span>(<span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb116-8"><a href="index-evaluation.html#cb116-8" tabindex="-1"></a>    <span class="fu">add_fpauc_partially_proper_lower_bound</span>(</span>
<span id="cb116-9"><a href="index-evaluation.html#cb116-9" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb116-10"><a href="index-evaluation.html#cb116-10" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb116-11"><a href="index-evaluation.html#cb116-11" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000185615,</span>
<span id="cb116-12"><a href="index-evaluation.html#cb116-12" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb116-13"><a href="index-evaluation.html#cb116-13" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb116-14"><a href="index-evaluation.html#cb116-14" tabindex="-1"></a>    <span class="fu">add_npauc_normalized_lower_bound</span>(</span>
<span id="cb116-15"><a href="index-evaluation.html#cb116-15" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb116-16"><a href="index-evaluation.html#cb116-16" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb116-17"><a href="index-evaluation.html#cb116-17" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000185615,</span>
<span id="cb116-18"><a href="index-evaluation.html#cb116-18" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb116-19"><a href="index-evaluation.html#cb116-19" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Predictor%20ENSG00000185615%20con%20l%C3%ADmite%20inferior%20de%20NpAUC-1.png" width="672" /></p>
<p>Como se observa en la figura, la curva <span class="math inline">\(ROC\)</span> queda definida por debajo del límite definido por <span class="math inline">\(NpAUC\)</span> pero por encima del definido por <span class="math inline">\(FpAUC\)</span>. De esta forma, se confirma que el <span class="math inline">\(FpAUC\)</span> presenta mejor interpretabilidad, además de ser aplicable independientemente de la forma de la curva.</p>
<p>Además de su interpretabilidad, es interesante evaluar la capacidad para distinguir predictores con igual <span class="math inline">\(pAUC\)</span> y cuyas curvas se cruzan en algún punto en la región de interés. De todo el conjunto de datos, 241 predictores presentan un <span class="math inline">\(pAUC\)</span> idéntico a al menos otro, formando 114 grupos en función de esta métrica. Para evaluar el rendimiento de los índices se utilizarán los predictores <code>ENSG00000272333</code> y <code>ENSG00000096070</code>, aquellos de mayor <span class="math inline">\(pAUC\)</span> en los grupos formados.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="index-evaluation.html#cb117-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb117-2"><a href="index-evaluation.html#cb117-2" tabindex="-1"></a>    <span class="st">&quot;ENSG00000272333&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb117-3"><a href="index-evaluation.html#cb117-3" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb117-4"><a href="index-evaluation.html#cb117-4" tabindex="-1"></a>        ENSG00000272333,</span>
<span id="cb117-5"><a href="index-evaluation.html#cb117-5" tabindex="-1"></a>        prognostic,</span>
<span id="cb117-6"><a href="index-evaluation.html#cb117-6" tabindex="-1"></a>        <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb117-7"><a href="index-evaluation.html#cb117-7" tabindex="-1"></a>        <span class="fl">0.9</span></span>
<span id="cb117-8"><a href="index-evaluation.html#cb117-8" tabindex="-1"></a>    ),</span>
<span id="cb117-9"><a href="index-evaluation.html#cb117-9" tabindex="-1"></a>    <span class="st">&quot;ENSG00000096070&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb117-10"><a href="index-evaluation.html#cb117-10" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb117-11"><a href="index-evaluation.html#cb117-11" tabindex="-1"></a>        ENSG00000096070,</span>
<span id="cb117-12"><a href="index-evaluation.html#cb117-12" tabindex="-1"></a>        prognostic,</span>
<span id="cb117-13"><a href="index-evaluation.html#cb117-13" tabindex="-1"></a>        <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb117-14"><a href="index-evaluation.html#cb117-14" tabindex="-1"></a>        <span class="fl">0.9</span></span>
<span id="cb117-15"><a href="index-evaluation.html#cb117-15" tabindex="-1"></a>    ),</span>
<span id="cb117-16"><a href="index-evaluation.html#cb117-16" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;Identifier&quot;</span></span>
<span id="cb117-17"><a href="index-evaluation.html#cb117-17" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000272333
</td>
<td style="text-align:right;">
0.5947269
</td>
<td style="text-align:right;">
0.0131597
</td>
<td style="text-align:right;">
0.1315975
</td>
<td style="text-align:right;">
0.7782804
</td>
<td style="text-align:left;">
Partially proper
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000096070
</td>
<td style="text-align:right;">
0.5004503
</td>
<td style="text-align:right;">
0.0131597
</td>
<td style="text-align:right;">
0.1315975
</td>
<td style="text-align:right;">
0.8087762
</td>
<td style="text-align:left;">
Concave
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="index-evaluation.html#cb118-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb118-2"><a href="index-evaluation.html#cb118-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb118-3"><a href="index-evaluation.html#cb118-3" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb118-4"><a href="index-evaluation.html#cb118-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000272333</span>
<span id="cb118-5"><a href="index-evaluation.html#cb118-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb118-6"><a href="index-evaluation.html#cb118-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(</span>
<span id="cb118-7"><a href="index-evaluation.html#cb118-7" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb118-8"><a href="index-evaluation.html#cb118-8" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb118-9"><a href="index-evaluation.html#cb118-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000096070</span>
<span id="cb118-10"><a href="index-evaluation.html#cb118-10" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb118-11"><a href="index-evaluation.html#cb118-11" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb118-12"><a href="index-evaluation.html#cb118-12" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.9</span>, <span class="st">&quot;tpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Comparaci%C3%B3n%20de%20marcadores%20ENSG00000272333%20y%20ENSG00000096070-1.png" width="672" /></p>
<p>En este caso, los predictores no presentan un buen rendimiento global, a diferencia de en la región de interés. En esta región ambas curvas se cruzan en varios puntos y mientras que el <span class="math inline">\(NpAUC\)</span> no es capaz de distinguir el predictor de mayor rendimiento (<span class="math inline">\(NpAUC = 0.13159748\)</span>), el <span class="math inline">\(FpAUC\)</span> identifica que <code>ENSG00000096070</code> (<span class="math inline">\(FpAUC = 0.8087762\)</span>) rinde mejor que <code>ENSG00000272333</code> (<span class="math inline">\(FpAUC = 0.7782804\)</span>). De forma similar a las condiciones de diagnóstico, dado que el <span class="math inline">\(FpAUC\)</span> adapta sus límites a la forma y puntos de la curva, puede distinguir entre predictores con igual <span class="math inline">\(pAUC\)</span> cuyas curvas se cruzan. Esta capacidad de discriminación puede contrastarse con el resto del conjunto de datos.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="index-evaluation.html#cb119-1" tabindex="-1"></a>metric_prognostic_tpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="index-evaluation.html#cb119-2" tabindex="-1"></a>    <span class="fu">filter</span>(pauc <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="index-evaluation.html#cb119-3" tabindex="-1"></a>    <span class="fu">group_by</span>(pauc) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="index-evaluation.html#cb119-4" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="index-evaluation.html#cb119-5" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb119-6"><a href="index-evaluation.html#cb119-6" tabindex="-1"></a>        <span class="at">npauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb119-7"><a href="index-evaluation.html#cb119-7" tabindex="-1"></a>            <span class="fu">map_lgl</span>(np_auc, \(x) <span class="fu">near</span>(x, np_auc[[<span class="dv">1</span>]]))</span>
<span id="cb119-8"><a href="index-evaluation.html#cb119-8" tabindex="-1"></a>        ),</span>
<span id="cb119-9"><a href="index-evaluation.html#cb119-9" tabindex="-1"></a>        <span class="at">fpauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb119-10"><a href="index-evaluation.html#cb119-10" tabindex="-1"></a>            <span class="fu">map_lgl</span>(fp_auc, \(x) <span class="fu">near</span>(x, fp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb119-11"><a href="index-evaluation.html#cb119-11" tabindex="-1"></a>        )</span>
<span id="cb119-12"><a href="index-evaluation.html#cb119-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb119-13"><a href="index-evaluation.html#cb119-13" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb119-14"><a href="index-evaluation.html#cb119-14" tabindex="-1"></a>        <span class="at">npauc_equal =</span> <span class="fu">all</span>(npauc_equal),</span>
<span id="cb119-15"><a href="index-evaluation.html#cb119-15" tabindex="-1"></a>        <span class="at">fpauc_equal =</span> <span class="fu">all</span>(fpauc_equal)</span>
<span id="cb119-16"><a href="index-evaluation.html#cb119-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb119-17"><a href="index-evaluation.html#cb119-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(npauc_equal, fpauc_equal)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
npauc_equal
</th>
<th style="text-align:left;">
fpauc_equal
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
76
</td>
</tr>
</tbody>
</table>
<p>El <span class="math inline">\(FpAUC\)</span> es capaz de desempatar entre los predictores en 38 de los 114 grupos formados, mientras que el <span class="math inline">\(NpAUC\)</span> no es capaz de hacerlo en ninguno de ellos.</p>
</div>
<div id="índices-de-especificidad-spauc-y-tpauc-1" class="section level4 hasAnchor" number="5.4.3.3">
<h4><span class="header-section-number">5.4.3.3</span> Índices de especificidad: <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span><a href="index-evaluation.html#índices-de-especificidad-spauc-y-tpauc-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Igual que en los casos anteriores, para realizar la evaluación de los índices se explorarán algunas métricas generales en primer lugar.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="index-evaluation.html#cb120-1" tabindex="-1"></a><span class="fu">summary</span>(metric_prognostic_fpr<span class="sc">$</span>data)</span></code></pre></div>
<pre><code>##   identifier             auc              pauc               sp_auc      
##  Length:2651        Min.   :0.2485   Min.   :0.0002866   Min.   :0.5000  
##  Class :character   1st Qu.:0.4289   1st Qu.:0.0036109   1st Qu.:0.5065  
##  Mode  :character   Median :0.4767   Median :0.0054696   Median :0.5148  
##                     Mean   :0.4778   Mean   :0.0063296   Mean   :0.5196  
##                     3rd Qu.:0.5249   3rd Qu.:0.0082330   3rd Qu.:0.5276  
##                     Max.   :0.7377   Max.   :0.0277573   Max.   :0.6198  
##                                                          NA&#39;s   :1167    
##      tp_auc       curve_shape       
##  Min.   :0.5000   Length:2651       
##  1st Qu.:0.7088   Class :character  
##  Median :0.7492   Mode  :character  
##  Mean   :0.7443                     
##  3rd Qu.:0.7855                     
##  Max.   :0.9322                     
## </code></pre>
<p>De nuevo, el <span class="math inline">\(pAUC\)</span> solo toma valores inferiores a <span class="math inline">\(0.5\)</span> a diferencia del <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span> que toman valores superiores. Además, el <span class="math inline">\(SpAUC\)</span> toma valores de <code>NA</code>, los cuales se corresponden para casos donde el límite inferior <a href="index-evaluation.html#eq:spauc-bounds">(5.1)</a> no se cumple, como se ha visto previamente. A diferencia del escenario anterior, el <span class="math inline">\(TpAUC\)</span> no toma valores atípicos por debajo de <span class="math inline">\(0.5\)</span>, esto se debe a que no hay predictores con <span class="math inline">\(pAUC = 0\)</span>.</p>
<p>Para contrastar la interpretabilidad de ambos índices se utilizará arbitrariamente el predictor <code>ENSG00000110013</code>, que no presenta valor para el <span class="math inline">\(SpAUC\)</span> y uno relativamente alto para el <span class="math inline">\(TpAUC\)</span>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="index-evaluation.html#cb122-1" tabindex="-1"></a><span class="fu">summarize_predictor</span>(</span>
<span id="cb122-2"><a href="index-evaluation.html#cb122-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb122-3"><a href="index-evaluation.html#cb122-3" tabindex="-1"></a>    ENSG00000110013,</span>
<span id="cb122-4"><a href="index-evaluation.html#cb122-4" tabindex="-1"></a>    prognostic,</span>
<span id="cb122-5"><a href="index-evaluation.html#cb122-5" tabindex="-1"></a>    <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb122-6"><a href="index-evaluation.html#cb122-6" tabindex="-1"></a>    <span class="fl">0.1</span></span>
<span id="cb122-7"><a href="index-evaluation.html#cb122-7" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.3827888
</td>
<td style="text-align:right;">
0.0008352
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.9322034
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="index-evaluation.html#cb123-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb123-2"><a href="index-evaluation.html#cb123-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb123-3"><a href="index-evaluation.html#cb123-3" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb123-4"><a href="index-evaluation.html#cb123-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000110013</span>
<span id="cb123-5"><a href="index-evaluation.html#cb123-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="index-evaluation.html#cb123-6" tabindex="-1"></a>    <span class="fu">add_spauc_lower_bound</span>(</span>
<span id="cb123-7"><a href="index-evaluation.html#cb123-7" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb123-8"><a href="index-evaluation.html#cb123-8" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb123-9"><a href="index-evaluation.html#cb123-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000110013,</span>
<span id="cb123-10"><a href="index-evaluation.html#cb123-10" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb123-11"><a href="index-evaluation.html#cb123-11" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb123-12"><a href="index-evaluation.html#cb123-12" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb123-13"><a href="index-evaluation.html#cb123-13" tabindex="-1"></a>    <span class="fu">add_tpauc_under_chance_lower_bound</span>(</span>
<span id="cb123-14"><a href="index-evaluation.html#cb123-14" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb123-15"><a href="index-evaluation.html#cb123-15" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb123-16"><a href="index-evaluation.html#cb123-16" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000110013,</span>
<span id="cb123-17"><a href="index-evaluation.html#cb123-17" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span>,</span>
<span id="cb123-18"><a href="index-evaluation.html#cb123-18" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span></span>
<span id="cb123-19"><a href="index-evaluation.html#cb123-19" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb123-20"><a href="index-evaluation.html#cb123-20" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb123-21"><a href="index-evaluation.html#cb123-21" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Plot%20predictor%20ENSG00000196363-1.png" width="672" /></p>
<p>Como se observa en la figura, la curva <span class="math inline">\(ROC\)</span> se encuentra contenida bajo el límite inferior de <span class="math inline">\(SpAUC\)</span> y por tanto obteniendo un valor de <code>NA</code>. Por otra parte, el límite de <span class="math inline">\(TpAUC\)</span> (<span class="math inline">\(0\)</span>, dado que <span class="math inline">\(TPR = 0\)</span> para toda la región) se ajusta a la forma de la curva y por tanto puede calcularse.</p>
<p>Al igual que en los casos anteriores, de forma general <span class="math inline">\(SpAUC\)</span> y <span class="math inline">\(TpAUC\)</span> son métricas interpretables dado que se comprenden entre valores de <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>. Sin embargo, el <span class="math inline">\(SpAUC\)</span> define límites que no se ajustan a ciertas curvas y por tanto imposibilitando su aplicación, mientras que el <span class="math inline">\(TpAUC\)</span> se ajusta a la forma de la curva, pudiéndose aplicar a cualquiera y por tanto haciéndola una métrica más idónea.</p>
<p>Una vez considerada la interpretabilidad de ambas métricas, se contrastará su capacidad para discriminar predictores con curvas que se cruzan y de igual <span class="math inline">\(pAUC\)</span>. Del conjunto de datos, 917 predictores presentan un <span class="math inline">\(pAUC\)</span> igual al menos a otro, formándose 407 grupos en función de esta métrica. Para estudiar la capacidad de discriminación, se utilizarán los predictores <code>ENSG00000177943</code> y <code>ENSG00000136783</code>, aquellos de mayor <span class="math inline">\(pAUC\)</span> entre los grupos formados.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="index-evaluation.html#cb124-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb124-2"><a href="index-evaluation.html#cb124-2" tabindex="-1"></a>    <span class="st">&quot;ENSG00000177943&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb124-3"><a href="index-evaluation.html#cb124-3" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb124-4"><a href="index-evaluation.html#cb124-4" tabindex="-1"></a>        ENSG00000177943,</span>
<span id="cb124-5"><a href="index-evaluation.html#cb124-5" tabindex="-1"></a>        prognostic,</span>
<span id="cb124-6"><a href="index-evaluation.html#cb124-6" tabindex="-1"></a>        <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb124-7"><a href="index-evaluation.html#cb124-7" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb124-8"><a href="index-evaluation.html#cb124-8" tabindex="-1"></a>    ),</span>
<span id="cb124-9"><a href="index-evaluation.html#cb124-9" tabindex="-1"></a>    <span class="st">&quot;ENSG00000136783&quot;</span> <span class="ot">=</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb124-10"><a href="index-evaluation.html#cb124-10" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb124-11"><a href="index-evaluation.html#cb124-11" tabindex="-1"></a>        ENSG00000136783,</span>
<span id="cb124-12"><a href="index-evaluation.html#cb124-12" tabindex="-1"></a>        prognostic,</span>
<span id="cb124-13"><a href="index-evaluation.html#cb124-13" tabindex="-1"></a>        <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb124-14"><a href="index-evaluation.html#cb124-14" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb124-15"><a href="index-evaluation.html#cb124-15" tabindex="-1"></a>    ),</span>
<span id="cb124-16"><a href="index-evaluation.html#cb124-16" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;Identifier&quot;</span></span>
<span id="cb124-17"><a href="index-evaluation.html#cb124-17" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000177943
</td>
<td style="text-align:right;">
0.6587407
</td>
<td style="text-align:right;">
0.0172194
</td>
<td style="text-align:right;">
0.5643124
</td>
<td style="text-align:right;">
0.8111201
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000136783
</td>
<td style="text-align:right;">
0.6306722
</td>
<td style="text-align:right;">
0.0172194
</td>
<td style="text-align:right;">
0.5643124
</td>
<td style="text-align:right;">
0.7711047
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="index-evaluation.html#cb125-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb125-2"><a href="index-evaluation.html#cb125-2" tabindex="-1"></a>         prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb125-3"><a href="index-evaluation.html#cb125-3" tabindex="-1"></a>         <span class="at">response =</span> prognostic,</span>
<span id="cb125-4"><a href="index-evaluation.html#cb125-4" tabindex="-1"></a>         <span class="at">predictor =</span> ENSG00000177943</span>
<span id="cb125-5"><a href="index-evaluation.html#cb125-5" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb125-6"><a href="index-evaluation.html#cb125-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(</span>
<span id="cb125-7"><a href="index-evaluation.html#cb125-7" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb125-8"><a href="index-evaluation.html#cb125-8" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb125-9"><a href="index-evaluation.html#cb125-9" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000136783</span>
<span id="cb125-10"><a href="index-evaluation.html#cb125-10" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb125-11"><a href="index-evaluation.html#cb125-11" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb125-12"><a href="index-evaluation.html#cb125-12" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Comparaci%C3%B3n%20de%20marcadores%20ENSG00000177943%20y%20ENSG00000136783-1.png" width="672" /></p>
<p>Ambos predictores presentan un rendimiento ligeramente mejor que un clasificador aleatorio a nivel global, pero en la región de interés presentan un rendimiento mucho mejor. Los predictores presentan el mismo <span class="math inline">\(SpAUC\)</span> (<span class="math inline">\(0.5643124\)</span>), a diferencia del <span class="math inline">\(TpAUC\)</span> que toma valores distintos e indica que <code>ENSG00000177943</code> presenta un mejor rendimiento.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="index-evaluation.html#cb126-1" tabindex="-1"></a><span class="fu">plot_partial_roc_curve</span>(</span>
<span id="cb126-2"><a href="index-evaluation.html#cb126-2" tabindex="-1"></a>         prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb126-3"><a href="index-evaluation.html#cb126-3" tabindex="-1"></a>         <span class="at">response =</span> prognostic,</span>
<span id="cb126-4"><a href="index-evaluation.html#cb126-4" tabindex="-1"></a>         <span class="at">predictor =</span> ENSG00000177943,</span>
<span id="cb126-5"><a href="index-evaluation.html#cb126-5" tabindex="-1"></a>         <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb126-6"><a href="index-evaluation.html#cb126-6" tabindex="-1"></a>         <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb126-7"><a href="index-evaluation.html#cb126-7" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb126-8"><a href="index-evaluation.html#cb126-8" tabindex="-1"></a>    <span class="fu">add_partial_roc_curve</span>(</span>
<span id="cb126-9"><a href="index-evaluation.html#cb126-9" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb126-10"><a href="index-evaluation.html#cb126-10" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb126-11"><a href="index-evaluation.html#cb126-11" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000136783,</span>
<span id="cb126-12"><a href="index-evaluation.html#cb126-12" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb126-13"><a href="index-evaluation.html#cb126-13" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb126-14"><a href="index-evaluation.html#cb126-14" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb126-15"><a href="index-evaluation.html#cb126-15" tabindex="-1"></a>    <span class="fu">add_tpauc_partially_proper_lower_bound</span>(</span>
<span id="cb126-16"><a href="index-evaluation.html#cb126-16" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb126-17"><a href="index-evaluation.html#cb126-17" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb126-18"><a href="index-evaluation.html#cb126-18" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000177943,</span>
<span id="cb126-19"><a href="index-evaluation.html#cb126-19" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span>,</span>
<span id="cb126-20"><a href="index-evaluation.html#cb126-20" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span></span>
<span id="cb126-21"><a href="index-evaluation.html#cb126-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb126-22"><a href="index-evaluation.html#cb126-22" tabindex="-1"></a>    <span class="fu">add_tpauc_partially_proper_lower_bound</span>(</span>
<span id="cb126-23"><a href="index-evaluation.html#cb126-23" tabindex="-1"></a>        prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb126-24"><a href="index-evaluation.html#cb126-24" tabindex="-1"></a>        <span class="at">response =</span> prognostic,</span>
<span id="cb126-25"><a href="index-evaluation.html#cb126-25" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000136783,</span>
<span id="cb126-26"><a href="index-evaluation.html#cb126-26" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span>,</span>
<span id="cb126-27"><a href="index-evaluation.html#cb126-27" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span></span>
<span id="cb126-28"><a href="index-evaluation.html#cb126-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb126-29"><a href="index-evaluation.html#cb126-29" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb126-30"><a href="index-evaluation.html#cb126-30" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Ampliaci%C3%B3n%20de%20comparaci%C3%B3n%20de%20marcadores%20ENSG00000177943%20y%20ENSG00000136783-1.png" width="672" /></p>
<p>Para este caso, ambos predictores poseen el mismo límite inferior para <span class="math inline">\(TpAUC\)</span>, sin embargo sus límites superiores será distintos dado que poseen distinto <span class="math inline">\(TPR_2\)</span>, <a href="index-evaluation.html#eq:tpauc-proper-bounds">(5.4)</a>. Por este motivo, el índice toma valores distintos estableciendo que el predictor <code>ENSG00000177943</code> (<span class="math inline">\(TpAUC = 0.8111201\)</span>) rinde mejor que <code>ENSG00000136783</code> (<span class="math inline">\(TpAUC = 0.7711047\)</span>). Esta capacidad de discriminación se puede contrastar en todo el conjunto de datos.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="index-evaluation.html#cb127-1" tabindex="-1"></a>metric_prognostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="index-evaluation.html#cb127-2" tabindex="-1"></a>    <span class="fu">filter</span>(pauc <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="index-evaluation.html#cb127-3" tabindex="-1"></a>    <span class="fu">group_by</span>(pauc) <span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="index-evaluation.html#cb127-4" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-5"><a href="index-evaluation.html#cb127-5" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb127-6"><a href="index-evaluation.html#cb127-6" tabindex="-1"></a>        <span class="at">spauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb127-7"><a href="index-evaluation.html#cb127-7" tabindex="-1"></a>            <span class="fu">map_lgl</span>(sp_auc, \(x) <span class="fu">near</span>(x, sp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb127-8"><a href="index-evaluation.html#cb127-8" tabindex="-1"></a>        ),</span>
<span id="cb127-9"><a href="index-evaluation.html#cb127-9" tabindex="-1"></a>        <span class="at">tpauc_equal =</span> <span class="fu">all</span>(</span>
<span id="cb127-10"><a href="index-evaluation.html#cb127-10" tabindex="-1"></a>            <span class="fu">map_lgl</span>(tp_auc, \(x) <span class="fu">near</span>(x, tp_auc[[<span class="dv">1</span>]]))</span>
<span id="cb127-11"><a href="index-evaluation.html#cb127-11" tabindex="-1"></a>        )</span>
<span id="cb127-12"><a href="index-evaluation.html#cb127-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb127-13"><a href="index-evaluation.html#cb127-13" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb127-14"><a href="index-evaluation.html#cb127-14" tabindex="-1"></a>        <span class="at">spauc_equal =</span> <span class="fu">all</span>(spauc_equal),</span>
<span id="cb127-15"><a href="index-evaluation.html#cb127-15" tabindex="-1"></a>        <span class="at">tpauc_equal =</span> <span class="fu">all</span>(tpauc_equal)</span>
<span id="cb127-16"><a href="index-evaluation.html#cb127-16" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb127-17"><a href="index-evaluation.html#cb127-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(spauc_equal, tpauc_equal)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
spauc_equal
</th>
<th style="text-align:left;">
tpauc_equal
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
184
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
138
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
56
</td>
</tr>
</tbody>
</table>
<p>De los 407 grupos de grupos formados, el <span class="math inline">\(SpAUC\)</span> no es capaz de diferenciar un marcador que rinda mejor en ninguno de ellos. Además, no es capaz de aplicarse debido a la forma de la curva en 194 de ellos. Por otra parte el <span class="math inline">\(TpAUC\)</span> es capaz de diferenciar un mejor predictor en 323 grupos de los 407 totales. Este hecho refuerza que el <span class="math inline">\(TpAUC\)</span> es una mejor métrica a la hora de evaluar el rendimiento de un predictor, al ser aplicable a cualquier tipo de curva y discriminar entre predictores con igual <span class="math inline">\(pAUC\)</span>, a diferencia del <span class="math inline">\(SpAUC\)</span>.</p>
</div>
</div>
</div>
<div id="resultados" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Resultados<a href="index-evaluation.html#resultados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="rendimiento-de-métricas" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Rendimiento de métricas<a href="index-evaluation.html#rendimiento-de-métricas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tras haber contrastado distintas transformaciones del <span class="math inline">\(pAUC\)</span> en condiciones de alta sensibilidad y especificidad, se observa como el <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> presentan un mejor rendimiento a la hora de seleccionar predictores relevantes. Estos índices solventan limitaciones descritas por el propio <span class="math inline">\(pAUC\)</span> y otras transformaciones derivadas, como el <span class="math inline">\(SpAUC\)</span> y el <span class="math inline">\(NpAUC\)</span>, lo que hace que se conviertan en métricas más idóneas en la práctica. En primer lugar, ambas métricas presentan límites inferiores y superiores que se ajustan a las curvas <span class="math inline">\(ROC\)</span> de un predictor, independientemente de su forma. En segundo lugar, son capaces de discriminar entre predictores que presentan un mismo <span class="math inline">\(pAUC\)</span> y cuyas curvas <span class="math inline">\(ROC\)</span> se cruzan en la región de interés, algo que no había sido posible hasta ahora. Finalmente, pero no menos importante, comprenden sus valores entre <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>, lo cual facilita su interpretación a la hora de seleccionar predictores.</p>
<p>Como se ha comprobado en las secciones anteriores, estas limitaciones son comunes en la práctica por lo que el <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> presentan un valor añadido como métricas de selección de predictores.</p>
</div>
<div id="relevancia-clínica" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Relevancia clínica<a href="index-evaluation.html#relevancia-clínica" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aunque teóricamente el <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> solventan las limitaciones de otros índices, en la práctica, estas también deben de ser capaces de encontrar marcadores clínicamente relevantes. Esta capacidad puede comprobarse con el conjunto de datos generado y predictores ya conocidos para el diagnóstico y estratificación de pacientes en cáncer de próstata.</p>
<p>Desde la primera vez que fue descrito, el antígeno específico de próstata (PSA) ha sido utilizado en los planes de diagnóstico y tratamiento de pacientes con cáncer de próstata. Desde su aplicación, la mortalidad y el número de diagnósticos en estados avanzados de la enfermedad se ha reducido, sin embargo, este biomarcador presenta ciertas limitaciones <span class="citation">(<a href="referencias.html#ref-tumor-heterogeneity">Wasim, Lee, and Kim 2022</a>)</span>. Aunque el PSA es específico del tejido, este puede presentarse en lesiones benignas, es decir, generando falsos positivos. Además, a la hora de realizar una estratificación de riesgo de un paciente requiere de utilizar otras técnicas y métricas adicionales.</p>
<p>El nombre de PSA es utilizado en el ámbito clínico, pero en otros ámbitos también es conocido como kallikrein related peptidase 3 (<em>KLK3</em>), una proteasa expresada en las células del tejido. Este biomarcador se encuentra entre los descritos en el conjunto de datos con el identificador <code>ENSG00000142515</code>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="index-evaluation.html#cb128-1" tabindex="-1"></a><span class="fu">inner_join</span>(</span>
<span id="cb128-2"><a href="index-evaluation.html#cb128-2" tabindex="-1"></a>    metrics_diagnostic_tpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="index-evaluation.html#cb128-3" tabindex="-1"></a>        <span class="fu">filter</span>(identifier <span class="sc">==</span> <span class="st">&quot;ENSG00000142515&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>curve_shape),</span>
<span id="cb128-4"><a href="index-evaluation.html#cb128-4" tabindex="-1"></a>    metrics_diagnostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb128-5"><a href="index-evaluation.html#cb128-5" tabindex="-1"></a>        <span class="fu">filter</span>(identifier <span class="sc">==</span> <span class="st">&quot;ENSG00000142515&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>curve_shape),</span>
<span id="cb128-6"><a href="index-evaluation.html#cb128-6" tabindex="-1"></a>    <span class="fu">join_by</span>(identifier, auc),</span>
<span id="cb128-7"><a href="index-evaluation.html#cb128-7" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sens&quot;</span>, <span class="st">&quot;_spec&quot;</span>)</span>
<span id="cb128-8"><a href="index-evaluation.html#cb128-8" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc_sens
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:right;">
pauc_spec
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000142515
</td>
<td style="text-align:right;">
0.649479
</td>
<td style="text-align:right;">
0.0191005
</td>
<td style="text-align:right;">
0.1910052
</td>
<td style="text-align:right;">
0.7640208
</td>
<td style="text-align:right;">
0.0135228
</td>
<td style="text-align:right;">
0.544857
</td>
<td style="text-align:right;">
0.7856116
</td>
</tr>
</tbody>
</table>
<p>Además de <em>KLK3</em>, entre los datos se pueden encontrar otros marcadores de diagnóstico conocidos, como <em>AMACR</em> (<code>ENSG00000242110</code>) y <em>FOLH1</em> (<code>ENSG00000086205</code>). El rendimiento de estos marcadores puede comparase con los diversos índices, para así, contrastarlos en función relevancia clínica.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="index-evaluation.html#cb129-1" tabindex="-1"></a>known_markers <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb129-2"><a href="index-evaluation.html#cb129-2" tabindex="-1"></a>    <span class="st">&quot;ENSG00000242110&quot;</span>,</span>
<span id="cb129-3"><a href="index-evaluation.html#cb129-3" tabindex="-1"></a>    <span class="st">&quot;ENSG00000086205&quot;</span>,</span>
<span id="cb129-4"><a href="index-evaluation.html#cb129-4" tabindex="-1"></a>    <span class="st">&quot;ENSG00000142515&quot;</span></span>
<span id="cb129-5"><a href="index-evaluation.html#cb129-5" tabindex="-1"></a>)</span>
<span id="cb129-6"><a href="index-evaluation.html#cb129-6" tabindex="-1"></a></span>
<span id="cb129-7"><a href="index-evaluation.html#cb129-7" tabindex="-1"></a>metrics_diagnostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb129-8"><a href="index-evaluation.html#cb129-8" tabindex="-1"></a>    <span class="fu">filter</span>(identifier <span class="sc">%in%</span> known_markers)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000086205
</td>
<td style="text-align:right;">
0.8114848
</td>
<td style="text-align:right;">
0.0414879
</td>
<td style="text-align:right;">
0.6920416
</td>
<td style="text-align:right;">
0.8457328
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000142515
</td>
<td style="text-align:right;">
0.6494790
</td>
<td style="text-align:right;">
0.0135228
</td>
<td style="text-align:right;">
0.5448570
</td>
<td style="text-align:right;">
0.7856116
</td>
<td style="text-align:left;">
Partially Proper
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000242110
</td>
<td style="text-align:right;">
0.9157217
</td>
<td style="text-align:right;">
0.0672311
</td>
<td style="text-align:right;">
0.8275320
</td>
<td style="text-align:right;">
0.8231707
</td>
<td style="text-align:left;">
Concave
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="index-evaluation.html#cb130-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb130-2"><a href="index-evaluation.html#cb130-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb130-3"><a href="index-evaluation.html#cb130-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb130-4"><a href="index-evaluation.html#cb130-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515</span>
<span id="cb130-5"><a href="index-evaluation.html#cb130-5" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb130-6"><a href="index-evaluation.html#cb130-6" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(roc_data, <span class="at">response =</span> disease, <span class="at">predictor =</span> ENSG00000242110) <span class="sc">+</span> </span>
<span id="cb130-7"><a href="index-evaluation.html#cb130-7" tabindex="-1"></a>    <span class="fu">add_roc_curve</span>(roc_data, <span class="at">response =</span> disease, <span class="at">predictor =</span> ENSG00000086205) <span class="sc">+</span> </span>
<span id="cb130-8"><a href="index-evaluation.html#cb130-8" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb130-9"><a href="index-evaluation.html#cb130-9" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Marcadores%20de%20diagn%C3%B3stico-1.png" width="672" /></p>
<p>Tras representar las curvas <span class="math inline">\(ROC\)</span> de los clasificadores se puede observar como <em>KLK3</em> no presenta un buen rendimiento a nivel global. Sin embargo, este predictor presenta mejor rendimiento en la región de interés, lo cual puede explicar su uso hasta la fecha. A pesar de ello, como se ha explicado previamente, <em>KLK3</em> presenta un gran número de falsos positivos, lo cual, explica que otros predictores como <em>FOLH1</em> y <em>AMACR</em> presentan mejores puntuaciones en la región de interés.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="index-evaluation.html#cb131-1" tabindex="-1"></a><span class="fu">plot_partial_roc_curve</span>(</span>
<span id="cb131-2"><a href="index-evaluation.html#cb131-2" tabindex="-1"></a>    roc_data,</span>
<span id="cb131-3"><a href="index-evaluation.html#cb131-3" tabindex="-1"></a>    <span class="at">response =</span> disease,</span>
<span id="cb131-4"><a href="index-evaluation.html#cb131-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515,</span>
<span id="cb131-5"><a href="index-evaluation.html#cb131-5" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb131-6"><a href="index-evaluation.html#cb131-6" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb131-7"><a href="index-evaluation.html#cb131-7" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb131-8"><a href="index-evaluation.html#cb131-8" tabindex="-1"></a>    <span class="fu">add_partial_roc_curve</span>(</span>
<span id="cb131-9"><a href="index-evaluation.html#cb131-9" tabindex="-1"></a>        roc_data,</span>
<span id="cb131-10"><a href="index-evaluation.html#cb131-10" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb131-11"><a href="index-evaluation.html#cb131-11" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000242110,</span>
<span id="cb131-12"><a href="index-evaluation.html#cb131-12" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb131-13"><a href="index-evaluation.html#cb131-13" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb131-14"><a href="index-evaluation.html#cb131-14" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb131-15"><a href="index-evaluation.html#cb131-15" tabindex="-1"></a>    <span class="fu">add_partial_roc_curve</span>(</span>
<span id="cb131-16"><a href="index-evaluation.html#cb131-16" tabindex="-1"></a>        roc_data,</span>
<span id="cb131-17"><a href="index-evaluation.html#cb131-17" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb131-18"><a href="index-evaluation.html#cb131-18" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000086205,</span>
<span id="cb131-19"><a href="index-evaluation.html#cb131-19" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb131-20"><a href="index-evaluation.html#cb131-20" tabindex="-1"></a>        <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb131-21"><a href="index-evaluation.html#cb131-21" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb131-22"><a href="index-evaluation.html#cb131-22" tabindex="-1"></a>    <span class="fu">add_tpauc_concave_lower_bound</span>(</span>
<span id="cb131-23"><a href="index-evaluation.html#cb131-23" tabindex="-1"></a>        roc_data,</span>
<span id="cb131-24"><a href="index-evaluation.html#cb131-24" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb131-25"><a href="index-evaluation.html#cb131-25" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000242110,</span>
<span id="cb131-26"><a href="index-evaluation.html#cb131-26" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span>,</span>
<span id="cb131-27"><a href="index-evaluation.html#cb131-27" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span></span>
<span id="cb131-28"><a href="index-evaluation.html#cb131-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb131-29"><a href="index-evaluation.html#cb131-29" tabindex="-1"></a>    <span class="fu">add_tpauc_partially_proper_lower_bound</span>(</span>
<span id="cb131-30"><a href="index-evaluation.html#cb131-30" tabindex="-1"></a>        roc_data,</span>
<span id="cb131-31"><a href="index-evaluation.html#cb131-31" tabindex="-1"></a>        <span class="at">response =</span> disease,</span>
<span id="cb131-32"><a href="index-evaluation.html#cb131-32" tabindex="-1"></a>        <span class="at">predictor =</span> ENSG00000086205,</span>
<span id="cb131-33"><a href="index-evaluation.html#cb131-33" tabindex="-1"></a>        <span class="at">upper_threshold =</span> <span class="fl">0.1</span>,</span>
<span id="cb131-34"><a href="index-evaluation.html#cb131-34" tabindex="-1"></a>        <span class="at">lower_threshold =</span> <span class="dv">0</span></span>
<span id="cb131-35"><a href="index-evaluation.html#cb131-35" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb131-36"><a href="index-evaluation.html#cb131-36" tabindex="-1"></a>    <span class="fu">add_chance_line</span>() <span class="sc">+</span></span>
<span id="cb131-37"><a href="index-evaluation.html#cb131-37" tabindex="-1"></a>    <span class="fu">add_threshold_line</span>(<span class="fl">0.1</span>, <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/Marcadores%20de%20diagn%C3%B3stico%20en%20alta%20especificidad-1.png" width="672" /></p>
<p>Si nos centramos en esta zona, el <span class="math inline">\(SpAUC\)</span> califica al <em>AMACR</em> como el predictor de mejor rendimiento (<span class="math inline">\(SpAUC = 0.828\)</span>), pero además, puntúa relativamente bajo al resto, es decir a <em>KLK3</em> y <em>FOLH1</em> (<span class="math inline">\(SpAUC = 0.545\)</span> y <span class="math inline">\(SpAUC = 0.692\)</span>). Por otra parte, el <span class="math inline">\(TpAUC\)</span> califica a <em>FOLH1</em> como el predictor de mayor rendimiento (<span class="math inline">\(TpAUC = 0.846\)</span>) y al <em>AMACR</em> como valores muy similares (<span class="math inline">\(TpAUC = 0.823\)</span>).</p>
<p>Contrastando estos resultados con otros estudios, tanto el <em>AMACR</em> como el <em>FOLH1</em> se encuentran sobrexpresados en pacientes con la enfermedad <span class="citation">(<a href="referencias.html#ref-amacr-marker">N. Jiang et al. 2013</a>; <a href="referencias.html#ref-folh1-marker">Haberkorn et al. 2016</a>)</span>. Sin embargo, <em>FOLH1</em> presenta un mayor interés, por además de su uso a nivel de diagnóstico, como diana terapéutica <span class="citation">(<a href="referencias.html#ref-folh1-therapeutic">Sheehan et al. 2022</a>)</span>. Esto refuerza la interpretación dada por <span class="math inline">\(TpAUC\)</span>, donde tanto <em>AMACR</em> y <em>FOLH1</em> presentan potencial como clasificadores, y en concreto este último, un rendimiento ligermante superior.</p>
<p>Si se selecciona alguno los primeros marcadores identificados por el <span class="math inline">\(TpAUC\)</span>, puede observarse que se encuentran relacionados con la enfermedad, por ejemplo <em>ESRP2</em> (<code>ENSG00000103067</code>), al cual estudios recientes lo describen por tener un papel relevante en el desarrollo de la enfermedad <span class="citation">(<a href="referencias.html#ref-esrp2-marker">Advani et al. 2023</a>)</span>.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="index-evaluation.html#cb132-1" tabindex="-1"></a>metrics_diagnostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="index-evaluation.html#cb132-2" tabindex="-1"></a>    <span class="fu">filter</span>(identifier <span class="sc">==</span> <span class="st">&quot;ENSG00000103067&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="index-evaluation.html#cb132-3" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>curve_shape)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000103067
</td>
<td style="text-align:right;">
0.8339335
</td>
<td style="text-align:right;">
0.0499464
</td>
<td style="text-align:right;">
0.7365598
</td>
<td style="text-align:right;">
0.9497378
</td>
</tr>
</tbody>
</table>
<p>Por otra parte, <em>KLK3</em> presenta un rendimiento peor que un clasificador aleatorio para distinguir entre pacientes con una enfermedad más o menos agresiva.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="index-evaluation.html#cb133-1" tabindex="-1"></a><span class="fu">inner_join</span>(</span>
<span id="cb133-2"><a href="index-evaluation.html#cb133-2" tabindex="-1"></a>    metric_prognostic_fpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="index-evaluation.html#cb133-3" tabindex="-1"></a>        <span class="fu">filter</span>(identifier <span class="sc">==</span> <span class="st">&quot;ENSG00000142515&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="index-evaluation.html#cb133-4" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>curve_shape),</span>
<span id="cb133-5"><a href="index-evaluation.html#cb133-5" tabindex="-1"></a>    metric_prognostic_tpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="index-evaluation.html#cb133-6" tabindex="-1"></a>        <span class="fu">filter</span>(identifier <span class="sc">==</span> <span class="st">&quot;ENSG00000142515&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="index-evaluation.html#cb133-7" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>curve_shape),</span>
<span id="cb133-8"><a href="index-evaluation.html#cb133-8" tabindex="-1"></a>    <span class="fu">join_by</span>(identifier, auc),</span>
<span id="cb133-9"><a href="index-evaluation.html#cb133-9" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_spec&quot;</span>, <span class="st">&quot;_sens&quot;</span>)</span>
<span id="cb133-10"><a href="index-evaluation.html#cb133-10" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc_spec
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:right;">
pauc_sens
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000142515
</td>
<td style="text-align:right;">
0.3177106
</td>
<td style="text-align:right;">
0.0008106
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.779661
</td>
<td style="text-align:right;">
0.0011463
</td>
<td style="text-align:right;">
0.0114632
</td>
<td style="text-align:right;">
0.6690821
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="index-evaluation.html#cb134-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb134-2"><a href="index-evaluation.html#cb134-2" tabindex="-1"></a>    prognostic_dataset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic),</span>
<span id="cb134-3"><a href="index-evaluation.html#cb134-3" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb134-4"><a href="index-evaluation.html#cb134-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515</span>
<span id="cb134-5"><a href="index-evaluation.html#cb134-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb134-6"><a href="index-evaluation.html#cb134-6" tabindex="-1"></a>    <span class="fu">add_chance_line</span>()</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/ROC%20KLK3%20estratificaci%C3%B3n%20de%20riesgo-1.png" width="672" /></p>
<p>La curva <span class="math inline">\(ROC\)</span> del predictor queda definida por debajo de la línea de azar, confirmando un rendimiento peor que un clasificador completamente aleatorio. Cabe destacar, que el cálculo de la curva se ha realizado considerando como condición de interés padecer una forma de la enfermedad más agresiva, y por tanto es posible que el <em>KLK3</em> rinda mejor identificando formas menos agresivas de la enfermedad. Para comprobarlo, es posible invertir la forma de la curva, lo cual resulta equivalente a invertir la condición de interés.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="index-evaluation.html#cb135-1" tabindex="-1"></a>inverse_prognostic_dataset <span class="ot">&lt;-</span> prognostic_dataset <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="index-evaluation.html#cb135-2" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb135-3"><a href="index-evaluation.html#cb135-3" tabindex="-1"></a>        <span class="at">prognostic =</span> disease<span class="sc">$</span>prognostic</span>
<span id="cb135-4"><a href="index-evaluation.html#cb135-4" tabindex="-1"></a>    )</span>
<span id="cb135-5"><a href="index-evaluation.html#cb135-5" tabindex="-1"></a></span>
<span id="cb135-6"><a href="index-evaluation.html#cb135-6" tabindex="-1"></a>inverse_prognostic_dataset<span class="sc">$</span>prognostic <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(</span>
<span id="cb135-7"><a href="index-evaluation.html#cb135-7" tabindex="-1"></a>    inverse_prognostic_dataset<span class="sc">$</span>prognostic,</span>
<span id="cb135-8"><a href="index-evaluation.html#cb135-8" tabindex="-1"></a>    <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb135-9"><a href="index-evaluation.html#cb135-9" tabindex="-1"></a>    <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb135-10"><a href="index-evaluation.html#cb135-10" tabindex="-1"></a>)</span>
<span id="cb135-11"><a href="index-evaluation.html#cb135-11" tabindex="-1"></a></span>
<span id="cb135-12"><a href="index-evaluation.html#cb135-12" tabindex="-1"></a>inverse_prognostic_dataset<span class="sc">$</span>prognostic <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(</span>
<span id="cb135-13"><a href="index-evaluation.html#cb135-13" tabindex="-1"></a>    inverse_prognostic_dataset<span class="sc">$</span>prognostic,</span>
<span id="cb135-14"><a href="index-evaluation.html#cb135-14" tabindex="-1"></a>    <span class="st">&quot;0&quot;</span></span>
<span id="cb135-15"><a href="index-evaluation.html#cb135-15" tabindex="-1"></a>)</span>
<span id="cb135-16"><a href="index-evaluation.html#cb135-16" tabindex="-1"></a></span>
<span id="cb135-17"><a href="index-evaluation.html#cb135-17" tabindex="-1"></a>tpr_metrics <span class="ot">&lt;-</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb135-18"><a href="index-evaluation.html#cb135-18" tabindex="-1"></a>    inverse_prognostic_dataset,</span>
<span id="cb135-19"><a href="index-evaluation.html#cb135-19" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515,</span>
<span id="cb135-20"><a href="index-evaluation.html#cb135-20" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb135-21"><a href="index-evaluation.html#cb135-21" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb135-22"><a href="index-evaluation.html#cb135-22" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.9</span></span>
<span id="cb135-23"><a href="index-evaluation.html#cb135-23" tabindex="-1"></a>)</span>
<span id="cb135-24"><a href="index-evaluation.html#cb135-24" tabindex="-1"></a>fpr_metrics <span class="ot">&lt;-</span> <span class="fu">summarize_predictor</span>(</span>
<span id="cb135-25"><a href="index-evaluation.html#cb135-25" tabindex="-1"></a>    inverse_prognostic_dataset,</span>
<span id="cb135-26"><a href="index-evaluation.html#cb135-26" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515,</span>
<span id="cb135-27"><a href="index-evaluation.html#cb135-27" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb135-28"><a href="index-evaluation.html#cb135-28" tabindex="-1"></a>    <span class="at">ratio =</span> <span class="st">&quot;fpr&quot;</span>,</span>
<span id="cb135-29"><a href="index-evaluation.html#cb135-29" tabindex="-1"></a>    <span class="at">threshold =</span> <span class="fl">0.1</span></span>
<span id="cb135-30"><a href="index-evaluation.html#cb135-30" tabindex="-1"></a>)</span>
<span id="cb135-31"><a href="index-evaluation.html#cb135-31" tabindex="-1"></a></span>
<span id="cb135-32"><a href="index-evaluation.html#cb135-32" tabindex="-1"></a></span>
<span id="cb135-33"><a href="index-evaluation.html#cb135-33" tabindex="-1"></a><span class="fu">inner_join</span>(</span>
<span id="cb135-34"><a href="index-evaluation.html#cb135-34" tabindex="-1"></a>    fpr_metrics,</span>
<span id="cb135-35"><a href="index-evaluation.html#cb135-35" tabindex="-1"></a>    tpr_metrics,</span>
<span id="cb135-36"><a href="index-evaluation.html#cb135-36" tabindex="-1"></a>    <span class="fu">join_by</span>(auc),</span>
<span id="cb135-37"><a href="index-evaluation.html#cb135-37" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_spec&quot;</span>, <span class="st">&quot;_sens&quot;</span>)</span>
<span id="cb135-38"><a href="index-evaluation.html#cb135-38" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb135-39"><a href="index-evaluation.html#cb135-39" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb135-40"><a href="index-evaluation.html#cb135-40" tabindex="-1"></a>        <span class="at">identifier =</span> <span class="st">&quot;ENSG00000142515&quot;</span>,</span>
<span id="cb135-41"><a href="index-evaluation.html#cb135-41" tabindex="-1"></a>        <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb135-42"><a href="index-evaluation.html#cb135-42" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb135-43"><a href="index-evaluation.html#cb135-43" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb135-44"><a href="index-evaluation.html#cb135-44" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;curve_shape&quot;</span>)</span>
<span id="cb135-45"><a href="index-evaluation.html#cb135-45" tabindex="-1"></a>    )</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc_spec
</th>
<th style="text-align:right;">
sp_auc
</th>
<th style="text-align:right;">
tp_auc
</th>
<th style="text-align:right;">
pauc_sens
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000142515
</td>
<td style="text-align:right;">
0.6822894
</td>
<td style="text-align:right;">
0.0151036
</td>
<td style="text-align:right;">
0.5531767
</td>
<td style="text-align:right;">
0.7319498
</td>
<td style="text-align:right;">
0.0152133
</td>
<td style="text-align:right;">
0.152133
</td>
<td style="text-align:right;">
0.7315611
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="index-evaluation.html#cb136-1" tabindex="-1"></a><span class="fu">plot_roc_curve</span>(</span>
<span id="cb136-2"><a href="index-evaluation.html#cb136-2" tabindex="-1"></a>    inverse_prognostic_dataset,</span>
<span id="cb136-3"><a href="index-evaluation.html#cb136-3" tabindex="-1"></a>    <span class="at">response =</span> prognostic,</span>
<span id="cb136-4"><a href="index-evaluation.html#cb136-4" tabindex="-1"></a>    <span class="at">predictor =</span> ENSG00000142515</span>
<span id="cb136-5"><a href="index-evaluation.html#cb136-5" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb136-6"><a href="index-evaluation.html#cb136-6" tabindex="-1"></a>    <span class="fu">add_chance_line</span>()</span></code></pre></div>
<p><img src="05_AUC_indexes_files/figure-html/ROC%20inversa%20de%20KLK3-1.png" width="672" /></p>
<p>Al realizar la inversión, las diversas métricas presentan ciertas mejoras a excepción del <span class="math inline">\(TpAUC\)</span> que se ve ligeramente reducido. A pesar de ello, las métricas obtenidas distan de ser ideales para el ámbito clínico.</p>
<p>Para realizar un mejor contraste, estas métricas se compararán con otros predictores usados en tests de estratificación de riesgo <span class="citation">(<a href="referencias.html#ref-risk-tests">Farha and Salami 2022</a>)</span>, como por ejemplo: Decipher <span class="citation">(<a href="referencias.html#ref-decipher">Erho et al. 2013</a>)</span> y Oncotype <span class="citation">(<a href="referencias.html#ref-oncotype">Klein et al. 2014</a>)</span>.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="index-evaluation.html#cb137-1" tabindex="-1"></a>decipher <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb137-2"><a href="index-evaluation.html#cb137-2" tabindex="-1"></a>    <span class="sc">~</span>name, <span class="sc">~</span>ensemble,</span>
<span id="cb137-3"><a href="index-evaluation.html#cb137-3" tabindex="-1"></a>    <span class="st">&quot;LASP1&quot;</span>, <span class="st">&quot;ENSG00000002834&quot;</span>,</span>
<span id="cb137-4"><a href="index-evaluation.html#cb137-4" tabindex="-1"></a>    <span class="st">&quot;IQGAP3&quot;</span>, <span class="st">&quot;ENSG00000183856&quot;</span>,</span>
<span id="cb137-5"><a href="index-evaluation.html#cb137-5" tabindex="-1"></a>    <span class="st">&quot;NFIB&quot;</span>, <span class="st">&quot;ENSG00000147862&quot;</span>,</span>
<span id="cb137-6"><a href="index-evaluation.html#cb137-6" tabindex="-1"></a>    <span class="st">&quot;S1PR4&quot;</span>, <span class="st">&quot;ENSG00000125910&quot;</span>,</span>
<span id="cb137-7"><a href="index-evaluation.html#cb137-7" tabindex="-1"></a>    <span class="st">&quot;THBS2&quot;</span>, <span class="st">&quot;ENSG00000186340&quot;</span>,</span>
<span id="cb137-8"><a href="index-evaluation.html#cb137-8" tabindex="-1"></a>    <span class="st">&quot;ANO7&quot;</span>, <span class="st">&quot;ENSG00000146205&quot;</span>,</span>
<span id="cb137-9"><a href="index-evaluation.html#cb137-9" tabindex="-1"></a>    <span class="st">&quot;PCDH7&quot;</span>, <span class="st">&quot;ENSG00000169851&quot;</span>,</span>
<span id="cb137-10"><a href="index-evaluation.html#cb137-10" tabindex="-1"></a>    <span class="st">&quot;MYBPC1&quot;</span>, <span class="st">&quot;ENSG00000196091&quot;</span>,</span>
<span id="cb137-11"><a href="index-evaluation.html#cb137-11" tabindex="-1"></a>    <span class="st">&quot;EPPK1&quot;</span>, <span class="st">&quot;ENSG00000261150&quot;</span>,</span>
<span id="cb137-12"><a href="index-evaluation.html#cb137-12" tabindex="-1"></a>    <span class="st">&quot;PBX1&quot;</span>, <span class="st">&quot;ENSG00000185630&quot;</span>,</span>
<span id="cb137-13"><a href="index-evaluation.html#cb137-13" tabindex="-1"></a>    <span class="st">&quot;NUSAP1&quot;</span>, <span class="st">&quot;ENSG00000137804&quot;</span>,</span>
<span id="cb137-14"><a href="index-evaluation.html#cb137-14" tabindex="-1"></a>    <span class="st">&quot;ZWILCH&quot;</span>, <span class="st">&quot;ENSG00000174442&quot;</span>,</span>
<span id="cb137-15"><a href="index-evaluation.html#cb137-15" tabindex="-1"></a>    <span class="st">&quot;UBE2C&quot;</span>, <span class="st">&quot;ENSG00000175063&quot;</span>,</span>
<span id="cb137-16"><a href="index-evaluation.html#cb137-16" tabindex="-1"></a>    <span class="st">&quot;CAMK2N1&quot;</span>, <span class="st">&quot;ENSG00000162545&quot;</span>,</span>
<span id="cb137-17"><a href="index-evaluation.html#cb137-17" tabindex="-1"></a>    <span class="st">&quot;RABGAP1&quot;</span>, <span class="st">&quot;ENSG00000011454&quot;</span>,</span>
<span id="cb137-18"><a href="index-evaluation.html#cb137-18" tabindex="-1"></a>    <span class="st">&quot;TNFRSF19&quot;</span>, <span class="st">&quot;ENSG00000127863&quot;</span></span>
<span id="cb137-19"><a href="index-evaluation.html#cb137-19" tabindex="-1"></a>)</span>
<span id="cb137-20"><a href="index-evaluation.html#cb137-20" tabindex="-1"></a></span>
<span id="cb137-21"><a href="index-evaluation.html#cb137-21" tabindex="-1"></a>oncotype <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb137-22"><a href="index-evaluation.html#cb137-22" tabindex="-1"></a>    <span class="sc">~</span>name, <span class="sc">~</span>ensemble,</span>
<span id="cb137-23"><a href="index-evaluation.html#cb137-23" tabindex="-1"></a>    <span class="st">&quot;BGN&quot;</span>, <span class="st">&quot;ENSG00000182492&quot;</span>,</span>
<span id="cb137-24"><a href="index-evaluation.html#cb137-24" tabindex="-1"></a>    <span class="st">&quot;COL1A1&quot;</span>, <span class="st">&quot;ENSG00000108821&quot;</span>,</span>
<span id="cb137-25"><a href="index-evaluation.html#cb137-25" tabindex="-1"></a>    <span class="st">&quot;SFRP4&quot;</span>, <span class="st">&quot;ENSG00000106483&quot;</span>,</span>
<span id="cb137-26"><a href="index-evaluation.html#cb137-26" tabindex="-1"></a>    <span class="st">&quot;FLNC&quot;</span>, <span class="st">&quot;ENSG00000128591&quot;</span>,</span>
<span id="cb137-27"><a href="index-evaluation.html#cb137-27" tabindex="-1"></a>    <span class="st">&quot;GSN&quot;</span>, <span class="st">&quot;ENSG00000148180&quot;</span>,</span>
<span id="cb137-28"><a href="index-evaluation.html#cb137-28" tabindex="-1"></a>    <span class="st">&quot;TPM2&quot;</span>, <span class="st">&quot;ENSG00000198467&quot;</span>,</span>
<span id="cb137-29"><a href="index-evaluation.html#cb137-29" tabindex="-1"></a>    <span class="st">&quot;GSTM2&quot;</span>, <span class="st">&quot;ENSG00000213366&quot;</span>,</span>
<span id="cb137-30"><a href="index-evaluation.html#cb137-30" tabindex="-1"></a>    <span class="st">&quot;TPX2&quot;</span>, <span class="st">&quot;ENSG00000088325&quot;</span>,</span>
<span id="cb137-31"><a href="index-evaluation.html#cb137-31" tabindex="-1"></a>    <span class="st">&quot;LAMB3&quot;</span>, <span class="st">&quot;ENSG00000196878&quot;</span>,</span>
<span id="cb137-32"><a href="index-evaluation.html#cb137-32" tabindex="-1"></a>    <span class="st">&quot;FAM13C&quot;</span>, <span class="st">&quot;ENSG00000148541&quot;</span>,</span>
<span id="cb137-33"><a href="index-evaluation.html#cb137-33" tabindex="-1"></a>    <span class="st">&quot;KLK2&quot;</span>, <span class="st">&quot;ENSG00000167751&quot;</span>,</span>
<span id="cb137-34"><a href="index-evaluation.html#cb137-34" tabindex="-1"></a>    <span class="st">&quot;AZGP1&quot;</span>, <span class="st">&quot;ENSG00000160862&quot;</span>,</span>
<span id="cb137-35"><a href="index-evaluation.html#cb137-35" tabindex="-1"></a>    <span class="st">&quot;SRD5A2&quot;</span>, <span class="st">&quot;ENSG00000277893&quot;</span>,</span>
<span id="cb137-36"><a href="index-evaluation.html#cb137-36" tabindex="-1"></a>    <span class="st">&quot;DUSP1&quot;</span>, <span class="st">&quot;ENSG00000120129&quot;</span>,</span>
<span id="cb137-37"><a href="index-evaluation.html#cb137-37" tabindex="-1"></a>    <span class="st">&quot;FOS&quot;</span>, <span class="st">&quot;ENSG00000170345&quot;</span></span>
<span id="cb137-38"><a href="index-evaluation.html#cb137-38" tabindex="-1"></a>)</span>
<span id="cb137-39"><a href="index-evaluation.html#cb137-39" tabindex="-1"></a></span>
<span id="cb137-40"><a href="index-evaluation.html#cb137-40" tabindex="-1"></a>metric_prognostic_tpr<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb137-41"><a href="index-evaluation.html#cb137-41" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(fp_auc)) <span class="sc">%&gt;%</span></span>
<span id="cb137-42"><a href="index-evaluation.html#cb137-42" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb137-43"><a href="index-evaluation.html#cb137-43" tabindex="-1"></a>        identifier <span class="sc">%in%</span> oncotype<span class="sc">$</span>ensemble <span class="sc">|</span></span>
<span id="cb137-44"><a href="index-evaluation.html#cb137-44" tabindex="-1"></a>        identifier <span class="sc">%in%</span> decipher<span class="sc">$</span>ensemble</span>
<span id="cb137-45"><a href="index-evaluation.html#cb137-45" tabindex="-1"></a>    )</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
identifier
</th>
<th style="text-align:right;">
auc
</th>
<th style="text-align:right;">
pauc
</th>
<th style="text-align:right;">
np_auc
</th>
<th style="text-align:right;">
fp_auc
</th>
<th style="text-align:left;">
curve_shape
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000196091
</td>
<td style="text-align:right;">
0.3068206
</td>
<td style="text-align:right;">
0.0008597
</td>
<td style="text-align:right;">
0.0085974
</td>
<td style="text-align:right;">
0.7536232
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000127863
</td>
<td style="text-align:right;">
0.4276427
</td>
<td style="text-align:right;">
0.0015230
</td>
<td style="text-align:right;">
0.0152297
</td>
<td style="text-align:right;">
0.7246377
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000146205
</td>
<td style="text-align:right;">
0.3072628
</td>
<td style="text-align:right;">
0.0005371
</td>
<td style="text-align:right;">
0.0053713
</td>
<td style="text-align:right;">
0.6980676
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000160862
</td>
<td style="text-align:right;">
0.3320233
</td>
<td style="text-align:right;">
0.0002522
</td>
<td style="text-align:right;">
0.0025219
</td>
<td style="text-align:right;">
0.6859903
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000167751
</td>
<td style="text-align:right;">
0.3659052
</td>
<td style="text-align:right;">
0.0018865
</td>
<td style="text-align:right;">
0.0188651
</td>
<td style="text-align:right;">
0.6739130
</td>
<td style="text-align:left;">
Hook under chance
</td>
</tr>
</tbody>
</table>
<p>Entre los datos, es posible encontrar marcadores utilizados en estos tests, los cuales presentan puntuaciones relativamente bajas, a excepción del <span class="math inline">\(FpAUC\)</span> que las puntúa en mejor medida. Contrastando estos resultados, se puede observar como el <span class="math inline">\(FpAUC\)</span> es más representativo de los marcadores actualmente utilizados en tests de estratificación de riesgos. Es más, entre los predictores con mayor <span class="math inline">\(FpAUC\)</span> se encuentra <code>ENSG00000112210</code> (<em>RAB23</em>), el cual se encuentra relacionado con la progresión de la enfermedad <span class="citation">(<a href="referencias.html#ref-rab23-marker">Chang et al. 2017</a>)</span>.</p>
</div>
</div>
<div id="discusión-y-conclusiones" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Discusión y conclusiones<a href="index-evaluation.html#discusión-y-conclusiones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El desarrollo de nuevas tecnologías permite el estudio simultáneo de un gran número de marcadores, donde los análisis basados en <span class="math inline">\(AUC\)</span> son habitualmente utilizados. En el ámbito clínico, regiones concretas de las curvas <span class="math inline">\(ROC\)</span> son más relevantes, principalmente para tratar con los costes y consecuencias de diagnósticos erróneos. De esta forma, las métricas que evalúan estas regiones, como el <span class="math inline">\(pAUC\)</span>, están ganando mayor interés. A pesar de ello, esta métrica presenta limitaciones para su uso debido a su interpretabilidad, por lo que transformaciones alternativas para trabajar en estas regiones resultan de mayor utilidad.</p>
<p>En este trabajo se ha analizado el rendimiento de métricas derivadas del <span class="math inline">\(pAUC\)</span> en regiones de interés, para ello se ha utilizado un conjunto de datos generado con distintas muestras de cáncer de próstata. Las diferentes métricas han sido evaluadas en función de su capacidad para encontrar marcadores de diagnóstico y estratificación de riesgo, escenarios donde condiciones de alta especificidad y sensibilidad son requeridas.</p>
<p>Entre las métricas descritas, el <span class="math inline">\(SpAUC\)</span> fue la primera transformación del <span class="math inline">\(pAUC\)</span> descrita, la cual permite trabajar en regiones de alta especificidad. Esta métrica es fácilmente interpretable al comprender sus valores entre <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>, sin embargo, no es aplicable a regiones de la curva <span class="math inline">\(ROC\)</span> descritas por debajo de la línea de azar. Estas regiones son comunes en la práctica, lo cual limita su uso en gran medida. Este problema ha sido resuelto por el <span class="math inline">\(TpAUC\)</span> la cual, además de tomar valores entre <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>, puede aplicarse a regiones que pasen por debajo de la línea del azar.</p>
<p>De forma similar, el <span class="math inline">\(NpAUC\)</span> fue propuesto para trabajar en regiones de alta sensibilidad. Esta métrica puede tomar valores máximos de <span class="math inline">\(1\)</span>, pero al no estar limitada por debajo, también puede tomar valores inferiores a <span class="math inline">\(0.5\)</span>, lo que dificulta su interpretación y aplicación a ciertos predictores. Estos problemas han sido resueltos por el <span class="math inline">\(FpAUC\)</span> el cual, además de contener sus valores entre <span class="math inline">\(0.5\)</span> y <span class="math inline">\(1\)</span>, se puede aplicar independientemente de la forma de la curva.</p>
<p>Además de presentar una mejor interpretabilidad, el <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> han sido capaces de distinguir entre predictores que presentan el mismo <span class="math inline">\(pAUC\)</span> y cuyas curvas <span class="math inline">\(ROC\)</span> se cruzan, algo que hasta ahora no había sido posible con las anteriores métricas. De esta forma, tanto el <span class="math inline">\(TpAUC\)</span> como el <span class="math inline">\(FpAUC\)</span> poseen una mayor capacidad de discriminación, permitiendo la selección de otros marcadores que convencionalmente se habrían descartado.</p>
<p>Finalmente, para considerar la relevancia clínica de las métricas, los resultados obtenidos se han contrastado con predictores relevantes en el ámbito clínico. Con respecto a marcadores de diagnóstico, el <span class="math inline">\(TpAUC\)</span> otorga puntuaciones similares a los 2 marcadores de mayor interés actualmente, a diferencia del <span class="math inline">\(SpAUC\)</span> que penaliza a uno de ellos. En condiciones de estratificación de riesgo, el <span class="math inline">\(NpAUC\)</span> presenta valores muy bajos para predictores que actualmente se utilizan en tests de estratificación de riesgo, a diferencia del <span class="math inline">\(FpAUC\)</span> que les otorga puntuaciones mayores.</p>
<p>Estos resultados revelan la utilidad práctica del <span class="math inline">\(TpAUC\)</span> y <span class="math inline">\(FpAUC\)</span> frente al resto. Su facilidad para ser interpretadas y capacidad de discriminar entre marcadores altamente específicos o sensibles incentiva su uso en el ámbito clínico, permitiendo la selección de marcadores que puedan ayudar en la toma de decisiones.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="count-matrix-filtering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-info.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
