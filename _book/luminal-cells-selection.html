<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Selección de células luminales de prostata | Evaluación de métricas para la búsqueda de biomarcadores de diagnóstico y pronóstico clínico</title>
  <meta name="description" content="1 Selección de células luminales de prostata | Evaluación de métricas para la búsqueda de biomarcadores de diagnóstico y pronóstico clínico" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Selección de células luminales de prostata | Evaluación de métricas para la búsqueda de biomarcadores de diagnóstico y pronóstico clínico" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Selección de células luminales de prostata | Evaluación de métricas para la búsqueda de biomarcadores de diagnóstico y pronóstico clínico" />
  
  
  

<meta name="author" content="Pablo Navarro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introducción.html"/>
<link rel="next" href="cancer-cells-selection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path=""><a href="#introducci%C3%B3n"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i>Conjuntos de datos</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#software-utilizado"><i class="fa fa-check"></i>Software utilizado</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#librer%C3%ADas-externas"><i class="fa fa-check"></i>Librerías externas</a></li>
<li class="chapter" data-level="" data-path=""><a href="#librer%C3%ADas-propias"><i class="fa fa-check"></i>Librerías propias</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#estructura"><i class="fa fa-check"></i>Estructura</a></li>
</ul></li>
<li class="part"><span><b>I Búsqueda de biomarcadores</b></span></li>
<li class="chapter" data-level="1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html"><i class="fa fa-check"></i><b>1</b> Selección de células luminales de prostata</a>
<ul>
<li class="chapter" data-level="1.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#importar-matrices-de-cuentas"><i class="fa fa-check"></i><b>1.1</b> Importar matrices de cuentas</a></li>
<li class="chapter" data-level="1.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#preprocesamiento-y-cq"><i class="fa fa-check"></i><b>1.2</b> Preprocesamiento y CQ</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="01_luminal_cell_selection.html"><a href="#creaci%C3%B3n-del-objeto-seurat"><i class="fa fa-check"></i><b>1.2.1</b> Creación del objeto Seurat</a></li>
<li class="chapter" data-level="1.2.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#lecturas-mapeadas-al-genoma-mitocondrial"><i class="fa fa-check"></i><b>1.2.2</b> Lecturas mapeadas al genoma mitocondrial</a></li>
<li class="chapter" data-level="1.2.3" data-path="01_luminal_cell_selection.html"><a href="#normalizaci%C3%B3n"><i class="fa fa-check"></i><b>1.2.3</b> Normalización</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="01_luminal_cell_selection.html"><a href="#b%C3%BAsqueda-de-genes-de-alta-variabilidad"><i class="fa fa-check"></i><b>1.3</b> Búsqueda de genes de alta variabilidad</a></li>
<li class="chapter" data-level="1.4" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#escalado-de-los-datos"><i class="fa fa-check"></i><b>1.4</b> Escalado de los datos</a></li>
<li class="chapter" data-level="1.5" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#dim-reduction"><i class="fa fa-check"></i><b>1.5</b> Reducción de la dimensionalidad</a></li>
<li class="chapter" data-level="1.6" data-path="01_luminal_cell_selection.html"><a href="#integraci%C3%B3n-de-datos"><i class="fa fa-check"></i><b>1.6</b> Integración de datos</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="01_luminal_cell_selection.html"><a href="#objetivos-de-la-integraci%C3%B3n"><i class="fa fa-check"></i><b>1.6.1</b> Objetivos de la integración</a></li>
<li class="chapter" data-level="1.6.2" data-path="01_luminal_cell_selection.html"><a href="#integraci%C3%B3n"><i class="fa fa-check"></i><b>1.6.2</b> Integración</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#dimensionalidad-del-conjunto-de-datos"><i class="fa fa-check"></i><b>1.7</b> Dimensionalidad del conjunto de datos</a></li>
<li class="chapter" data-level="1.8" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#clustering"><i class="fa fa-check"></i><b>1.8</b> Agrupamiento de células</a></li>
<li class="chapter" data-level="1.9" data-path="01_luminal_cell_selection.html"><a href="#reducci%C3%B3n-de-la-dimensionalidad-no-lineal-umap"><i class="fa fa-check"></i><b>1.9</b> Reducción de la dimensionalidad no lineal (UMAP)</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#utilidad-del-umap"><i class="fa fa-check"></i><b>1.9.1</b> Utilidad del UMAP</a></li>
<li class="chapter" data-level="1.9.2" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#umap"><i class="fa fa-check"></i><b>1.9.2</b> UMAP</a></li>
<li class="chapter" data-level="1.9.3" data-path="01_luminal_cell_selection.html"><a href="#visualizaci%C3%B3n-del-umap"><i class="fa fa-check"></i><b>1.9.3</b> Visualización del UMAP</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#degs-search"><i class="fa fa-check"></i><b>1.10</b> Búsqueda de genes expresados diferencialmente (DEG)</a></li>
<li class="chapter" data-level="1.11" data-path="01_luminal_cell_selection.html"><a href="#selecci%C3%B3n-de-c%C3%A9lulas"><i class="fa fa-check"></i><b>1.11</b> Selección de células</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="luminal-cells-selection.html"><a href="luminal-cells-selection.html#filtrado-de-resultados-significativos"><i class="fa fa-check"></i><b>1.11.1</b> Filtrado de resultados significativos</a></li>
<li class="chapter" data-level="1.11.2" data-path="01_luminal_cell_selection.html"><a href="#identificaci%C3%B3n-de-clusters"><i class="fa fa-check"></i><b>1.11.2</b> Identificación de clusters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html"><i class="fa fa-check"></i><b>2</b> Selección de células cancerosas y marcadores</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cancer-cells-selection.html"><a href="cancer-cells-selection.html#deg-luminal-cells"><i class="fa fa-check"></i><b>2.1</b> DEG en células luminales</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="01_luminal_cell_selection.html"><a href="#caracterizaci%C3%B3n-y-selecci%C3%B3n-de-los-clusters"><i class="fa fa-check"></i><b>2.1.1</b> Caracterización y selección de los clusters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="01_luminal_cell_selection.html"><a href="#b%C3%BAsqueda-de-subpoblaciones"><i class="fa fa-check"></i><b>2.2</b> Búsqueda de subpoblaciones</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="01_luminal_cell_selection.html"><a href="#repetici%C3%B3n-del-flujo-de-trabajo"><i class="fa fa-check"></i><b>2.2.1</b> Repetición del flujo de trabajo</a></li>
<li class="chapter" data-level="2.2.2" data-path="01_luminal_cell_selection.html"><a href="#interpretaci%C3%B3n-de-resultados"><i class="fa fa-check"></i><b>2.2.2</b> Interpretación de resultados</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="01_luminal_cell_selection.html"><a href="#selecci%C3%B3n-de-biomarcadores"><i class="fa fa-check"></i><b>2.3</b> Selección de biomarcadores</a></li>
</ul></li>
<li class="part"><span><b>II Generación del conjunto de datos</b></span></li>
<li class="chapter" data-level="3" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html"><i class="fa fa-check"></i><b>3</b> Generación de la matriz de conteo</a>
<ul>
<li class="chapter" data-level="3.1" data-path="01_luminal_cell_selection.html"><a href="#descripci%C3%B3n-de-los-datos"><i class="fa fa-check"></i><b>3.1</b> Descripción de los datos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#clinical-preprocessing"><i class="fa fa-check"></i><b>3.1.1</b> Preprocesamiento del fichero clinical y gdc_sample_sheet</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="01_luminal_cell_selection.html"><a href="#creaci%C3%B3n-de-matriz-de-conteo"><i class="fa fa-check"></i><b>3.2</b> Creación de matriz de conteo</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#import-read-files"><i class="fa fa-check"></i><b>3.2.1</b> Importar archivos de lecturas</a></li>
<li class="chapter" data-level="3.2.2" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#process-read-files"><i class="fa fa-check"></i><b>3.2.2</b> Selección de variables y renombrado</a></li>
<li class="chapter" data-level="3.2.3" data-path="01_luminal_cell_selection.html"><a href="#uni%C3%B3n-de-archivos"><i class="fa fa-check"></i><b>3.2.3</b> Unión de archivos</a></li>
<li class="chapter" data-level="3.2.4" data-path="01_luminal_cell_selection.html"><a href="#construcci%C3%B3n-de-la-matriz-de-conteo"><i class="fa fa-check"></i><b>3.2.4</b> Construcción de la matriz de conteo</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#procesado-de-la-matriz-de-conteo"><i class="fa fa-check"></i><b>3.3</b> Procesado de la matriz de conteo</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="count-matrix-generation.html"><a href="count-matrix-generation.html#pivotado-de-la-matriz"><i class="fa fa-check"></i><b>3.3.1</b> Pivotado de la matriz</a></li>
<li class="chapter" data-level="3.3.2" data-path="01_luminal_cell_selection.html"><a href="#c%C3%A1lculo-de-gold-standards"><i class="fa fa-check"></i><b>3.3.2</b> Cálculo de Gold Standards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html"><i class="fa fa-check"></i><b>4</b> Filtrado de la matriz de conteo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html#equivalencias-entre-identificadores"><i class="fa fa-check"></i><b>4.1</b> Equivalencias entre identificadores</a></li>
<li class="chapter" data-level="4.2" data-path="count-matrix-filtering.html"><a href="count-matrix-filtering.html#filtrado-por-los-genes-identificados"><i class="fa fa-check"></i><b>4.2</b> Filtrado por los genes identificados</a></li>
</ul></li>
<li class="part"><span><b>III Evaluación de índices</b></span></li>
<li class="chapter" data-level="5" data-path="index-evaluation.html"><a href="index-evaluation.html"><i class="fa fa-check"></i><b>5</b> Evaluación de índices</a>
<ul>
<li class="chapter" data-level="5.1" data-path="index-evaluation.html"><a href="index-evaluation.html#aucs"><i class="fa fa-check"></i><b>5.1</b> AUCs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="01_luminal_cell_selection.html"><a href="#introducci%C3%B3n-1"><i class="fa fa-check"></i><b>5.1.1</b> Introducción</a></li>
<li class="chapter" data-level="5.1.2" data-path="01_luminal_cell_selection.html"><a href="#c%C3%A1lculo-de-aucs-para-diagn%C3%B3stico"><i class="fa fa-check"></i><b>5.1.2</b> Cálculo de AUCs para diagnóstico</a></li>
<li class="chapter" data-level="5.1.3" data-path="01_luminal_cell_selection.html"><a href="#c%C3%A1lculo-de-aucs-para-pron%C3%B3stico"><i class="fa fa-check"></i><b>5.1.3</b> Cálculo de AUCs para pronóstico</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="index-evaluation.html"><a href="index-evaluation.html#pauc"><i class="fa fa-check"></i><b>5.2</b> pAUC</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="01_luminal_cell_selection.html"><a href="#introducci%C3%B3n-2"><i class="fa fa-check"></i><b>5.2.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2.2" data-path="01_luminal_cell_selection.html"><a href="#c%C3%A1lculo-de-paucs-en-regiones-de-alta-especificidad"><i class="fa fa-check"></i><b>5.2.2</b> Cálculo de pAUCs en regiones de alta especificidad</a></li>
<li class="chapter" data-level="5.2.3" data-path="01_luminal_cell_selection.html"><a href="#c%C3%A1lculo-de-paucs-en-regiones-de-alta-sensibilidad"><i class="fa fa-check"></i><b>5.2.3</b> Cálculo de pAUCs en regiones de alta sensibilidad</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="01_luminal_cell_selection.html"><a href="#%C3%ADndices-derivados-de-pauc"><i class="fa fa-check"></i><b>5.3</b> Índices derivados de pAUC</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="index-evaluation.html"><a href="index-evaluation.html#problemas-del-pauc"><i class="fa fa-check"></i><b>5.3.1</b> Problemas del pAUC</a></li>
<li class="chapter" data-level="5.3.2" data-path="01_luminal_cell_selection.html"><a href="#%C3%ADndices-para-la-especificidad"><i class="fa fa-check"></i><b>5.3.2</b> Índices para la especificidad</a></li>
<li class="chapter" data-level="5.3.3" data-path="01_luminal_cell_selection.html"><a href="#%C3%ADndices-para-la-sensibilidad"><i class="fa fa-check"></i><b>5.3.3</b> Índices para la sensibilidad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="01_luminal_cell_selection.html"><a href="#comparaci%C3%B3n-de-%C3%ADndices"><i class="fa fa-check"></i><b>5.4</b> Comparación de índices</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="index-evaluation.html"><a href="index-evaluation.html#agrupar-por-condiciones"><i class="fa fa-check"></i><b>5.4.1</b> Agrupar por condiciones</a></li>
<li class="chapter" data-level="5.4.2" data-path="01_luminal_cell_selection.html"><a href="#biomarcadores-para-diagn%C3%B3stico"><i class="fa fa-check"></i><b>5.4.2</b> Biomarcadores para diagnóstico</a></li>
<li class="chapter" data-level="5.4.3" data-path="01_luminal_cell_selection.html"><a href="#biomarcadores-para-pron%C3%B3stico"><i class="fa fa-check"></i><b>5.4.3</b> Biomarcadores para pronóstico</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="index-evaluation.html"><a href="index-evaluation.html#resultados"><i class="fa fa-check"></i><b>5.5</b> Resultados</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="01_luminal_cell_selection.html"><a href="#rendimiento-de-m%C3%A9tricas"><i class="fa fa-check"></i><b>5.5.1</b> Rendimiento de métricas</a></li>
<li class="chapter" data-level="5.5.2" data-path="01_luminal_cell_selection.html"><a href="#relevancia-cl%C3%ADnica"><i class="fa fa-check"></i><b>5.5.2</b> Relevancia clínica</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="01_luminal_cell_selection.html"><a href="#discusi%C3%B3n-y-conclusiones"><i class="fa fa-check"></i><b>5.6</b> Discusión y conclusiones</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>A</b> Información de la sesión</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Evaluación de métricas para la búsqueda de biomarcadores de diagnóstico y pronóstico clínico</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="luminal-cells-selection" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Selección de células luminales de prostata<a href="luminal-cells-selection.html#luminal-cells-selection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En esta sección se identificarán y seleccionarán células luminales de próstata, precursoras de la enfermedad, que posteriormente se usarán para identificar biomarcadores de la enfermedad. Para ello se utilizarán los datos de experimentos de scRNA-seq obtenidos de muestras de pacientes con la enfermedad <span class="citation">(<a href="referencias.html#ref-base">X. Ma et al. 2020</a>)</span>.</p>
<div id="importar-matrices-de-cuentas" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Importar matrices de cuentas<a href="luminal-cells-selection.html#importar-matrices-de-cuentas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El primer paso será importar los datos, es decir las matrices de cuentas de cada paciente. Para facilitar este paso se define la función <code>import_gene_counts</code> que realizará los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>Usará la función <code>data.table::fread</code>, que permite una lectura rápida de archivos de gran tamaño.</li>
<li>Asignará a las filas el nombre de las variables (genes) con la función <code>rownames</code>, los cuales se encontraban almacenados en la primera columna.</li>
<li>Finalmente con la función <code>dplyr::select</code> se eliminará la primera columna con los nombres.</li>
</ol>
<p>En este caso se trabaja con dos conjuntos de datos provenientes de dos pacientes distintos, por lo que la función se aplicará para cada uno de ellos.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="luminal-cells-selection.html#cb2-1" tabindex="-1"></a>import_gene_counts <span class="ot">&lt;-</span> <span class="cf">function</span>(file, <span class="at">data_table =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-2"><a href="luminal-cells-selection.html#cb2-2" tabindex="-1"></a>    count_matrix <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(file, <span class="at">data.table =</span> data_table)</span>
<span id="cb2-3"><a href="luminal-cells-selection.html#cb2-3" tabindex="-1"></a>    <span class="fu">rownames</span>(count_matrix) <span class="ot">&lt;-</span> count_matrix[[<span class="dv">1</span>]]</span>
<span id="cb2-4"><a href="luminal-cells-selection.html#cb2-4" tabindex="-1"></a>    count_matrix <span class="ot">&lt;-</span> <span class="fu">select</span>(count_matrix, <span class="sc">-</span>(<span class="dv">1</span>))</span>
<span id="cb2-5"><a href="luminal-cells-selection.html#cb2-5" tabindex="-1"></a>    count_matrix</span>
<span id="cb2-6"><a href="luminal-cells-selection.html#cb2-6" tabindex="-1"></a>}</span>
<span id="cb2-7"><a href="luminal-cells-selection.html#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="luminal-cells-selection.html#cb2-8" tabindex="-1"></a>GSM4773522_PCa2_counts_matrix <span class="ot">&lt;-</span> <span class="fu">import_gene_counts</span>(</span>
<span id="cb2-9"><a href="luminal-cells-selection.html#cb2-9" tabindex="-1"></a>    <span class="st">&quot;./GSE157703_RAW/GSM4773522_PCa2_gene_counts_matrix.txt&quot;</span>,</span>
<span id="cb2-10"><a href="luminal-cells-selection.html#cb2-10" tabindex="-1"></a>    <span class="at">data_table =</span> <span class="cn">FALSE</span></span>
<span id="cb2-11"><a href="luminal-cells-selection.html#cb2-11" tabindex="-1"></a>)</span>
<span id="cb2-12"><a href="luminal-cells-selection.html#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="luminal-cells-selection.html#cb2-13" tabindex="-1"></a>GSM4773522_PCa1_counts_matrix <span class="ot">&lt;-</span> <span class="fu">import_gene_counts</span>(</span>
<span id="cb2-14"><a href="luminal-cells-selection.html#cb2-14" tabindex="-1"></a>    <span class="st">&quot;./GSE157703_RAW/GSM4773521_PCa1_gene_counts_matrix.txt&quot;</span>,</span>
<span id="cb2-15"><a href="luminal-cells-selection.html#cb2-15" tabindex="-1"></a>    <span class="at">data_table =</span> <span class="cn">FALSE</span></span>
<span id="cb2-16"><a href="luminal-cells-selection.html#cb2-16" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="preprocesamiento-y-cq" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Preprocesamiento y CQ<a href="luminal-cells-selection.html#preprocesamiento-y-cq" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para realizar el análisis se utilizará el paquete <strong>Seurat</strong>, el cual proveerá las herramientas necesarias para llevar a cabo la selección de biomarcadores, así como de células de interés <span class="citation">(<a href="referencias.html#ref-R-Seurat">Satija 2024</a>)</span>.</p>
<div id="creación-del-objeto-seurat" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Creación del objeto Seurat<a href="#creaci%C3%B3n-del-objeto-seurat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Antes de proceder al análisis de datos en experimentos de sc-RNAseq es recomendable realizar un control de calidad de las células. Con este proceso, es posible eliminar células de baja calidad que pueden generar ruido y malinterpretaciones de los datos, e.g. células rotas o muertas, multipletes, etc. La comunidad ha descrito diversas métricas para filtras estas células <span class="citation">(<a href="referencias.html#ref-qc-sc">Ilicic et al. 2016</a>)</span>, pero de forma intuitiva podemos considerar las siguientes:</p>
<ol style="list-style-type: decimal">
<li><strong>Número de genes únicos expresados en cada célula</strong>:
<ul>
<li>Las células de baja calidad presentan muy pocos genes únicos.</li>
<li>Los multipletes presentan una aberrante alta cantidad de cuentas de genes.</li>
</ul></li>
<li><strong>Número total de lecturas en una célula</strong>:
<ul>
<li>Correlacionado con la cantidad de genes únicos.</li>
</ul></li>
<li><strong>Porcentaje de lecturas mapeadas al genoma mitocondrial</strong>:
<ul>
<li>Las células de baja calidad/muertas tienen una elevada contaminación mitocondrial.</li>
</ul></li>
</ol>
<p><strong>Seurat</strong> permite realizar este preprocesamiento durante la creación del objeto principal. En este caso, se filtrarán aquellos genes que se hayan expresado en menos de 3 células (<code>min.cells = 3</code>) y las células que hayan expresado menos de 200 genes distintos (<code>min.features = 200</code>). Estos valores se han decidido en función de los conjuntos de datos utilizados <span class="citation">(<a href="referencias.html#ref-base">X. Ma et al. 2020</a>)</span>, para otros contextos otros valores pueden seleccionarse.</p>
<p>La función para crear los objetos con los que se trabajará (<code>CreateSeuratObject</code>), utilizará las matrices de cuentas creadas en el apartado anterior y opcionalmente un identificador (<code>project</code>) que arbitrariamente utilizaremos para indicar el paciente del que provienen.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="luminal-cells-selection.html#cb3-1" tabindex="-1"></a>seurat_object_1 <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(</span>
<span id="cb3-2"><a href="luminal-cells-selection.html#cb3-2" tabindex="-1"></a>    <span class="at">counts =</span> GSM4773522_PCa1_counts_matrix,</span>
<span id="cb3-3"><a href="luminal-cells-selection.html#cb3-3" tabindex="-1"></a>    <span class="at">min.cells =</span> <span class="dv">3</span>,</span>
<span id="cb3-4"><a href="luminal-cells-selection.html#cb3-4" tabindex="-1"></a>    <span class="at">min.features =</span> <span class="dv">200</span>,</span>
<span id="cb3-5"><a href="luminal-cells-selection.html#cb3-5" tabindex="-1"></a>    <span class="at">project =</span> <span class="st">&quot;Patient1&quot;</span></span>
<span id="cb3-6"><a href="luminal-cells-selection.html#cb3-6" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="luminal-cells-selection.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="luminal-cells-selection.html#cb3-8" tabindex="-1"></a>seurat_object_2 <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(</span>
<span id="cb3-9"><a href="luminal-cells-selection.html#cb3-9" tabindex="-1"></a>    <span class="at">counts =</span> GSM4773522_PCa2_counts_matrix,</span>
<span id="cb3-10"><a href="luminal-cells-selection.html#cb3-10" tabindex="-1"></a>    <span class="at">min.cells =</span> <span class="dv">3</span>,</span>
<span id="cb3-11"><a href="luminal-cells-selection.html#cb3-11" tabindex="-1"></a>    <span class="at">min.features =</span> <span class="dv">200</span>,</span>
<span id="cb3-12"><a href="luminal-cells-selection.html#cb3-12" tabindex="-1"></a>    <span class="at">project =</span> <span class="st">&quot;Patient2&quot;</span></span>
<span id="cb3-13"><a href="luminal-cells-selection.html#cb3-13" tabindex="-1"></a>)</span></code></pre></div>
<p>Aunque para la creación de los objetos se parte de 2 conjuntos de datos distintos (uno por paciente), podemos fusionarlos en 1 solo, de forma que sea más sencillo trabajar con ellos. Esto es posible porque cada célula tiene asignada un identificador único que la diferencia del resto, además de indicar del paciente del que proviene. Para fusionar ambos objetos simplemente se utilizará la función <code>merge</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="luminal-cells-selection.html#cb4-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">merge</span>(seurat_object_1, seurat_object_2)</span></code></pre></div>
</div>
<div id="lecturas-mapeadas-al-genoma-mitocondrial" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Lecturas mapeadas al genoma mitocondrial<a href="luminal-cells-selection.html#lecturas-mapeadas-al-genoma-mitocondrial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tras realizar un primer filtrado durante la creación de los objetos se debe realizar un segundo en función del porcentaje de lecturas mapeadas al genoma mitocondrial. <strong>Seurat</strong> no ofrece por defecto una forma de realizar este filtrado durante la creación del objeto, por lo que se realizará manualmente.</p>
<p>En primer lugar, se creará una métrica con el porcentaje de lecturas mapeadas al genoma mitocondrial, para ello se utilizará la función <code>PercentageFeatureSet</code>. Esta función calcula para cada célula el porcentaje total de lecturas que pertenecen a un subgrupo concreto de genes. En el conjunto de datos, los genes pertenecientes al genoma mitocondrial están nombrados usando las iniciales “MT”, lo que se utilizará para indicar el subgrupo de genes con el argumento <code>pattern</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="luminal-cells-selection.html#cb5-1" tabindex="-1"></a>seurat_objects[[<span class="st">&quot;percent.mt&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(</span>
<span id="cb5-2"><a href="luminal-cells-selection.html#cb5-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb5-3"><a href="luminal-cells-selection.html#cb5-3" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">&quot;^MT-&quot;</span></span>
<span id="cb5-4"><a href="luminal-cells-selection.html#cb5-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Generada la métrica, se realizará el filtrado utilizando la función <code>subset</code>. Con ella, se seleccionará el subconjunto de los datos que cumpla con las condiciones especificadas, que para este caso, será de un porcentaje inferior a <span class="math inline">\(0.4\)</span> <span class="citation">(<a href="referencias.html#ref-base">X. Ma et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="luminal-cells-selection.html#cb6-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb6-2"><a href="luminal-cells-selection.html#cb6-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb6-3"><a href="luminal-cells-selection.html#cb6-3" tabindex="-1"></a>    <span class="at">subset =</span> percent.mt <span class="sc">&lt;</span> <span class="dv">4</span></span>
<span id="cb6-4"><a href="luminal-cells-selection.html#cb6-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="normalización" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Normalización<a href="#normalizaci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hasta este punto se ha trabajado con los datos en crudo, sin embargo para realizar análisis aguas abajo es conveniente trabajar con datos normalizados. Realizar una normalización de los datos nos permite que la heterogeneidad de los mismos se deba principalmente a diferencias biológicas y no a otros sesgos, que en su mayoría son técnicos e.g. diferencias en distintas células en la eficiencia en captura de cDNAs, ampliación por PCR etc. <span class="citation">(<a href="referencias.html#ref-osca">Amezquita et al. 2024</a>)</span>.</p>
<p>Para realizar esta normalización, se utilizará la función la función <code>Seurat::NormalizeData</code> con el argumento <code>normalization.method = "LogNormalize"</code>. Esta función aplicará un escalado global, es decir: en cada célula dividirá el número de cuentas de cada gen entre el número total de cuentas. Finalmente aplicará una trasformación logarítmica a los resultados.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="luminal-cells-selection.html#cb7-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(</span>
<span id="cb7-2"><a href="luminal-cells-selection.html#cb7-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb7-3"><a href="luminal-cells-selection.html#cb7-3" tabindex="-1"></a>    <span class="at">normalization.method =</span> <span class="st">&quot;LogNormalize&quot;</span></span>
<span id="cb7-4"><a href="luminal-cells-selection.html#cb7-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="búsqueda-de-genes-de-alta-variabilidad" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Búsqueda de genes de alta variabilidad<a href="#b%C3%BAsqueda-de-genes-de-alta-variabilidad" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una vez realizado el preprocesamiento de los datos, se buscarán los genes que presentan una mayor variabilidad, es decir, que presenten niveles de expresión muy altos en algunas células y muy bajos en otras. La búsqueda de estos genes, y su uso en análisis aguas abajo, facilita la identificación de patrones de interés <span class="citation">(<a href="referencias.html#ref-high-variability-genes">Brennecke et al. 2013</a>)</span>, por este motivo los usaremos en los siguientes pasos.</p>
<p>Para seleccionar estos genes se usará la función <code>Seurat::FindVariableFeatures</code>, la cual requerirá, además del objeto <code>seurat</code>, un número de variables a seleccionar (<code>nfeatures</code>) que para este caso serán <span class="math inline">\(2000\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="luminal-cells-selection.html#cb8-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(</span>
<span id="cb8-2"><a href="luminal-cells-selection.html#cb8-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb8-3"><a href="luminal-cells-selection.html#cb8-3" tabindex="-1"></a>    <span class="at">selection.method =</span> <span class="st">&quot;vst&quot;</span>,</span>
<span id="cb8-4"><a href="luminal-cells-selection.html#cb8-4" tabindex="-1"></a>    <span class="at">nfeatures =</span> <span class="dv">2000</span></span>
<span id="cb8-5"><a href="luminal-cells-selection.html#cb8-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Las variables seleccionadas por la función pueden visualizarse utilizando <code>Seurat::VariableFeaturePlot</code> en función de su media y varianza. Para mayor claridad, los 10 primeros genes se mostrarán con su nombre en la figura <a href="luminal-cells-selection.html#fig:variable-genes">1.1</a>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="luminal-cells-selection.html#cb9-1" tabindex="-1"></a>high_variable_genes <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(seurat_objects), <span class="dv">10</span>)</span>
<span id="cb9-2"><a href="luminal-cells-selection.html#cb9-2" tabindex="-1"></a>high_variable_genes_plot <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(seurat_objects)</span>
<span id="cb9-3"><a href="luminal-cells-selection.html#cb9-3" tabindex="-1"></a><span class="fu">LabelPoints</span>(</span>
<span id="cb9-4"><a href="luminal-cells-selection.html#cb9-4" tabindex="-1"></a>    <span class="at">plot =</span> high_variable_genes_plot,</span>
<span id="cb9-5"><a href="luminal-cells-selection.html#cb9-5" tabindex="-1"></a>    <span class="at">points =</span> high_variable_genes,</span>
<span id="cb9-6"><a href="luminal-cells-selection.html#cb9-6" tabindex="-1"></a>    <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb9-7"><a href="luminal-cells-selection.html#cb9-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:variable-genes"></span>
<img src="01_luminal_cell_selection_files/figure-html/variable-genes-1.png" alt="Genes de alta variabilidad" width="672" />
<p class="caption">
Figura 1.1: Genes de alta variabilidad
</p>
</div>
</div>
<div id="escalado-de-los-datos" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Escalado de los datos<a href="luminal-cells-selection.html#escalado-de-los-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En este tipo de experimentos, donde se trabaja con un gran número de variables, es habitual aplicar técnicas de reducción de la dimensionalidad. Sin embargo, previamente a este tipo de técnicas es conveniente aplicar un escalado y centrado de los datos. Esto se debe a que este tipo de técnicas son sensibles a conjuntos de datos donde las variables presentan escalas muy dispares. Realizando un escalado, genes que habitualmente se encuentren mucho más expresados de forma basal, no tendrán más peso en el análisis.</p>
<p><strong>Seurat</strong> provee la función <code>ScaleData</code>, que realizará este escalado además de un centrado de los datos. Por defecto la función hará que la expresión media para cada gen en todas las células sea <span class="math inline">\(0\)</span> y su varianza igual a <span class="math inline">\(1\)</span>. Finalmente se indicará que los cálculos solo se realicen sobre los genes de alta variabilidad (<code>features</code>), dado que son los que se utilizarán posteriormente para el análisis.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="luminal-cells-selection.html#cb10-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(</span>
<span id="cb10-2"><a href="luminal-cells-selection.html#cb10-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb10-3"><a href="luminal-cells-selection.html#cb10-3" tabindex="-1"></a>    <span class="at">features =</span> <span class="fu">VariableFeatures</span>(seurat_objects)</span>
<span id="cb10-4"><a href="luminal-cells-selection.html#cb10-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="dim-reduction" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Reducción de la dimensionalidad<a href="luminal-cells-selection.html#dim-reduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como se ha expresado previamente, el conjunto de datos tiene un alto número de variables y por tanto es conveniente aplicar técnicas de reducción de la dimensionalidad para trabajar con él. Por este motivo se realizará un análisis de componentes principales (PCA) sobre los datos ya escalados.</p>
<p>Para aplicar esta técnica, <strong>Seurat</strong> provee la función <code>RunPCA</code> donde, de forma similar a la sección anterior, se especificarán los genes de mayor variabilidad (<code>features</code>), dado que serán estos con los que se desea trabajar.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="luminal-cells-selection.html#cb11-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(</span>
<span id="cb11-2"><a href="luminal-cells-selection.html#cb11-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb11-3"><a href="luminal-cells-selection.html#cb11-3" tabindex="-1"></a>    <span class="at">features =</span> <span class="fu">VariableFeatures</span>(seurat_objects)</span>
<span id="cb11-4"><a href="luminal-cells-selection.html#cb11-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="integración-de-datos" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Integración de datos<a href="#integraci%C3%B3n-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="objetivos-de-la-integración" class="section level3 hasAnchor" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Objetivos de la integración<a href="#objetivos-de-la-integraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La integración de datos en scRNA-seq permite harmonizar conjuntos de datos dispares en una sola referencia <span class="citation">(<a href="referencias.html#ref-integration">Stuart et al. 2019</a>)</span>. Expresado de otra forma y aplicado a este caso, la integración permite encontrar correspondencias entre las células de ambos conjuntos de datos. De esta forma, es posible proyectar los resultados de un experimento en el espacio del otro, solventando diferencias que puedan deberse a utilizar datos de provenientes de pacientes distintos. Así, células del mismo tipo deberían agruparse juntas independientemente del individuo del que provengan.</p>
<p>Indirectamente, la integración permite mejorar el poder estadístico en análisis posteriores, dado que permite utilizar varios conjuntos de datos simultáneamente. Además, aunque algunos de estos casos no se aplique para este trabajo, también habilita:</p>
<ul>
<li>Identificar subpoblaciones de células presentes en conjuntos de datos distintos.</li>
<li>Comparar marcadores específicos de tipos celulares en diferentes condiciones (e.g. control vs tratamiento).</li>
</ul>
</div>
<div id="integración" class="section level3 hasAnchor" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Integración<a href="#integraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Existen diversos métodos que se pueden utilizar para realizar la integración de datos, pero en este caso se usará el <em>análisis de correlación canónica</em> (CCA) <span class="citation">(<a href="referencias.html#ref-integration">Stuart et al. 2019</a>)</span>.</p>
<p>Cuando se aplica este método, <strong>Seurat</strong> trabaja en un espacio de baja dimensionalidad, es decir usando las dimensiones generadas previamente en el PCA. A estas nuevas dimensiones se les aplica unas correcciones para generar unas nuevas que contemplan las fuentes de variación entre ambas muestras, de esta forma células del mismo tipo se agruparán posteriormente independientemente del paciente del que provengan.</p>
<p>Para realizar esta integración se utilizará la función <code>IntegrateLayers</code>. En ella simplemente se indicará el nombre de la nueva reducción (<code>new.reduction</code>), la reducción a corregir (<code>orig.reduction</code>) y el método de integración a utilizar (<code>method = CCAIntegration</code>).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="luminal-cells-selection.html#cb12-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">IntegrateLayers</span>(</span>
<span id="cb12-2"><a href="luminal-cells-selection.html#cb12-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb12-3"><a href="luminal-cells-selection.html#cb12-3" tabindex="-1"></a>    <span class="at">method =</span> CCAIntegration,</span>
<span id="cb12-4"><a href="luminal-cells-selection.html#cb12-4" tabindex="-1"></a>    <span class="at">orig.reduction =</span> <span class="st">&quot;pca&quot;</span>,</span>
<span id="cb12-5"><a href="luminal-cells-selection.html#cb12-5" tabindex="-1"></a>    <span class="at">new.reduction =</span> <span class="st">&quot;integrated.cca&quot;</span></span>
<span id="cb12-6"><a href="luminal-cells-selection.html#cb12-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Realizada la integración, los conjuntos de datos del objeto pueden finalmente fusionarse para proseguir los análisis aguas abajo. Seurat realiza este paso internamente con la función <code>JoinLayers</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="luminal-cells-selection.html#cb13-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">JoinLayers</span>(seurat_objects)</span></code></pre></div>
</div>
</div>
<div id="dimensionalidad-del-conjunto-de-datos" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Dimensionalidad del conjunto de datos<a href="luminal-cells-selection.html#dimensionalidad-del-conjunto-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como se ha expresado en la sección <a href="luminal-cells-selection.html#dim-reduction">1.5</a>, los datos de experimentos de scRNA-seq presentan un gran número de variables y ruido. Por este motivo, trabajar con las variables de mayor variabilidad y aplicar técnicas para reducir el número de dimensiones, como el PCA, es recomendable.</p>
<p>Las componentes producidas por esta técnica representan un conjunto de variables iniciales que están <strong>correlacionadas entre sí</strong>. Además, las variables de componentes distintas <strong>no están correlacionadas</strong>, por este motivo cada componente describe una cantidad de la variabilidad total del conjunto de datos. De esta forma, se plantea la cuestión de cuántas componentes se deben utilizar en análisis posteriores, o la “dimensionalidad” del conjunto de datos. Utilizar un gran número de componentes encapsula una mayor variabilidad de la total, sin embargo dificulta la tarea por el elevado número de variables. Por otra parte, trabajar con un menor número de dimensiones será más sencillo pero conservará una menor variabilidad, perdiendo información de esta forma.</p>
<p>Para solventar este problema existen distintos métodos que ayudan a seleccionar la dimensionalidad de un conjunto de datos. Un método heurístico comúnmente utilizado es ‘el método del codo’, el cual implica representar gráficamente la variación explicada en función de su componente. Seurat provee la función <code>ElbowPlot</code> para aplicar este método.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="luminal-cells-selection.html#cb14-1" tabindex="-1"></a><span class="fu">ElbowPlot</span>(seurat_objects, <span class="at">ndims =</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:elbow-plot"></span>
<img src="01_luminal_cell_selection_files/figure-html/elbow-plot-1.png" alt="Método del codo. En ella se muestra varición explicada por una de las componentes principales" width="672" />
<p class="caption">
Figura 1.2: Método del codo. En ella se muestra varición explicada por una de las componentes principales
</p>
</div>
<p>Otra forma de visualizar esta variabilidad es a través de mapas de calor de las componentes principales. Seurat también permite automatizar este proceso a través de la función <code>DimHeatmap</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="luminal-cells-selection.html#cb15-1" tabindex="-1"></a><span class="fu">DimHeatmap</span>(</span>
<span id="cb15-2"><a href="luminal-cells-selection.html#cb15-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb15-3"><a href="luminal-cells-selection.html#cb15-3" tabindex="-1"></a>    <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>,</span>
<span id="cb15-4"><a href="luminal-cells-selection.html#cb15-4" tabindex="-1"></a>    <span class="at">cells =</span> <span class="dv">500</span>,</span>
<span id="cb15-5"><a href="luminal-cells-selection.html#cb15-5" tabindex="-1"></a>    <span class="at">balanced =</span> <span class="cn">TRUE</span></span>
<span id="cb15-6"><a href="luminal-cells-selection.html#cb15-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:heatmaps"></span>
<img src="01_luminal_cell_selection_files/figure-html/heatmaps-1.png" alt="Mapas de calor de las 21 primeras componentes" width="672" />
<p class="caption">
Figura 1.3: Mapas de calor de las 21 primeras componentes
</p>
</div>
<p>Tras observar la figura <a href="luminal-cells-selection.html#fig:elbow-plot">1.2</a> y <a href="luminal-cells-selection.html#fig:heatmaps">1.3</a>, se puede observar que la variación empieza a disminuir a partir de la componente número 10. Sin embargo, se debe tener en cuenta que escoger menos componentes de lo ideal puede resultar en perdidas de información y propagación a los resultados finales. Por este motivo y de forma arbitraria, se seleccionará hasta la componente 20 donde el descenso de la variación explicada es más pronunciado, o en otras palabras, se está capturando la mayor parte de la variabilidad de los datos.</p>
</div>
<div id="clustering" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Agrupamiento de células<a href="luminal-cells-selection.html#clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Seleccionadas las dimensiones, el siguiente paso consistirá en agrupar las células del experimento. En primer lugar, se construirá un grafo con los K vecinos más cercanos (KNN) utilizando las dimensiones seleccionadas previamente. Para ello, se usará la función <code>Seurat::FindNeighbors</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="luminal-cells-selection.html#cb16-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(</span>
<span id="cb16-2"><a href="luminal-cells-selection.html#cb16-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb16-3"><a href="luminal-cells-selection.html#cb16-3" tabindex="-1"></a>    <span class="at">dim =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb16-4"><a href="luminal-cells-selection.html#cb16-4" tabindex="-1"></a>    <span class="at">reduction =</span> <span class="st">&quot;integrated.cca&quot;</span></span>
<span id="cb16-5"><a href="luminal-cells-selection.html#cb16-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Generado el grafo, <strong>Seurat</strong> realiza una optimización del paso anterior para finalmente agrupar las distintas células en comunidades. Para ello utiliza la función <code>FindClusters</code>, la cual además provee el parámetro <code>resolution</code> para controlar la granularidad del agrupamiento. Para el rango de células en el que estamos trabajando utilizar valores entre <span class="math inline">\(0.4\)</span> y <span class="math inline">\(1.2\)</span> es habitual. De forma arbitraria, en este caso se utilizará una resolución de <span class="math inline">\(0.8\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="luminal-cells-selection.html#cb17-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(</span>
<span id="cb17-2"><a href="luminal-cells-selection.html#cb17-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb17-3"><a href="luminal-cells-selection.html#cb17-3" tabindex="-1"></a>    <span class="at">resolution =</span> <span class="fl">0.8</span></span>
<span id="cb17-4"><a href="luminal-cells-selection.html#cb17-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="reducción-de-la-dimensionalidad-no-lineal-umap" class="section level2 hasAnchor" number="1.9">
<h2><span class="header-section-number">1.9</span> Reducción de la dimensionalidad no lineal (UMAP)<a href="#reducci%C3%B3n-de-la-dimensionalidad-no-lineal-umap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="utilidad-del-umap" class="section level3 hasAnchor" number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> Utilidad del UMAP<a href="luminal-cells-selection.html#utilidad-del-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las técnicas de reducción de la dimensionalidad no lineales pueden mostrar relaciones subyacentes en los datos que no hayan sido capturadas por técnicas lineales. En este caso, la técnica <em>uniform manifold approximation and projection</em> (UMAP) puede revelar alguna de estas relaciones no identificadas previamente por el PCA.</p>
<p>Aunque esta técnica puede revelar relaciones ocultas, también se han de considerar sus limitaciones: este método preserva las distancias locales del conjunto de datos, a costa de ignorar las de mayor distancia. De esta forma, aunque la técnica puede revelar relaciones ocultas, no es recomendable utilizarla para hacer conclusiones, dado que muchas otras no se habrán considerado.</p>
</div>
<div id="umap" class="section level3 hasAnchor" number="1.9.2">
<h3><span class="header-section-number">1.9.2</span> UMAP<a href="luminal-cells-selection.html#umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es posible realizar un UMAP con la función <code>Seurat::RunUMAP</code> indicando las dimensiones a utilizar (<code>dims</code>) y la reducción de la dimensionalidad que queremos que utilice (<code>reduction</code>), en este caso en la que se han integrado los datos (<code>integrated.cca</code>)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="luminal-cells-selection.html#cb18-1" tabindex="-1"></a>seurat_objects <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(</span>
<span id="cb18-2"><a href="luminal-cells-selection.html#cb18-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb18-3"><a href="luminal-cells-selection.html#cb18-3" tabindex="-1"></a>    <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb18-4"><a href="luminal-cells-selection.html#cb18-4" tabindex="-1"></a>    <span class="at">reduction =</span> <span class="st">&quot;integrated.cca&quot;</span></span>
<span id="cb18-5"><a href="luminal-cells-selection.html#cb18-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="visualización-del-umap" class="section level3 hasAnchor" number="1.9.3">
<h3><span class="header-section-number">1.9.3</span> Visualización del UMAP<a href="#visualizaci%C3%B3n-del-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para visualizar las dimensiones generadas es posible utilizar la función <code>Seurat::DimPlot</code>. En ella simplemente se habrá de indicar la reducción que se quiere mostrar (<code>reduction</code>), en este caso el UMAP.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="luminal-cells-selection.html#cb19-1" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb19-2"><a href="luminal-cells-selection.html#cb19-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb19-3"><a href="luminal-cells-selection.html#cb19-3" tabindex="-1"></a>    <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>,</span>
<span id="cb19-4"><a href="luminal-cells-selection.html#cb19-4" tabindex="-1"></a>    <span class="at">label =</span> <span class="cn">TRUE</span></span>
<span id="cb19-5"><a href="luminal-cells-selection.html#cb19-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:umap-view"></span>
<img src="01_luminal_cell_selection_files/figure-html/umap-view-1.png" alt="Clusters en las dimensiones generadas por el UMAP" width="672" />
<p class="caption">
Figura 1.4: Clusters en las dimensiones generadas por el UMAP
</p>
</div>
</div>
</div>
<div id="degs-search" class="section level2 hasAnchor" number="1.10">
<h2><span class="header-section-number">1.10</span> Búsqueda de genes expresados diferencialmente (DEG)<a href="luminal-cells-selection.html#degs-search" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tras identificar los grupos de células es posible buscar los genes diferencialmente expresados en cada uno de ellos. Para esta tarea <strong>Seurat</strong> provee la función <code>FindAllMarkers</code> que busca los genes expresados en mayor o menor medida con respecto al resto de células que no pertenecen al cluster.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="luminal-cells-selection.html#cb20-1" tabindex="-1"></a>all_markers <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(</span>
<span id="cb20-2"><a href="luminal-cells-selection.html#cb20-2" tabindex="-1"></a>    seurat_objects</span>
<span id="cb20-3"><a href="luminal-cells-selection.html#cb20-3" tabindex="-1"></a>)</span></code></pre></div>
<p>La función devuelve una tabla con las siguientes columnas:</p>
<ul>
<li><strong>p_val</strong>. Valor p para un gen al realizar un test de Suma de rangos de Wilcoxon.</li>
<li><strong>avg_log2FC</strong>. El log fold-change entre los dos grupos. El primer grupo se corresponderá con el cluster, el segundo con el resto de células que no pertenecen a él.</li>
<li><strong>pct.1</strong>. El porcentaje de células en el cluster que expresa el gen.</li>
<li><strong>pct.2</strong>. El porcentaje de células que expresan el gen y que no pertenecen al cluster.</li>
<li><strong>p_val_adj</strong>. El valor p ajustado por la corrección de Bonferroni usando todos los genes del conjunto de datos.</li>
</ul>
</div>
<div id="selección-de-células" class="section level2 hasAnchor" number="1.11">
<h2><span class="header-section-number">1.11</span> Selección de células<a href="#selecci%C3%B3n-de-c%C3%A9lulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filtrado-de-resultados-significativos" class="section level3 hasAnchor" number="1.11.1">
<h3><span class="header-section-number">1.11.1</span> Filtrado de resultados significativos<a href="luminal-cells-selection.html#filtrado-de-resultados-significativos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Obtenidos los DEGs y los clusters a los que pertenecen se pueden analizar los resultados, pero antes se habrán de seleccionar aquellos que sean significativos. Dado que se están realizando un gran número de pruebas (una por cada gen), se hará uso del p-valor ajustado por la corrección de Bonferroni, calculado en la sección anterior.</p>
<p>Para realizar el filtrado de los resultados que cumplan la condición <span class="math inline">\(\text{p-valor} \le 0.05\)</span>, se utilizará la función <code>dplyr::filter</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="luminal-cells-selection.html#cb21-1" tabindex="-1"></a>significative_markers <span class="ot">&lt;-</span> all_markers <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="luminal-cells-selection.html#cb21-2" tabindex="-1"></a>    <span class="fu">filter</span>(p_val_adj <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span></code></pre></div>
</div>
<div id="identificación-de-clusters" class="section level3 hasAnchor" number="1.11.2">
<h3><span class="header-section-number">1.11.2</span> Identificación de clusters<a href="#identificaci%C3%B3n-de-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Seleccionados los DEGs significativos, se pueden identificar los tipos celulares de cada cluster. En concreto, como en este caso se está trabajando con muestras de cáncer de próstata, la búsqueda se centrará en encontrar las células propias de este tejido, filtrando posibles contaminaciones.</p>
<p>En otros estudios se han reportado marcadores genéticos de células luminales de próstata <span class="citation">(<a href="referencias.html#ref-luminal-markers">Barclay et al. 2008</a>)</span>, las contribuidoras principales al desarrollo del tumor y de la enfermedad. Los principales marcadores en este tipo de células son “Keratin 8” (<em>KRT8</em>) y “Keratin 18” (<em>KRT18</em>) por lo que se puede explorar si alguno de los cluster los expresa.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="luminal-cells-selection.html#cb22-1" tabindex="-1"></a>significative_markers <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="luminal-cells-selection.html#cb22-2" tabindex="-1"></a>    <span class="fu">filter</span>(gene <span class="sc">==</span> <span class="st">&quot;KRT18&quot;</span> <span class="sc">|</span> gene <span class="sc">==</span> <span class="st">&quot;KRT8&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="luminal-cells-selection.html#cb22-3" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_log2FC), <span class="fu">desc</span>(avg_log2FC))</span></code></pre></div>
<table>
<colgroup>
<col width="13%" />
<col width="15%" />
<col width="16%" />
<col width="9%" />
<col width="9%" />
<col width="15%" />
<col width="12%" />
<col width="9%" />
</colgroup>
<thead>
<tr>
<th align="left"></th>
<th align="right">p_val</th>
<th align="right">avg_log2FC</th>
<th align="right">pct.1</th>
<th align="right">pct.2</th>
<th align="right">p_val_adj</th>
<th align="left">cluster</th>
<th align="left">gene</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">KRT8.10</td>
<td align="right">2.810e-88</td>
<td align="right">3.427157</td>
<td align="right">0.991</td>
<td align="right">0.278</td>
<td align="right">7.291e-84</td>
<td align="left">14</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT18.10</td>
<td align="right">2.285e-75</td>
<td align="right">3.166531</td>
<td align="right">0.963</td>
<td align="right">0.311</td>
<td align="right">5.929e-71</td>
<td align="left">14</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT18.4</td>
<td align="right">5.079e-37</td>
<td align="right">2.569782</td>
<td align="right">0.638</td>
<td align="right">0.315</td>
<td align="right">1.318e-32</td>
<td align="left">7</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT8.4</td>
<td align="right">3.345e-17</td>
<td align="right">2.068169</td>
<td align="right">0.489</td>
<td align="right">0.290</td>
<td align="right">8.681e-13</td>
<td align="left">7</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT8.5</td>
<td align="right">5.167e-63</td>
<td align="right">1.968036</td>
<td align="right">0.800</td>
<td align="right">0.276</td>
<td align="right">1.341e-58</td>
<td align="left">8</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT18.5</td>
<td align="right">3.253e-61</td>
<td align="right">1.912306</td>
<td align="right">0.831</td>
<td align="right">0.307</td>
<td align="right">8.442e-57</td>
<td align="left">8</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT18.9</td>
<td align="right">1.859e-10</td>
<td align="right">-1.098934</td>
<td align="right">0.042</td>
<td align="right">0.342</td>
<td align="right">4.824e- 6</td>
<td align="left">13</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT8.2</td>
<td align="right">1.460e- 9</td>
<td align="right">-1.778397</td>
<td align="right">0.136</td>
<td align="right">0.316</td>
<td align="right">3.790e- 5</td>
<td align="left">3</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT8.9</td>
<td align="right">1.951e-10</td>
<td align="right">-1.903370</td>
<td align="right">0.025</td>
<td align="right">0.310</td>
<td align="right">5.062e- 6</td>
<td align="left">13</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT8.1</td>
<td align="right">5.140e-12</td>
<td align="right">-1.980353</td>
<td align="right">0.119</td>
<td align="right">0.318</td>
<td align="right">1.334e- 7</td>
<td align="left">2</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT8.3</td>
<td align="right">4.372e- 8</td>
<td align="right">-2.077888</td>
<td align="right">0.154</td>
<td align="right">0.313</td>
<td align="right">1.134e- 3</td>
<td align="left">5</td>
<td align="left">KRT8</td>
</tr>
<tr>
<td align="left">KRT18.2</td>
<td align="right">1.375e-14</td>
<td align="right">-2.251485</td>
<td align="right">0.123</td>
<td align="right">0.352</td>
<td align="right">3.568e-10</td>
<td align="left">3</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT18.1</td>
<td align="right">3.994e-17</td>
<td align="right">-2.290610</td>
<td align="right">0.106</td>
<td align="right">0.353</td>
<td align="right">1.036e-12</td>
<td align="left">2</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT18.3</td>
<td align="right">1.026e-10</td>
<td align="right">-2.345639</td>
<td align="right">0.157</td>
<td align="right">0.347</td>
<td align="right">2.663e- 6</td>
<td align="left">5</td>
<td align="left">KRT18</td>
</tr>
<tr>
<td align="left">KRT18.8</td>
<td align="right">4.756e- 8</td>
<td align="right">-2.448954</td>
<td align="right">0.114</td>
<td align="right">0.340</td>
<td align="right">1.234e- 3</td>
<td align="left">12</td>
<td align="left">KRT18</td>
</tr>
</tbody>
</table>
<p>Al ordenar los resultados por su <code>avg_log2FC</code> y <code>pct.1</code>, con la función <code>dplyr::arrange</code>, se observa que tanto <em>KRT8</em> y <em>KR18</em> se expresan en los mismos clusters. En concreto, en los clusters 8 y 14, los genes se encuentran en un alto porcentaje de las células y además con niveles de expresión relativamente altos. Para el caso del cluster 7, aunque presente niveles de expresión ligeramente superiores a los del cluster 8, no será seleccionado al presentar un porcentaje de expresión detectable muy bajo.</p>
<p>Estos resultados pueden observarse de forma gráfica utilizando la función <code>Seurat::FeaturePlot</code> especificando los genes que se que quieren mostrar.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="luminal-cells-selection.html#cb23-1" tabindex="-1"></a><span class="fu">FeaturePlot</span>(</span>
<span id="cb23-2"><a href="luminal-cells-selection.html#cb23-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb23-3"><a href="luminal-cells-selection.html#cb23-3" tabindex="-1"></a>    <span class="at">feature =</span> <span class="fu">c</span>(<span class="st">&quot;KRT8&quot;</span>, <span class="st">&quot;KRT18&quot;</span>)</span>
<span id="cb23-4"><a href="luminal-cells-selection.html#cb23-4" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:feature-krt"></span>
<img src="01_luminal_cell_selection_files/figure-html/feature-krt-1.png" alt="Expresión de KRT8 y KRT18 en los clusters 8 y 14" width="672" />
<p class="caption">
Figura 1.5: Expresión de KRT8 y KRT18 en los clusters 8 y 14
</p>
</div>
<p>De esta forma, se deduce que los clusters seleccionados se corresponden con células luminales de próstata y por tanto serán objeto de estudio. Por este motivo, se seleccionarán las células pertenecientes a estos clusters para analizarlas en pasos posteriores.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="luminal-cells-selection.html#cb24-1" tabindex="-1"></a>luminal_cells <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb24-2"><a href="luminal-cells-selection.html#cb24-2" tabindex="-1"></a>    seurat_objects,</span>
<span id="cb24-3"><a href="luminal-cells-selection.html#cb24-3" tabindex="-1"></a>    <span class="at">idents =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">14</span>)</span>
<span id="cb24-4"><a href="luminal-cells-selection.html#cb24-4" tabindex="-1"></a>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducción.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cancer-cells-selection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
